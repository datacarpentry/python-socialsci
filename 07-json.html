<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Data Analysis and Visualization with Python for Social Scientists *alpha*: Processing JSON data</title><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" type="text/css" href="assets/styles.css"><script src="assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png"><link rel="manifest" href="site.webmanifest"><link rel="mask-icon" href="safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"></head><body>
    <header id="top" class="navbar navbar-expand-md navbar-light bg-white top-nav data"><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-6">
      <div class="large-logo">
        <img alt="Data Carpentry" src="assets/images/data-logo.svg"><abbr class="badge badge-light" title="This lesson is in the alpha phase, which means that it has been taught once and lesson authors are iterating on feedback." style="background-color: #FFC700; border-radius: 5px">
          <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#field-testing-alpha-stage" class="external-link alert-link" style="color: #383838">
            <i aria-hidden="true" class="icon" data-feather="alert-triangle" style="border-radius: 5px"></i>
            Alpha
          </a>
          <span class="visually-hidden">This lesson is in the alpha phase, which means that it has been taught once and lesson authors are iterating on feedback.</span>
        </abbr>
        
      </div>
    </div>
    <div class="selector-container">
      
      
      <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Learner View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/07-json.html';">Instructor View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl navbar-light bg-white bottom-nav data" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Data Carpentry" src="assets/images/data-logo-sm.svg"></div>
    <div class="lesson-title-md">
      Data Analysis and Visualization with Python for Social Scientists *alpha*
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="search button" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            Data Analysis and Visualization with Python for Social Scientists *alpha*
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glossary</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Learner Profiles</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><li><a class="dropdown-item" href="discuss.html">Discussion</a></li><li><a class="dropdown-item" href="reference.html">Glossary</a></li>
          </ul></li>
      </ul></div>
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled><input class="form-control me-2 searchbox" type="search" placeholder="Search" aria-label="Search"><button class="btn btn-outline-success tablet-search-button" type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="search button"></i>
        </button>
      </fieldset></form>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Data Analysis and Visualization with Python for Social Scientists *alpha*
</div>

<aside class="col-md-12 lesson-progress"><div style="width: 45%" class="percentage">
    45%
  </div>
  <div class="progress data">
    <div class="progress-bar data" role="progressbar" style="width: 45%" aria-valuenow="45" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Learner View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/07-json.html">Instructor View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->
      
            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Setup</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="01-introduction.html">1. Introduction to Python</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="02-basics.html">2. Python basics</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="03-control-structures.html">3. Python control structures</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="04-reusable.html">4. Creating re-usable code</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="05-processing-data-from-file.html">5. Processing data from a file</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="06-date-and-time.html">6. Dates and Time</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapsecurrent" aria-expanded="true" aria-controls="flush-collapsecurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        7. Processing JSON data
        </span>
      </button>
    </div><!--/div.accordion-header-->
        
    <div id="flush-collapsecurrent" class="accordion-collapse collapse show" aria-labelledby="flush-headingcurrent" data-bs-parent="#accordionFlushcurrent">
      <div class="accordion-body">
        <ul><li><a href="#more-on-dictionaries">More on Dictionaries</a></li>
<li><a href="#the-json-data-format">The JSON data format</a></li>
<li><a href="#use-the-json-package-to-read-a-json-file">Use the JSON package to read a JSON file</a></li>
<li><a href="#extracting-specific-fields-from-a-json-document">Extracting specific fields from a JSON document</a></li>
<li><a href="#extract-the-fields-we-want-into-a-flat-format">Extract the fields we want into a flat format</a></li>
        </ul></div><!--/div.accordion-body-->
    </div><!--/div.accordion-collapse-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush9">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading9">
        <a href="08-Pandas.html">8. Reading data from a file using Pandas</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush10">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading10">
        <a href="09-extracting-data.html">9. Extracting row and columns</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush11">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading11">
        <a href="10-aggregations.html">10. Data Aggregation using Pandas</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush12">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading12">
        <a href="11-joins.html">11. Joining Pandas Dataframes</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush13">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading13">
        <a href="12-long-and-wide.html">12. Wide and long data formats</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush14">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading14">
        <a href="13-matplotlib.html">13. Data visualisation using Matplotlib</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush15">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading15">
        <a href="14-sqlite.html">14. Accessing SQLite Databases</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glossary</a>
                      </li>
                      <li>
                        <a href="profiles.html">Learner Profiles</a>
                      </li>
                      <li><a href="discuss.html">Discussion</a></li><li><a href="reference.html">Glossary</a></li>
                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width resources"><a href="aio.html">See all in one page</a>
            

            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">
            
            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="06-date-and-time.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="08-Pandas.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="06-date-and-time.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Dates and Time
        </a>
        <a class="chapter-link float-end" href="08-Pandas.html" rel="next">
          Next: Reading data from a... 
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>Processing JSON data</h1>
        <p>Last updated on 2023-05-04 |
        
        <a href="https://github.com/datacarpentry/python-socialsci/edit/main/episodes/07-json.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
        
        
        
        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>What is JSON format?</li>
<li>How can I extract specific data items from a JSON record?</li>
<li>How can I convert an array of JSON record into a table?</li>
</ul></div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul><li>Describe the JSON data format</li>
<li>Understand where JSON is typically used</li>
<li>Appreciate some advantages of using JSON over tabular data</li>
<li>Appreciate some dis-advantages of processing JSON documents</li>
<li>Compare JSON to the Python Dict data type</li>
<li>Use the JSON package to read a JSON file</li>
<li>Display formatted JSON</li>
<li>Select and display specific fields from a JSON document</li>
<li>Write tabular data from selected elements from a JSON document to a
csv file</li>
</ul></div>
</div>
</div>
</div>
</div>
<section id="more-on-dictionaries"><h2 class="section-heading">More on Dictionaries<a class="anchor" aria-label="anchor" href="#more-on-dictionaries"></a>
</h2>
<hr class="half-width"><p>In the <a href="05-processing-data-from-file.html">Processing data
from file</a> episode we introduced the dictionary object.</p>
<p>We created dictionaries and we added <code>key : value</code> pairs
to the dictionary.</p>
<p>In all of the examples that we used, the <code>value</code> was
always a simple data type like an integer or a string.</p>
<p>The <code>value</code> associated with a <code>key</code> in a
dictionary can be of any type including a <code>list</code> or even
another <code>dictionary</code>.</p>
<p>We created a simple dictionary object with the following code:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>personDict <span class="op">=</span> {<span class="st">'Name'</span> : <span class="st">'Peter'</span>}</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>personDict[<span class="st">'Location'</span>] <span class="op">=</span> <span class="st">'Manchester'</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="bu">print</span>(personDict)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>{'Name': 'Peter', 'Location': 'Manchester'}</code></pre>
</div>
<p>So far the keys in the dictionary each relate to a single piece of
information about the person. What if we wanted to add a list of
items?</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>personDict[<span class="st">'Children'</span>] <span class="op">=</span> [<span class="st">'John'</span>, <span class="st">'Jane'</span>, <span class="st">'Jack'</span>]</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>personDict[<span class="st">'Children_count'</span>] <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="bu">print</span>(personDict)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>{'Name': 'Peter', 'Children': ['John', 'Jane', 'Jack'], 'Children_count': 3, 'Location': 'Manchester'}</code></pre>
</div>
<p>Not only can I have a key where the value is a list, the value could
also be another dictionary object. Suppose I want to add some telephone
numbers</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>personDict[<span class="st">'phones'</span>] <span class="op">=</span> {<span class="st">'home'</span> : <span class="st">'0102345678'</span>, <span class="st">'mobile'</span> : <span class="st">'07770123456'</span>}</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="bu">print</span>(personDict.values())</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co"># adding another phone</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>personDict[<span class="st">'phones'</span>][<span class="st">'business'</span>] <span class="op">=</span>  <span class="st">'0161234234546'</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="bu">print</span>(personDict)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>dict_values(['Peter', ['John', 'Jane', 'Jack'], {'home': '0102345678', 'mobile': '07770123456'}, 3, 'Manchester'])
{'Name': 'Peter', 'Children': ['John', 'Jane', 'Jack'], 'phones': {'home': '0102345678', 'mobile': '07770123456', 'business': '0161234234546'}, 'Children_count': 3, 'Location': 'Manchester'}</code></pre>
</div>
<div id="exercise" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#exercise"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal"><li>Using the personDict as a base add information relating to the
persons home and work addresses including postcodes.</li>
<li>Print out the postcode for the work address.</li>
<li>Print out the names of the children on seperate lines (i.e. not as a
list)</li>
</ol></div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Show me the solution</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>personDict[<span class="st">'Addresses'</span>] <span class="op">=</span> {<span class="st">'Home'</span> : {<span class="st">'Addressline1'</span> : <span class="st">'23 acacia ave.'</span>, <span class="st">'Addressline2'</span> : <span class="st">'Romford'</span>, <span class="st">'PostCode'</span> : <span class="st">'RO6 5WR'</span>},</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>                          <span class="st">'Work'</span> : {<span class="st">'Addressline1'</span> : <span class="st">'19 Orford Road.'</span>, <span class="st">'Addressline2'</span> : <span class="st">'London'</span>, <span class="st">'PostCode'</span> : <span class="st">'EC4J 3XY'</span>}</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>                          }</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="bu">print</span>(personDict[<span class="st">'Addresses'</span>][<span class="st">'Work'</span>][<span class="st">'PostCode'</span>])</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="cf">for</span> child <span class="kw">in</span> personDict[<span class="st">'Children'</span>]:</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>    <span class="bu">print</span>(child)</span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>    </span></code></pre>
</div>
</div>
</div>
</div>
</div>
<p>The ability to create dictionaries containing lists and other
dictionaries, makes the dictionary object very versatile, you can create
an arbitrarily complex data structure of dictionaries within
dictionaries.</p>
<p>In practice you will not be doing this manually, instead like most
data you will read it in from a file.</p>
</section><section id="the-json-data-format"><h2 class="section-heading">The JSON data format<a class="anchor" aria-label="anchor" href="#the-json-data-format"></a>
</h2>
<hr class="half-width"><p>The JSON data format was designed as a way of allowing different
machines or processes within machines to communicate with each other by
sending messages constructed in a well defined format. JSON is now the
preferred data format used by APIs (Application Programming
Interfaces).</p>
<p>The JSON format although somewhat verbose is not only Human readable
but it can also be mapped very easily to a Python dictionary object.</p>
<p>We are going to read a file of data formatted as JSON, convert it
into a dictionary object in Python then selectively extract Key-Value
pairs and create a csv file from the extracted data.</p>
<p>The JSON file we are going to use is the <a href="data/SAFI.json">SAFI.json</a> file. This is the output file from
an electronic survey system called ODK. The JSON represents the answers
to a series of survey questions. The questions themselves have been
replaced with unique Keys, the values are the answers.</p>
<p>Because detailed surveys are by nature nested structures making it
possible to record different levels of detail or selectively ask a set
of specific questions based on the answer given a previous question, the
structure of the answers for the survey can not only be complex and
convoluted, it could easily be different from one survey respondent’s
set of answers to another.</p>
<div class="section level3">
<h3 id="advantages-of-json">Advantages of JSON<a class="anchor" aria-label="anchor" href="#advantages-of-json"></a></h3>
<ul><li>Very popular data format for APIs (e.g. results from an Internet
search)</li>
<li>Human readable</li>
<li>Each record (or document as they are called) is self contained. The
equivalent of the column name and column values are in every
record.</li>
<li>Documents do not all have to have the same structure within the same
file</li>
<li>Document structures can be complex and nested</li>
</ul></div>
<div class="section level3">
<h3 id="dis-advantages-of-json">Dis-advantages of JSON<a class="anchor" aria-label="anchor" href="#dis-advantages-of-json"></a></h3>
<ul><li>It is more verbose than the equivalent data in csv format</li>
<li>Can be more difficult to process and display than csv formatted
data</li>
</ul></div>
<div class="section level3">
<h3 id="viewing-json-data">Viewing JSON data<a class="anchor" aria-label="anchor" href="#viewing-json-data"></a></h3>
<ul><li>JSON can often be viewed directly in the web browsers: <a href="https://api.crossref.org/works/10.1037/0003-066X.59.1.29/agency" class="external-link">example</a>.</li>
<li>Browser extensions are often available for ease of viewing JSON data
e.g., <a href="https://chrome.google.com/webstore/search/json?hl=en-US" class="external-link">Chrome</a>,
<a href="https://addons.mozilla.org/en-US/firefox/search/?q=json" class="external-link">Firefox</a>,
<a href="https://www.apple.com/us/search/json?src=serp" class="external-link">Safari</a>,
etc.</li>
<li>JSON files can be opened using text editors e.g., notepad, nano,
textedit, etc.</li>
<li>There are many websites which allow viewing or beautifying JSON data
with ease. For example, <a href="https://jsonviewer.stack.hu/" class="external-link">http://jsonviewer.stack.hu/</a>. Try
pasting or loading JSON data in the second tab called “text” on that
website and then clicking on the “format” button. Clicking on the first
tab, “viewer” also gives another view of the data.</li>
</ul></div>
</section><section id="use-the-json-package-to-read-a-json-file"><h2 class="section-heading">Use the JSON package to read a JSON file<a class="anchor" aria-label="anchor" href="#use-the-json-package-to-read-a-json-file"></a>
</h2>
<hr class="half-width"><div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">'SAFI.json'</span>) <span class="im">as</span> json_data:</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>    d <span class="op">=</span> json.load(json_data)</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>    <span class="bu">print</span>(<span class="bu">type</span>(d))</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>    <span class="bu">print</span>(<span class="bu">type</span>(d[<span class="dv">0</span>]))</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>    <span class="bu">print</span>(json.dumps(d[<span class="dv">0</span>], indent<span class="op">=</span><span class="dv">2</span>))</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>&lt;class 'list'&gt;
&lt;class 'dict'&gt;
{
  "G02_months_lack_food": [
    "Jan"
  ],
  "G01_no_meals": 2,
  "E_no_group_count": "2",
  "A03_quest_no": "01",
...</code></pre>
</div>
<p>Points to note:</p>
<ol style="list-style-type: decimal"><li>We import the json package with an import statement.</li>
<li>We have chosen to use the <code>with</code> statement to open the
SAFI.json file. Notice the <code>:</code> at the end of the line and the
subsequent indentation. The <code>with</code> statement is in effect
until we un-indent. At which time the file will automatically be closed.
So we don’t need to do so explicitly.</li>
<li>‘json_data’ is the file handle.</li>
<li>The <code>json.load</code> method is passed the file handle and
reads the complete file.</li>
<li>The variable <code>d</code> is a list of dictionaries. (When we read
the csv file we considered it to be a list of strings).</li>
<li>The <code>json.dumps</code> method can be used to print either the
entire file or a specific dictionary from the list in a formatted manner
by using the indent parameter)</li>
</ol><p>By default the order in which the keys of the dictionary are printed
is not guaranteed. If we want them in sorted order we can have them
sorted by using the <code>sort_keys</code> parameter</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="bu">print</span>(json.dumps(d[<span class="dv">0</span>], indent<span class="op">=</span><span class="dv">2</span>, sort_keys<span class="op">=</span><span class="va">True</span>))</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>{
  "A01_interview_date": "2016-11-17",
  "A03_quest_no": "01",
  "A04_start": "2017-03-23T09:49:57.000Z",
  "A05_end": "2017-04-02T17:29:08.000Z",
  "A06_province": "province1",
...
}</code></pre>
</div>
</section><section id="extracting-specific-fields-from-a-json-document"><h2 class="section-heading">Extracting specific fields from a JSON document<a class="anchor" aria-label="anchor" href="#extracting-specific-fields-from-a-json-document"></a>
</h2>
<hr class="half-width"><p>If we want to extract fields from a JSON document, the first step
isto convert the JSON document into a Python dictionary. We have in fact
already done this with the</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>d <span class="op">=</span> json.load(json_data)</span></code></pre>
</div>
<p>line. <code>d</code> a list object and each entry in the list is a
Dictionary object.</p>
</section><section id="extract-the-fields-we-want-into-a-flat-format"><h2 class="section-heading">Extract the fields we want into a flat format<a class="anchor" aria-label="anchor" href="#extract-the-fields-we-want-into-a-flat-format"></a>
</h2>
<hr class="half-width"><p>Despite the arbitrary complexity of a JSON document or a Python
dictionary object, we can adopt a very systematic approach to extracting
individual fields form the structure.</p>
<p>The story so far: Our JSON file has been read into a variable
<code>d</code>. We know that <code>d</code> is a list of dictionaries.
Each dictionary represents a JSON document ( a record).</p>
<p>We can print the contents of the first dictionary in the list
with</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="bu">print</span>(json.dumps(d[<span class="dv">0</span>], indent<span class="op">=</span><span class="dv">2</span>, sort_keys<span class="op">=</span><span class="va">True</span>))</span></code></pre>
</div>
<div id="exercise-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-1" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#exercise-1"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal"><li><p>In the output from the code above there is a key with the name of
<code>D_curr_crop</code>. Find it and by looking at the indentation and
the <code>[</code> (lists) and <code>{</code> (dictionaries) describe in
English how you could find the first occurrence of
<code>D_curr_crop</code> starting with <code>d</code>.</p></li>
<li><p>Use a print statement to find out what it is.</p></li>
</ol></div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Show me the solution</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<ul><li>
<code>d</code> is a list of dictionaries</li>
<li>
<code>d[0]</code> is the first dictionary</li>
<li>within <code>d[0]</code> there is a key <code>D_plots</code> whose
value is a list and contains dictionaries</li>
<li>
<code>d[0]['D_plots'][0]</code> is the first dictionary in the
list</li>
<li>within <code>d[0]['D_plots'][0]</code> there is a key
<code>D_crops</code> which is also a list of dictionaries</li>
<li>
<code>d[0]['D_plots'][0]['D_crops'][0]</code> is the first
dictionary in the list</li>
<li>within this dictionary there is a key <code>D_curr_crop</code>
</li>
</ul><p>Being able to start at the outermost level and work your way in is
very important when you need to extract specific items.</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="bu">print</span>(d[<span class="dv">0</span>][<span class="st">'D_plots'</span>][<span class="dv">0</span>][<span class="st">'D_crops'</span>][<span class="dv">0</span>][<span class="st">'D_curr_crop'</span>])</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Being able to drill down in this way is very useful in helping you
get a feel for the JSON data structure. In practice it is more likely
that instead of returning the first occurrence of
<code>D_curr_crop</code> you will want to return all of them. This
requires a little more programming and to be aware of two potential
problems.</p>
<ol style="list-style-type: decimal"><li>
<code>D_curr_crop</code> may not exist in any particular dictionary
within <code>D_crops</code>
</li>
<li>any of the lists <code>D_plots</code> or <code>D_crops</code> could
be missing or just empty lists (<code>[]</code>)</li>
</ol><p>In our first attempt we will ignore these problems.</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="cf">for</span> farms <span class="kw">in</span> d:</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>    plot <span class="op">=</span> farms[<span class="st">'D_plots'</span>]</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>    <span class="cf">for</span> crops <span class="kw">in</span> plot:</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>        crop <span class="op">=</span> crops[<span class="st">'D_crops'</span>]</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>        <span class="cf">for</span> curr_crops <span class="kw">in</span> crop:</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>            <span class="bu">print</span>(curr_crops[<span class="st">'D_curr_crop'</span>])</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">maize</span></span>
<span><span class="va">maize</span></span>
<span><span class="va">maize</span></span>
<span><span class="va">tomatoes</span></span>
<span><span class="va">vegetable</span></span>
<span><span class="va">maize</span></span>
<span><span class="va">maize</span></span>
<span><span class="va">maize</span></span>
<span><span class="va">sorghum</span></span>
<span><span class="va">...</span></span></code></pre>
</div>
<p>In this version we test if all of the keys exist. This could be
extended to check that the lists are not empty.</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="cf">for</span> farms <span class="kw">in</span> d:</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">'D_plots'</span> <span class="kw">in</span> farms :</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>        plot <span class="op">=</span> farms[<span class="st">'D_plots'</span>]</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>        <span class="cf">for</span> crops <span class="kw">in</span> plot:</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">'D_crops'</span> <span class="kw">in</span> crops :</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>                crop <span class="op">=</span> crops[<span class="st">'D_crops'</span>]</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>                <span class="cf">for</span> curr_crops <span class="kw">in</span> crop:</span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>                    <span class="cf">if</span> <span class="st">'D_curr_crop'</span> <span class="kw">in</span> curr_crops:</span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>                        <span class="bu">print</span>(curr_crops[<span class="st">'D_curr_crop'</span>])</span></code></pre>
</div>
<p>We can now produce a list of all of the crops in all of the plots in
all of the farms.</p>
<p>We can also create a unique set of all of the crops grown using the
Python <code>set</code> data structure as shown in the code below. A set
is like a list but does not allow duplicate values (but doesn’t raise an
error if you try to add a duplicate).</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>unique_crops <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="cf">for</span> farms <span class="kw">in</span> d:</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">'D_plots'</span> <span class="kw">in</span> farms :</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>        plot <span class="op">=</span> farms[<span class="st">'D_plots'</span>]</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>        <span class="cf">for</span> crops <span class="kw">in</span> plot:</span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">'D_crops'</span> <span class="kw">in</span> crops :</span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>                crop <span class="op">=</span> crops[<span class="st">'D_crops'</span>]</span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>                <span class="cf">for</span> curr_crops <span class="kw">in</span> crop:</span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>                    <span class="cf">if</span> <span class="st">'D_curr_crop'</span> <span class="kw">in</span> curr_crops:</span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>                        <span class="co">#print(curr_crops['D_curr_crop'])</span></span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a>                        unique_crops.add(curr_crops[<span class="st">'D_curr_crop'</span>])</span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a><span class="bu">print</span>(unique_crops)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>{'peanut', 'potatoes', 'tomatoes', 'other', 'vegetable', 'amendoim', 'sunflower', 'bananas', 'sesame', None, 'cucumber', 'onion', 'sorghum', 'piri_piri', 'baby_corn', 'cabbage', 'ngogwe', 'maize', 'pigeonpeas', 'beans'}</code></pre>
</div>
<p>Simply having a list of all of the crops is unlikely to be enough.
What you are really interested in is which farm grows which crops in
which plot.</p>
<p>We can accumulate this information as we move through the list of
dictionary objects. At the top level, <code>farm</code>, there is a
unique identifier <code>A03_quest_no</code> which we can use. for the
plot and the crop within the plot we will create our own simple indexing
system (<code>plot_no</code> and <code>crop_no</code>). At the end
instead of just printing the crop name, we also print the details of
where this crop is being grown.</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="cf">for</span> farms <span class="kw">in</span> d:</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>    plot_no <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>    <span class="bu">id</span> <span class="op">=</span> farms[<span class="st">'A03_quest_no'</span>]</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">'D_plots'</span> <span class="kw">in</span> farms :</span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>        plot <span class="op">=</span> farms[<span class="st">'D_plots'</span>]</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>        <span class="cf">for</span> crops <span class="kw">in</span> plot:</span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>            crop_no <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a>            plot_no <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">'D_crops'</span> <span class="kw">in</span> crops :</span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a>                crop <span class="op">=</span> crops[<span class="st">'D_crops'</span>]</span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a>                <span class="cf">for</span> curr_crops <span class="kw">in</span> crop:</span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a>                    crop_no <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a>                    <span class="cf">if</span> <span class="st">'D_curr_crop'</span> <span class="kw">in</span> curr_crops:</span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a>                        <span class="bu">print</span>(<span class="st">"Farm no "</span>, <span class="bu">id</span>,<span class="st">" grows "</span>, curr_crops[<span class="st">'D_curr_crop'</span>],<span class="st">" in plot"</span>, plot_no , <span class="st">" and it is crop number "</span>, crop_no)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Farm no 01 grows maize in plot 1 and it is crop number 1
Farm no 01 grows maize in plot 2 and it is crop number 1
Farm no 01 grows maize in plot 1 and it is crop number 1
Farm no 01 grows tomatoes in plot 2 and it is crop number 1
Farm no 01 grows vegetable in plot 3 and it is crop number 1
...</code></pre>
</div>
<p>The final stage of this data extraction process is to save the
extracted data to a file for subsequent use.</p>
<p>Rather than manually appending all of the information items into a
string with <code>,</code> seperating each, we can use the
<code>csv</code> module.</p>
<p>To do this we need to create a <code>csv.writer</code> object and use
it to write complete rows of data at a time. <code>csv.writer</code>
expects the data to be provided as a list of items.</p>
<p>For the header row we provide a list of strings containing the colmn
names we want and at the end we proivide the data items in a list as
well.</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="im">import</span> csv</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>filename <span class="op">=</span> <span class="st">"SAFI_crops.csv"</span></span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>fw <span class="op">=</span> <span class="bu">open</span>(filename, <span class="st">'w'</span>)</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>cf <span class="op">=</span> csv.writer(fw, lineterminator<span class="op">=</span><span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a><span class="co"># write the header</span></span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a>cf.writerow([<span class="st">"Farm"</span>,<span class="st">"plot_no"</span>,<span class="st">"plot_area"</span>,<span class="st">"crop_no"</span>,<span class="st">"crop_name"</span>])</span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a></span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a><span class="cf">for</span> farms <span class="kw">in</span> d:</span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a>    plot_no <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a>    <span class="bu">id</span> <span class="op">=</span> farms[<span class="st">'A03_quest_no'</span>]</span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">'D_plots'</span> <span class="kw">in</span> farms :</span>
<span id="cb22-13"><a href="#cb22-13" tabindex="-1"></a>        plot <span class="op">=</span> farms[<span class="st">'D_plots'</span>]</span>
<span id="cb22-14"><a href="#cb22-14" tabindex="-1"></a>        <span class="cf">for</span> crops <span class="kw">in</span> plot:</span>
<span id="cb22-15"><a href="#cb22-15" tabindex="-1"></a>            crop_no <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb22-16"><a href="#cb22-16" tabindex="-1"></a>            plot_no <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb22-17"><a href="#cb22-17" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">'D_crops'</span> <span class="kw">in</span> crops :</span>
<span id="cb22-18"><a href="#cb22-18" tabindex="-1"></a>                plot_area <span class="op">=</span> crops[<span class="st">'D02_total_plot'</span>]</span>
<span id="cb22-19"><a href="#cb22-19" tabindex="-1"></a>                crop <span class="op">=</span> crops[<span class="st">'D_crops'</span>]</span>
<span id="cb22-20"><a href="#cb22-20" tabindex="-1"></a>                <span class="cf">for</span> curr_crops <span class="kw">in</span> crop:</span>
<span id="cb22-21"><a href="#cb22-21" tabindex="-1"></a>                    crop_no <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb22-22"><a href="#cb22-22" tabindex="-1"></a>                    <span class="cf">if</span> <span class="st">'D_curr_crop'</span> <span class="kw">in</span> curr_crops:</span>
<span id="cb22-23"><a href="#cb22-23" tabindex="-1"></a>                        <span class="co">#print( id, plot_no , plot_area , crop_no, curr_crops['D_curr_crop'])</span></span>
<span id="cb22-24"><a href="#cb22-24" tabindex="-1"></a>                        cf.writerow([<span class="bu">id</span>, plot_no , plot_area , crop_no, curr_crops[<span class="st">'D_curr_crop'</span>]])</span>
<span id="cb22-25"><a href="#cb22-25" tabindex="-1"></a></span>
<span id="cb22-26"><a href="#cb22-26" tabindex="-1"></a>fw.close()</span></code></pre>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul><li>JSON is a popular data format for transferring data used by a great
many Web based APIs</li>
<li>The JSON data format is very similar to the Python Dictionary
structure.</li>
<li>The complex structure of a JSON document means that it cannot easily
be ‘flattened’ into tabular data</li>
<li>We can use Python code to extract values of interest and place them
in a csv file</li>
</ul></div>
</div>
</div>
</section></div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="06-date-and-time.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="08-Pandas.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="06-date-and-time.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Dates and Time
        </a>
        <a class="chapter-link float-end" href="08-Pandas.html" rel="next">
          Next: Reading data from a... 
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>
        
        <a href="https://github.com/datacarpentry/python-socialsci/edit/main/episodes/07-json.md" class="external-link">Edit on GitHub</a>
        
	
        | <a href="https://github.com/datacarpentry/python-socialsci/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/datacarpentry/python-socialsci/" class="external-link">Source</a></p>
				<p><a href="https://github.com/datacarpentry/python-socialsci/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:team@carpentries.org">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">
        
        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>
        
        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.2" class="external-link">sandpaper (0.16.2)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.3" class="external-link">pegboard (0.7.3)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.1" class="external-link">varnish (1.0.1)</a></p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://datacarpentry.github.io/python-socialsci/07-json.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "Processing JSON data",
  "creativeWorkStatus": "active",
  "url": "https://datacarpentry.github.io/python-socialsci/07-json.html",
  "identifier": "https://datacarpentry.github.io/python-socialsci/07-json.html",
  "dateCreated": "2017-05-25",
  "dateModified": "2023-05-04",
  "datePublished": "2024-03-05"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo
    2022-11-07: we have gotten a notification that we have an overage for our
    tracking and I'm pretty sure this has to do with Workbench usage.
    Considering that I am not _currently_ using this tracking because I do not
    yet know how to access the data, I am turning this off for now.
  <script>
    var _paq = window._paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
    _paq.push(["setDomains", ["*.preview.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
    _paq.push(["setDoNotTrack", true]);
    _paq.push(["disableCookies"]);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
          var u="https://carpentries.matomo.cloud/";
          _paq.push(['setTrackerUrl', u+'matomo.php']);
          _paq.push(['setSiteId', '1']);
          var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
          g.async=true; g.src='https://cdn.matomo.cloud/carpentries.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
        })();
  </script>
  End Matomo Code --></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

