<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>Data Analysis and Visualization with Python for Social Scientists *alpha*: All in One View</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="../assets/styles.css">
<script src="../assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="manifest" href="../site.webmanifest">
<link rel="mask-icon" href="../safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" content="#ffffff">
</head>
<body>
    <header id="top" class="navbar navbar-expand-md navbar-light bg-white top-nav data"><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-6">
      <div class="large-logo">
        <img alt="Data Carpentry" src="../assets/images/data-logo.svg"><abbr class="badge badge-light" title="This lesson is in the alpha phase, which means that it has been taught once and lesson authors are iterating on feedback." style="background-color: #FFC700; border-radius: 5px">
          <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#field-testing-alpha-stage" class="external-link alert-link" style="color: #383838">
            <i aria-hidden="true" class="icon" data-feather="alert-triangle" style="border-radius: 5px"></i>
            Alpha
          </a>
          <span class="visually-hidden">This lesson is in the alpha phase, which means that it has been taught once and lesson authors are iterating on feedback.</span>
        </abbr>
        
      </div>
    </div>
    <div class="selector-container">
      
      
      <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
<li><button class="dropdown-item" type="button" onclick="window.location.href='../aio.html';">Learner View</button></li>
        </ul>
</div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl navbar-light bg-white bottom-nav data" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Data Carpentry" src="../assets/images/data-logo-sm.svg">
</div>
    <div class="lesson-title-md">
      Data Analysis and Visualization with Python for Social Scientists *alpha*
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="search button" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
          <span class="lesson-title">
            Data Analysis and Visualization with Python for Social Scientists *alpha*
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Instructor Notes</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extract All Images</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
<hr>
<li><a class="dropdown-item" href="discuss.html">Discussion</a></li>
<li><a class="dropdown-item" href="reference.html">Glossary</a></li>
          </ul>
</li>
      </ul>
</div>
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
<input class="form-control me-2 searchbox" type="search" placeholder="Search" aria-label="Search"><button class="btn btn-outline-success tablet-search-button" type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="search button"></i>
        </button>
      </fieldset>
</form>
  </div>
<!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Data Analysis and Visualization with Python for Social Scientists *alpha*
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress data">
    <div class="progress-bar data" role="progressbar" style="width: %" aria-valuenow="" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../aio.html">Learner View</a>
                      </div>
                    </div>
                  </div>
<!--/div.accordion-item-->
                </div>
<!--/div.accordion-flush-->
              </div>
<!--div.sidenav-view-selector -->
            </div>
<!--/div.col -->
      
            <hr>
</div>
<!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Schedule</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="01-introduction.html">1. Introduction to Python</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="02-basics.html">2. Python basics</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="03-control-structures.html">3. Python control structures</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="04-reusable.html">4. Creating re-usable code</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="05-processing-data-from-file.html">5. Processing data from a file</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="06-date-and-time.html">6. Dates and Time</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="07-json.html">7. Processing JSON data</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush9">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading9">
        <a href="08-Pandas.html">8. Reading data from a file using Pandas</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush10">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading10">
        <a href="09-extracting-data.html">9. Extracting row and columns</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush11">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading11">
        <a href="10-aggregations.html">10. Data Aggregation using Pandas</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush12">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading12">
        <a href="11-joins.html">11. Joining Pandas Dataframes</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush13">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading13">
        <a href="12-long-and-wide.html">12. Wide and long data formats</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush14">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading14">
        <a href="13-matplotlib.html">13. Data visualisation using Matplotlib</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush15">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading15">
        <a href="14-sqlite.html">14. Accessing SQLite Databases</a>
    </div>
<!--/div.accordion-header-->
        
  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width">
<div class="accordion accordion-flush resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul>
<li>
                        <a href="../instructor/key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Instructor Notes</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extract All Images</a>
                      </li>
                      <hr>
<li><a class="dropdown-item" href="discuss.html">Discussion</a></li>
<li><a class="dropdown-item" href="reference.html">Glossary</a></li>
                    </ul>
</div>
                </div>
              </div>
            </div>
            <hr class="half-width resources">
<a href="../instructor/aio.html">See all in one page</a>
            

            <hr class="d-none d-sm-block d-md-none">
<div class="d-grid gap-1">
            
            </div>
          </div>
<!-- /div.accordion -->
        </div>
<!-- /div.sidebar-inner -->
      </nav>
</div>
<!-- /div.sidebar -->
  </div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-extra.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <main id="main-content" class="main-content"><div class="container lesson-content">
        
        
<section id="aio-01-introduction"><p>Content from <a href="01-introduction.html">Introduction to Python</a></p>
<hr>
<p>Last updated on 2023-05-04 |
        
        <a href="https://github.com/datacarpentry/python-socialsci/edit/main/episodes/01-introduction.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 15 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>Why learn Python?</li>
<li>What are Jupyter notebooks?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Examine the Python interpreter</li>
<li>Recognize the advantage of using the Python programming
language</li>
<li>Understand the concept and benefits of using notebooks for
coding</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="introducing-the-python-programming-language"><h2 class="section-heading">Introducing the Python programming language<a class="anchor" aria-label="anchor" href="#introducing-the-python-programming-language"></a>
</h2>
<hr class="half-width">
<p>Python is a general purpose programming language. It is an
interpreted language, which makes it suitable for rapid development and
prototyping of programming segments or complete small programs.</p>
<p>Python’s main advantages:</p>
<ul>
<li>Open source software, supported by <a href="https://www.python.org/psf/" class="external-link">Python Software Foundation</a>
</li>
<li>Available on all major platforms (Windows, macOS, Linux)</li>
<li>It is a good language for new programmers to learn due to its
straightforward, object-oriented style</li>
<li>It is well-structured, which aids readability</li>
<li>It is extensible (i.e. modifiable) and is supported by a large
community who provide a comprehensive range of 3rd party packages</li>
</ul></section><section id="interpreted-vs.-compiled-languages"><h2 class="section-heading">Interpreted vs. compiled languages<a class="anchor" aria-label="anchor" href="#interpreted-vs.-compiled-languages"></a>
</h2>
<hr class="half-width">
<p>In any programming language, the code must be translated into
“machine code” before running it. It is the machine code which is
executed and produces results. In a language like C++ your code is
translated into machine code and stored in a separate file, in a process
referred to as <strong>compiling</strong> the code. You then execute the
machine code from the file as a separate step. This is efficient if you
intend to run the same machine code many times as you only have to
compile it once and it is very fast to run the compiled machine
code.</p>
<p>On the other hand, if you are experimenting, then your code will
change often and you would have to compile it again every time before
the machine can execute it. This is where <strong>interpreted</strong>
languages have the advantage. You don’t need a complete compiled program
to “run” what has been written so far and see the results. This rapid
prototyping is helped further by use of a system called REPL.</p>
</section><section id="repl"><h2 class="section-heading">REPL<a class="anchor" aria-label="anchor" href="#repl"></a>
</h2>
<hr class="half-width">
<p><strong>REPL</strong> is an acronym which stands for Read, Evaluate,
Print and Loop.</p>
<p>REPL allows you to write single statements of code, have them
executed, and if there are any results to show, they are displayed and
then the interpreter loops back to the beginning and waits for the next
program statement.</p>
<figure><img src="../fig/Python_repl_3.png" alt="Python_Repl" class="figure mx-auto d-block"></figure><p>In the example above, two variables <code>a</code> and <code>b</code>
have been created, assigned to values <code>2</code> and <code>3</code>,
and then multiplied together.</p>
<p>Every time you press <kbd>Return</kbd>, the line is interpreted. The
assignment statements don’t produce any output so you get only the
standard <code>&gt;&gt;&gt;</code> prompt.</p>
<p>For the <code>a*b</code> statement (it is more of an expression than
a statement), because the result is not being assigned to a variable,
the REPL displays the result of the calculation on screen and then waits
for the next input.</p>
<p>The REPL system makes it very easy to try out small chunks of
code.</p>
<p>You are not restricted to single line statements. If the Python
interpreter decides that what you have written on a line cannot be a
complete statement it will give you a continuation prompt of
<code>...</code> until you complete the statement.</p>
</section><section id="introducing-jupyter-notebooks"><h2 class="section-heading">Introducing Jupyter notebooks<a class="anchor" aria-label="anchor" href="#introducing-jupyter-notebooks"></a>
</h2>
<hr class="half-width">
<p><a href="https://jupyter.org/" class="external-link"><strong>Jupyter</strong></a>
originates from IPython, an effort to make Python development more
interactive. Since its inception, the scope of the project has expanded
to include <strong>Ju</strong>lia, <strong>Pyt</strong>hon, and
<strong>R</strong>, so the name was changed to “Jupyter” as a reference
to these core languages. Today, Jupyter supports even more languages,
but we will be using it only for Python code. Specifically, we will be
using <strong>Jupyter notebooks</strong>, which allows us to easily take
notes about our analysis and view plots within the same document where
we code. This facilitates sharing and reproducibility of analyses, and
the notebook interface is easily accessible through any web browser.
Jupyter notebooks are started from the terminal using</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="ex">$</span> jupyter notebook</span></code></pre>
</div>
<p>Your browser should start automatically and look something like
this:</p>
<figure><img src="../fig/Python_jupyter_6.png" alt="Jupyter_notebook_list" class="figure mx-auto d-block"></figure><p>When you create a notebook from the <em>New</em> option, the new
notebook will be displayed in a new browser tab and look like this.</p>
<figure><img src="../fig/Python_jupyter_7.png" alt="Jupyter_notebook" class="figure mx-auto d-block"></figure><p>Initially the notebook has no name other than ‘Untitled’. If you
click on ‘Untitled’ you will be given the option of changing the name to
whatever you want.</p>
<p>The notebook is divided into <strong>cells</strong>. Initially there
will be a single input cell marked by <code>In  [ ]:</code>.</p>
<p>You can type Python code directly into the cell. You can split the
code across several lines as needed. Unlike the REPL we looked at
before, the code is not interpreted line by line. To interpret the code
in a cell, you can click the <em>Run</em> button in the toolbar or from
the <em>Cell</em> menu option, or use keyboard shortcuts (e.g.,
<kbd>Shift</kbd>+<kbd>Return</kbd>). All of the code in that cell will
then be executed.</p>
<p>The results are shown in a separate <code>Out [1]:</code> cell
immediately below. A new input cell (<code>In [ ]:</code>) is created
for you automatically.</p>
<figure><img src="../fig/Python_jupyter_8.png" alt="Jupyter_notebook_cell" class="figure mx-auto d-block"></figure><p>When a cell is run, it is given a number along with the corresponding
output cell. If you have a notebook with many cells in it you can run
the cells in any order and also run the same cell many times. The number
on the left hand side of the input cells increments, so you can always
tell the order in which they were run. For example, a cell marked
<code>In [5]:</code> was the fifth cell run in the sequence.</p>
<p>Although there is an option to do so on the toolbar, you do not have
to manually save the notebook. This is done automatically by the Jupyter
system.</p>
<p>Not only are the contents of the <code>In [ ]:</code> cells saved,
but so are the <code>Out [ ]:</code> cells. This allows you to create
complete documents with both your code and the output of the code in a
single place. You can also change the cell type from Python code to
Markdown using the <em>Cell &gt; Cell Type</em> option. <a href="https://en.wikipedia.org/wiki/Markdown" class="external-link"><strong>Markdown</strong></a>
is a simple formatting system which allows you to create documentation
for your code, again all within the same notebook structure.</p>
<p>The notebook itself is stored as specially-formatted text file with
an <code>.ipynb</code> extension. These files can be opened and run by
others with Jupyter installed. This allows you to share your code
inputs, outputs, and Markdown documentation with others. You can also
export the notebook to HTML, PDF, and many other formats to make sharing
even easier.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Python is an interpreted language</li>
<li>The REPL (Read-Eval-Print loop) allows rapid development and testing
of code segments</li>
<li>Jupyter notebooks builds on the REPL concepts and allow code results
and documentation to be maintained together and shared</li>
<li>Jupyter notebooks is a complete IDE (Integrated Development
Environment)</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-02-basics"><p>Content from <a href="02-basics.html">Python basics</a></p>
<hr>
<p>Last updated on 2023-05-04 |
        
        <a href="https://github.com/datacarpentry/python-socialsci/edit/main/episodes/02-basics.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 55 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do I assign values to variables?</li>
<li>How do I do arithmetic?</li>
<li>What is a built-in function?</li>
<li>How do I see results?</li>
<li>What data types are supported in Python?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Create different cell types and show/hide output in Jupyter</li>
<li>Create variables and assign values to them</li>
<li>Check the type of a variable</li>
<li>Perform simple arithmetic operations</li>
<li>Specify parameters when using built-in functions</li>
<li>Get help for built-in functions and other aspects of Python</li>
<li>Define native data types in Python</li>
<li>Convert from one data type to another</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="using-the-jupyter-environment"><h2 class="section-heading">Using the Jupyter environment<a class="anchor" aria-label="anchor" href="#using-the-jupyter-environment"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="new-cells">New cells<a class="anchor" aria-label="anchor" href="#new-cells"></a>
</h3>
<p>From the insert menu item you can insert a new cell anywhere in the
notebook either above or below the current cell. You can also use the
<code>+</code> button on the toolbar to insert a new cell below.</p>
</div>
<div class="section level3">
<h3 id="change-cell-type">Change cell type<a class="anchor" aria-label="anchor" href="#change-cell-type"></a>
</h3>
<p>By default new cells are created as code cells. From the cell menu
item you can change the type of a cell from code to Markdown. Markdown
is a markup language for formatting text, it has much of the power of
HTML, but is specifically designed to be human-readable as well. You can
use Markdown cells to insert formatted textual explanation and analysis
into your notebook. For more information about Markdown, check out these
resources:</p>
<ul>
<li><a href="https://jupyter-notebook.readthedocs.io/en/stable/examples/Notebook/Working%20With%20Markdown%20Cells.html" class="external-link">Jupyter
Notebook Markdown Docs</a></li>
<li><a href="https://beegit.com/markdown-cheat-sheet" class="external-link">Markdown - a
Visual Guide</a></li>
<li><a href="https://guides.github.com/features/mastering-markdown/" class="external-link">Mastering
Markdown from Github</a></li>
<li><a href="https://daringfireball.net/projects/markdown/" class="external-link">Markdown
official open source project</a></li>
</ul>
</div>
<div class="section level3">
<h3 id="hiding-output">Hiding output<a class="anchor" aria-label="anchor" href="#hiding-output"></a>
</h3>
<p>When you run cells of code the output is displayed immediately below
the cell. In general this is convenient. The output is associated with
the cell that produced it and remains a part of the notebook. So if you
copy or move the notebook the output stays with the code.</p>
<p>However lots of output can make the notebook look cluttered and more
difficult to move around. So there is an option available from the
<code>cell</code> menu item to ‘toggle’ or ‘clear’ the output associated
either with an individual cell or all cells in the notebook.</p>
</div>
</section><section id="creating-variables-and-assigning-values"><h2 class="section-heading">Creating variables and assigning values<a class="anchor" aria-label="anchor" href="#creating-variables-and-assigning-values"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="variables-and-types">Variables and Types<a class="anchor" aria-label="anchor" href="#variables-and-types"></a>
</h3>
<p>In Python variables are created when you first assign values to
them.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>a <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>b <span class="op">=</span> <span class="fl">3.142</span></span></code></pre>
</div>
<p>All variables have a data type associated with them. The data type is
an indication of the type of data contained in a variable. If you want
to know the type of a variable you can use the built-in
<code>type()</code> function.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(a))</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(b))</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>s <span class="op">=</span> <span class="st">"Hello World"</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(s))</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>&lt;class 'int'&gt;
&lt;class 'float'&gt;
&lt;class 'str'&gt;</code></pre>
</div>
<p>There are many more data types available, a full list is available in
the <a href="https://docs.python.org/3/library/datatypes.html" class="external-link">Python
documentation</a>. We will be looking a few of them later on.</p>
</div>
</section><section id="arithmetic-operations"><h2 class="section-heading">Arithmetic operations<a class="anchor" aria-label="anchor" href="#arithmetic-operations"></a>
</h2>
<hr class="half-width">
<p>For now we will stick with the numeric types and do some
arithmetic.</p>
<p>All of the usual arithmetic operators are available.</p>
<p>In the examples below we also introduce the Python comment symbol
<code>#</code>. Anything to the right of the <code>#</code> symbol is
treated as a comment. To a large extent using Markdown cells in a
notebook reduces the need for comments in the code in a notebook, but
occasionally they can be useful.</p>
<p>We also make use of the built-in <code>print()</code> function, which
displays formatted text.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"a ="</span>, a, <span class="st">"and b ="</span> , b)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="bu">print</span>(a <span class="op">+</span> b)      <span class="co"># addition</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="bu">print</span>(a <span class="op">*</span> b)      <span class="co"># multiplication</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="bu">print</span>(a <span class="op">-</span> b)      <span class="co"># subtraction</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="bu">print</span>(a <span class="op">/</span> b)      <span class="co"># division</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="bu">print</span>(b <span class="op">**</span> a)     <span class="co"># exponentiation</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="bu">print</span>(a <span class="op">%</span> b)      <span class="co"># modulus - returns the remainder</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="bu">print</span>(<span class="dv">2</span> <span class="op">*</span> a <span class="op">%</span> b)  <span class="co"># modulus - returns the remainder</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>a = 2 and b = 3.142
5.1419999999999995
6.284
-1.142
0.6365372374283896
9.872164
2.0
0.8580000000000001</code></pre>
</div>
<p>We need to use the <code>print()</code> function because by default
only the last output from a cell is displayed in the output cell.</p>
<p>In our example above, we pass four different parameters to the first
call of <code>print()</code>, each separated by a comma. A string
<code>"a = "</code>, followed by the variable <code>a</code>, followed
by the string <code>"b = "</code> and then the variable
<code>b</code>.</p>
<p>The output is what you would probably have guessed at.</p>
<p>All of the other calls to <code>print()</code> are only passed a
single parameter. Although it may look like 2 or 3, the expressions are
evaluated first and it is only the single result which is seen as the
parameter value and printed.</p>
<p>In the last expression <code>a</code> is multiplied by 2 and then the
modulus of the result is taken. Had we wanted to calculate a % b and
then multiply the result by two we could have done so by using brackets
to make the order of calculation clear.</p>
<p>When we have more complex arithmetic expressions, we can use
parentheses to be explicit about the order of evaluation:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"a ="</span>, a, <span class="st">"and b ="</span> , b)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="bu">print</span>(a <span class="op">+</span> <span class="dv">2</span><span class="op">*</span>b)    <span class="co"># add a to two times b</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="bu">print</span>(a <span class="op">+</span> (<span class="dv">2</span><span class="op">*</span>b))  <span class="co"># same thing but explicit about order of evaluation</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="bu">print</span>((a <span class="op">+</span> b)<span class="op">*</span><span class="dv">2</span>)  <span class="co"># add a and b and then multiply by two</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>a = 2 and b = 3.142
8.283999999999999
8.283999999999999
10.283999999999999</code></pre>
</div>
<p>Arithmetic expressions can be arbitrarily complex, but remember
people have to read and understand them as well.</p>
<div id="exercise" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#exercise"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li><p>Create a new cell and paste into it the assignments to the
variables a and b and the contents of the code cell above with all of
the print statements. Remove all of the calls to the print function so
you only have the expressions that were to be printed and run the code.
What is returned?</p></li>
<li><p>Now remove all but the first line (with the 4 items in it) and
run the cell again. How does this output differ from when we used the
print function?</p></li>
<li><p>Practice assigning values to variables using as many different
operators as you can think of.</p></li>
<li><p>Create some expressions to be evaluated using parentheses to
enforce the order of mathematical operations that you require</p></li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Show me the solution</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li>Only the last result is printed.</li>
<li>The 4 ‘items’ are printed by the REPL, but not in the same way as
the print statement. The items in quotes are treated as separate
strings, for the variables a and b the values are printed. All four
items are treated as a ‘tuple’ which are shown in parentheses, a tuple
is another data type in Python that allows you to group things together
and treat as a unit. We can tell that it is a tuple because of the
<code>()</code>
</li>
</ol>
<p>A complete set of Python operators can be found in the <a href="https://docs.python.org/3.5/library/operator.html" class="external-link">official
documentation</a> . The documentation may appear a bit confusing as it
initially talks about operators as functions whereas we generally use
them as ‘in place’ operators. Section 10.3.1 provides a table which list
all of the available operators, not all of which are relevant to basic
arithmetic.</p>
</div>
</div>
</div>
</div>
</section><section id="using-built-in-functions"><h2 class="section-heading">Using built-in functions<a class="anchor" aria-label="anchor" href="#using-built-in-functions"></a>
</h2>
<hr class="half-width">
<p>Python has a reasonable number of built-in functions. You can find a
complete list in the <a href="https://docs.python.org/3/library/functions.html" class="external-link">official
documentation</a>.</p>
<p>Additional functions are provided by 3rd party packages which we will
look at later on.</p>
<p>For any function, a common question to ask is: What parameters does
this function take?</p>
<p>In order to answer this from Jupyter, you can type the function name
and then type <code>shift</code>+<code>tab</code> and a pop-up window
will provide you with various details about the function including the
parameters.</p>
<div id="exercise-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-1" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#exercise-1"></a>
</h3>
<div class="callout-content">
<p>For the <code>print()</code> function find out what parameters can be
provided</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Show me the solution</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p>Type ‘print’ into a code cell and then type
<code>shift</code>+<code>tab</code>. The following pop-up should
appear.</p>
<figure><img src="../fig/Python_function_parameters_9.png" alt="Print parameter information" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
</section><section id="getting-help-for-python"><h2 class="section-heading">Getting Help for Python<a class="anchor" aria-label="anchor" href="#getting-help-for-python"></a>
</h2>
<hr class="half-width">
<p>You can get help on any Python function by using the help function.
It takes a single parameter of the function name for which you want the
help.</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="bu">help</span>(<span class="bu">print</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Help on built-in function print in module builtins:

print(...)
    print(value, ..., sep=' ', end='\n', file=sys.stdout, flush=False)

    Prints the values to a stream, or to sys.stdout by default.
    Optional keyword arguments:
    file:  a file-like object (stream); defaults to the current sys.stdout.
    sep:   string inserted between values, default a space.
    end:   string appended after the last value, default a newline.
    flush: whether to forcibly flush the stream.</code></pre>
</div>
<p>There is a great deal of Python help and information as well as code
examples available from the internet. One popular site is <a href="https://stackoverflow.com/tags" class="external-link">stackoverflow</a> which
specialises in providing programming help. They have dedicated forums
not only for Python but also for many of the popular 3rd party Python
packages. They also always provide code examples to illustrate answers
to questions.</p>
<p>You can also get answers to your queries by simply inputting your
question (or selected keywords) into any search engine.</p>
<p>A couple of things you may need to be wary of: There are currently 2
versions of Python in use, in most cases code examples will run in
either but there are some exceptions. Secondly, some replies may assume
a knowledge of Python beyond your own, making the answers difficult to
follow. But for any given question there will be a whole range of
suggested solutions so you can always move on to the next.</p>
</section><section id="data-types-and-how-python-uses-them"><h2 class="section-heading">Data types and how Python uses them<a class="anchor" aria-label="anchor" href="#data-types-and-how-python-uses-them"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="changing-data-types">Changing data types<a class="anchor" aria-label="anchor" href="#changing-data-types"></a>
</h3>
<p>The data type of a variable is assigned when you give a variable a
value as we did above. If you re-assign the value of a variable, you can
change the data type.</p>
<p>You can also explicitly change the type of a variable by
<code>casting</code> it using an appropriate Python builtin function. In
this example we have changed a <code>string</code> to a
<code>float</code>.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>a <span class="op">=</span> <span class="st">"3.142"</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(a))</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>a <span class="op">=</span> <span class="bu">float</span>(a)</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(a))</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>&lt;class 'str'&gt;
&lt;class 'float'&gt;</code></pre>
</div>
<p>Although you can always change an <code>integer</code> to a
<code>float</code>, if you change a <code>float</code> to an
<code>integer</code> then you can lose part of the value of the variable
and you won’t get an error message.</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>a <span class="op">=</span> <span class="fl">3.142</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(a))</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>a <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(a))</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>a <span class="op">=</span> a<span class="op">*</span><span class="fl">1.0</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(a))</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>a <span class="op">=</span> <span class="bu">int</span>(a)</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(a))</span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>a <span class="op">=</span> <span class="fl">3.142</span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a>a <span class="op">=</span> <span class="bu">int</span>(a)</span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(a))</span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a><span class="bu">print</span>(a)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>&lt;class 'float'&gt;
&lt;class 'int'&gt;
&lt;class 'float'&gt;
&lt;class 'int'&gt;
&lt;class 'int'&gt;
3</code></pre>
</div>
<p>In some circumstances explicitly converting a data type makes no
sense; you cannot change a string with alphabetic characters into a
number.</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>b <span class="op">=</span> <span class="st">"Hello World"</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(b))</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>b <span class="op">=</span> <span class="bu">int</span>(b)</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(b))</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>&lt;class 'str'&gt;
---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
&lt;ipython-input-8-9f5f81a470f9&gt; in &lt;module&gt;()
      2 print(type(b))
      3
----&gt; 4 b = int(b)
      5 print(type(b))

ValueError: invalid literal for int() with base 10: 'Hello World'</code></pre>
</div>
</div>
</section><section id="strings"><h2 class="section-heading">Strings<a class="anchor" aria-label="anchor" href="#strings"></a>
</h2>
<hr class="half-width">
<p>A string is a simple data type which holds a sequence of
characters.</p>
<p>Strings are placed in quotes when they are being assigned, but the
quotes don’t count as part of the string value.</p>
<p>If you need to use quotes as part of your string you can arbitrarily
use either single or double quotes to indicate the start and end of the
string.</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>mystring <span class="op">=</span> <span class="st">"Hello World"</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="bu">print</span>(mystring)</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>name <span class="op">=</span> <span class="st">"Peter"</span></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>mystring <span class="op">=</span> <span class="st">'Hello '</span> <span class="op">+</span> name <span class="op">+</span> <span class="st">' How are you?'</span></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a><span class="bu">print</span>(mystring)</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a></span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>name <span class="op">=</span> <span class="st">"Peter"</span></span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>mystring <span class="op">=</span> <span class="st">'Hello this is '</span> <span class="op">+</span> name <span class="op">+</span> <span class="st">"'s code"</span></span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a><span class="bu">print</span>(mystring)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Hello World
Hello Peter How are you?
Hello this is Peter's code</code></pre>
</div>
</section><section id="string-functions"><h2 class="section-heading">String functions<a class="anchor" aria-label="anchor" href="#string-functions"></a>
</h2>
<hr class="half-width">
<p>There are a variety of Python functions available for use with
strings. In Python a string is an object. An object put simply is
something which has <code>data</code>, in the case of our string it is
the contents of the string and <code>methods</code>.
<code>methods</code> is another way of saying
<code>functions</code>.</p>
<p>Although <code>methods</code> and <code>functions</code> are very
similar in practice, there is a difference in the way you call them.</p>
<p>One typical bit of information you might want to know about a string
is its length for this we use the <code>len()</code> function. For
almost anything else you might want to do with strings, there is a
method.</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>mystring <span class="op">=</span> <span class="st">"Hello World"</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(mystring))</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">11</span></span></code></pre>
</div>
<p><a href="https://docs.python.org/3/tutorial/classes.html" class="external-link">The
official documentation</a> says, ‘A method is a function that “belongs
to” an object. In Python, the term method is not unique to class
instances: other object types can have methods as well. For example,
list objects have methods called append, insert, remove, sort, and so
on.’.</p>
<p>If you want to see a list of all of the available methods for a
string (or any other object) you can use the <code>dir()</code>
function.</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">dir</span>(mystring))</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>['__add__', '__class__', '__contains__', '__delattr__', '__dir__', '__doc__', '__eq__', '__format__', '__ge__', '__getattribute__', '__getitem__', '__getnewargs__', '__gt__', '__hash__', '__init__', '__iter__', '__le__', '__len__', '__lt__', '__mod__', '__mul__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__rmod__', '__rmul__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', 'capitalize', 'casefold', 'center', 'count', 'encode', 'endswith', 'expandtabs', 'find', 'format', 'format_map', 'index', 'isalnum', 'isalpha', 'isdecimal', 'isdigit', 'isidentifier', 'islower', 'isnumeric', 'isprintable', 'isspace', 'istitle', 'isupper', 'join', 'ljust', 'lower', 'lstrip', 'maketrans', 'partition', 'replace', 'rfind', 'rindex', 'rjust', 'rpartition', 'rsplit', 'rstrip', 'split', 'splitlines', 'startswith', 'strip', 'swapcase', 'title', 'translate', 'upper', 'zfill']</code></pre>
</div>
<p>The methods starting with <code>__</code> are special or magic
methods which are not normally used.</p>
<p>Some examples of the methods are given below. We will use others when
we start reading files.</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>myString <span class="op">=</span> <span class="st">"The quick brown fox"</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a><span class="bu">print</span>(myString.startswith(<span class="st">"The"</span>))</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a><span class="bu">print</span>(myString.find(<span class="st">"The"</span>))        <span class="co"># notice that string positions start with 0 like all indexing in Python</span></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a><span class="bu">print</span>(myString.upper())            <span class="co"># The contents of myString is not changed, if you wanted an uppercase version</span></span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a><span class="bu">print</span>(myString)                    <span class="co"># you would have to assign it to a new variable</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>True
0
THE QUICK BROWN FOX
The quick brown fox</code></pre>
</div>
<p>The methods starting with ‘is…’ return a boolean value of either True
or False</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="bu">print</span>(myString.isalpha())</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">False</span></span></code></pre>
</div>
<p>the example above returns False because the space character is not
considered to be an Alphanumeric value.</p>
<p>In the example below, we can use the <code>replace()</code> method to
remove the spaces and then check to see if the result
<code>isalpha</code> chaining method in this way is quite common. The
actions take place in a left to right manner. You can always avoid using
chaining by using intermediary variables.</p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="bu">print</span>(myString.replace(<span class="st">" "</span>,<span class="st">""</span>).isalpha())</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">True</span></span></code></pre>
</div>
<p>For example, the following is equivalent to the above</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a>mystring_clean <span class="op">=</span> myString.replace(<span class="st">" "</span>,<span class="st">""</span>)</span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a><span class="bu">print</span>(mystring_clean.isalpha())</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">True</span></span></code></pre>
</div>
<p>If you need to refer to a specific element (character) in a string,
you can do so by specifying the index of the character in
<code>[]</code> you can also use indexing to select a substring of the
string. In Python, indexes begin with <code>0</code> (for a visual,
please see <a href="https://realpython.com/python-strings/#string-indexing" class="external-link">Strings
and Character Data in Python: String Indexing</a> or <a href="https://runestone.academy/runestone/books/published/thinkcspy/Strings/IndexOperatorWorkingwiththeCharactersofaString.html" class="external-link">9.4.
Index Operator: Working with the Characters of a String</a>).</p>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a>myString <span class="op">=</span> <span class="st">"The quick brown fox"</span></span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a><span class="bu">print</span>(myString[<span class="dv">0</span>])</span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a><span class="bu">print</span>(myString[<span class="dv">12</span>])</span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a><span class="bu">print</span>(myString[<span class="dv">18</span>])</span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a><span class="bu">print</span>(myString[<span class="dv">0</span>:<span class="dv">3</span>])</span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a><span class="bu">print</span>(myString[<span class="dv">0</span>:])        <span class="co"># from index 0 to the end</span></span>
<span id="cb30-9"><a href="#cb30-9" tabindex="-1"></a><span class="bu">print</span>(myString[:<span class="dv">9</span>])        <span class="co"># from the beginning to one before index 9</span></span>
<span id="cb30-10"><a href="#cb30-10" tabindex="-1"></a><span class="bu">print</span>(myString[<span class="dv">4</span>:<span class="dv">9</span>])</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>T
o
x
The
The quick brown fox
The quick
quick</code></pre>
</div>
</section><section id="basic-python-data-types"><h2 class="section-heading">Basic Python data types<a class="anchor" aria-label="anchor" href="#basic-python-data-types"></a>
</h2>
<hr class="half-width">
<p>So far we have seen three basic Python data types; Integer, Float and
String. There is another basic data type; Boolean. Boolean variables can
only have the values of either <code>True</code> or <code>False</code>.
(Remember, Python is case-sensitive, so be careful of your spelling.) We
can define variables to be of type boolean by setting their value
accordingly. Boolean variables are a good way of coding anything that
has a binary range (eg: yes/no), because it’s a type that computers know
how to work with as we will see soon.</p>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="bu">print</span>(<span class="va">True</span>)</span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a><span class="bu">print</span>(<span class="va">False</span>)</span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a>bool_val_t <span class="op">=</span> <span class="va">True</span></span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(bool_val_t))</span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a><span class="bu">print</span>(bool_val_t)</span>
<span id="cb32-6"><a href="#cb32-6" tabindex="-1"></a>bool_val_f <span class="op">=</span> <span class="va">False</span></span>
<span id="cb32-7"><a href="#cb32-7" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(bool_val_f))</span>
<span id="cb32-8"><a href="#cb32-8" tabindex="-1"></a><span class="bu">print</span>(bool_val_f)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>True
False
&lt;class 'bool'&gt;
True
&lt;class 'bool'&gt;
False</code></pre>
</div>
<p>Following two lines of code will generate error because Python is
case-sensitive. We need to use ‘True’ instead of ‘true’ and ‘False’
instead of ‘false’.</p>
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="bu">print</span>(true)</span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a><span class="bu">print</span>(false)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>NameError   Traceback (most recent call last)
&lt;ipython-input-115-b5911eeae48b&gt; in &lt;module&gt;
----&gt; 1 print(true)
      2 print(false)

NameError: name 'true' is not defined</code></pre>
</div>
<p>We can also get values of Boolean type using comparison operators,
basic ones in Python are <code>==</code> for “equal to”, <code>!=</code>
for “not equal to”, and <code>&gt;</code>, <code>&lt;</code>, or
<code>&gt;=</code>, <code>&lt;=</code>.</p>
<div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'hello'</span> <span class="op">==</span> <span class="st">'HELLO'</span>)</span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'hello'</span> <span class="kw">is</span> <span class="st">'hello'</span>)</span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a><span class="bu">print</span>(<span class="dv">3</span> <span class="op">!=</span> <span class="dv">77</span>)</span>
<span id="cb36-4"><a href="#cb36-4" tabindex="-1"></a><span class="bu">print</span>(<span class="dv">1</span> <span class="op">&lt;</span> <span class="dv">2</span>)</span>
<span id="cb36-5"><a href="#cb36-5" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'four'</span> <span class="op">&gt;</span> <span class="st">'three'</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">False</span></span>
<span><span class="va">True</span></span>
<span><span class="va">True</span></span>
<span><span class="va">True</span></span>
<span><span class="va">False</span></span></code></pre>
</div>
<div id="exercise-2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-2" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#exercise-2"></a>
</h3>
<div class="callout-content">
<p>Imagine you are considering different ways of representing a boolean
value in your data set and you need to see how python will behave based
on the different choices. Fill in the blanks using the built in
functions we’ve seen so far in following code excerpt to test how Python
interprets text. Write some notes for your research team on how to code
<code>True</code> and <code>False</code> as they record the
variable.</p>
<div class="codewrapper sourceCode" id="cb38">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a>bool_val1 <span class="op">=</span> <span class="st">'TRUE'</span></span>
<span id="cb38-2"><a href="#cb38-2" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'read as type '</span>,___(bool_val1))</span>
<span id="cb38-3"><a href="#cb38-3" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'value when cast to bool'</span>,___(bool_val1))</span>
<span id="cb38-4"><a href="#cb38-4" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" tabindex="-1"></a>bool_val2 <span class="op">=</span> <span class="st">'FALSE'</span></span>
<span id="cb38-6"><a href="#cb38-6" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'read as type '</span>,___(bool_val2))</span>
<span id="cb38-7"><a href="#cb38-7" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'value when cast to bool'</span>,___(bool_val2))</span>
<span id="cb38-8"><a href="#cb38-8" tabindex="-1"></a></span>
<span id="cb38-9"><a href="#cb38-9" tabindex="-1"></a>bool_val3 <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb38-10"><a href="#cb38-10" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'read as type '</span>,___(bool_val3))</span>
<span id="cb38-11"><a href="#cb38-11" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'value when cast to bool'</span>,___(bool_val3))</span>
<span id="cb38-12"><a href="#cb38-12" tabindex="-1"></a></span>
<span id="cb38-13"><a href="#cb38-13" tabindex="-1"></a>bool_val4 <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb38-14"><a href="#cb38-14" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'read as type '</span>,___(bool_val4))</span>
<span id="cb38-15"><a href="#cb38-15" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'value when cast to bool'</span>,___(bool_val4))</span>
<span id="cb38-16"><a href="#cb38-16" tabindex="-1"></a></span>
<span id="cb38-17"><a href="#cb38-17" tabindex="-1"></a>bool_val5 <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb38-18"><a href="#cb38-18" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'read as type '</span>,___(bool_val5))</span>
<span id="cb38-19"><a href="#cb38-19" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'value when cast to bool'</span>,___(bool_val5))</span>
<span id="cb38-20"><a href="#cb38-20" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">bool</span>(bool_val5))</span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">Show me the solution</h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<p>0 is represented as False and everything else, whether a number or
string is counted as True</p>
</div>
</div>
</div>
</div>
</section><section id="structured-data-types"><h2 class="section-heading">Structured data types<a class="anchor" aria-label="anchor" href="#structured-data-types"></a>
</h2>
<hr class="half-width">
<p>A structured data type is a data type which is made up of some
combination of the base data types in a well defined but potentially
arbitrarily complex way.</p>
<div class="section level3">
<h3 id="the-list">The list<a class="anchor" aria-label="anchor" href="#the-list"></a>
</h3>
<p>A list is a set of values, of any type separated by commas and
delimited by ‘[’ and ’]’</p>
<div class="codewrapper sourceCode" id="cb39">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a>list1 <span class="op">=</span> [<span class="dv">6</span>, <span class="dv">54</span>, <span class="dv">89</span> ]</span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a><span class="bu">print</span>(list1)</span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(list1))</span>
<span id="cb39-4"><a href="#cb39-4" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" tabindex="-1"></a>list2 <span class="op">=</span> [<span class="fl">3.142</span>, <span class="fl">2.71828</span>, <span class="fl">9.8</span> ]</span>
<span id="cb39-6"><a href="#cb39-6" tabindex="-1"></a><span class="bu">print</span>(list2)</span>
<span id="cb39-7"><a href="#cb39-7" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(list2))</span>
<span id="cb39-8"><a href="#cb39-8" tabindex="-1"></a></span>
<span id="cb39-9"><a href="#cb39-9" tabindex="-1"></a>myname <span class="op">=</span> <span class="st">"Peter"</span></span>
<span id="cb39-10"><a href="#cb39-10" tabindex="-1"></a>list3 <span class="op">=</span> [<span class="st">"Hello"</span>, <span class="st">'to'</span>, myname ]</span>
<span id="cb39-11"><a href="#cb39-11" tabindex="-1"></a><span class="bu">print</span>(list3)</span>
<span id="cb39-12"><a href="#cb39-12" tabindex="-1"></a>myname <span class="op">=</span> <span class="st">"Fred"</span></span>
<span id="cb39-13"><a href="#cb39-13" tabindex="-1"></a><span class="bu">print</span>(list3)</span>
<span id="cb39-14"><a href="#cb39-14" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(list3))</span>
<span id="cb39-15"><a href="#cb39-15" tabindex="-1"></a></span>
<span id="cb39-16"><a href="#cb39-16" tabindex="-1"></a>list4 <span class="op">=</span> [<span class="dv">6</span>, <span class="fl">5.4</span>, <span class="st">"numbers"</span>, <span class="va">True</span> ]</span>
<span id="cb39-17"><a href="#cb39-17" tabindex="-1"></a><span class="bu">print</span>(list4)</span>
<span id="cb39-18"><a href="#cb39-18" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(list4))</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[6, 54, 89]
&lt;class 'list'&gt;
[3.142, 2.71828, 9.8]
&lt;class 'list'&gt;
['Hello', 'to', 'Peter']
['Hello', 'to', 'Peter']
&lt;class 'list'&gt;
[6, 5.4, 'numbers', True]
&lt;class 'list'&gt;</code></pre>
</div>
<div id="exercise-3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-3" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#exercise-3"></a>
</h3>
<div class="callout-content">
<p>We can index lists the same way we indexed strings before. Complete
the code below and display the value of <code>last_num_in_list</code>
which is 11 and values of <code>odd_from_list</code> which are 5 and 11
to check your work.</p>
<div class="codewrapper sourceCode" id="cb41">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a>num_list <span class="op">=</span> [<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">11</span>]</span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a>last_num_in_list <span class="op">=</span> num_list[____]</span>
<span id="cb41-4"><a href="#cb41-4" tabindex="-1"></a><span class="bu">print</span>(last_num_in_list)</span>
<span id="cb41-5"><a href="#cb41-5" tabindex="-1"></a></span>
<span id="cb41-6"><a href="#cb41-6" tabindex="-1"></a>odd_from_list <span class="op">=</span> [num_list[_____], ______]</span>
<span id="cb41-7"><a href="#cb41-7" tabindex="-1"></a><span class="bu">print</span>(odd_from_list)</span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4">Show me the solution</h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" aria-labelledby="headingSolution4" data-bs-parent="#accordionSolution4">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb42">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a><span class="co"># Solution 1: Basic ways of solving this exercise using the core Python language</span></span>
<span id="cb42-2"><a href="#cb42-2" tabindex="-1"></a>num_list <span class="op">=</span> [<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">11</span>]</span>
<span id="cb42-3"><a href="#cb42-3" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" tabindex="-1"></a>last_num_in_list <span class="op">=</span> num_list[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb42-5"><a href="#cb42-5" tabindex="-1"></a><span class="bu">print</span>(last_num_in_list)</span>
<span id="cb42-6"><a href="#cb42-6" tabindex="-1"></a></span>
<span id="cb42-7"><a href="#cb42-7" tabindex="-1"></a>odd_from_list <span class="op">=</span> [num_list[<span class="dv">1</span>], num_list[<span class="dv">3</span>]]</span>
<span id="cb42-8"><a href="#cb42-8" tabindex="-1"></a><span class="bu">print</span>(odd_from_list)</span>
<span id="cb42-9"><a href="#cb42-9" tabindex="-1"></a></span>
<span id="cb42-10"><a href="#cb42-10" tabindex="-1"></a></span>
<span id="cb42-11"><a href="#cb42-11" tabindex="-1"></a><span class="co"># Solutions 2 and 3: Usually there are multiple ways of doing the same work. Once we learn about more advanced Python, we would be able to write more varieties codes like the followings to print the odd numbers:</span></span>
<span id="cb42-12"><a href="#cb42-12" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb42-13"><a href="#cb42-13" tabindex="-1"></a>num_list <span class="op">=</span> [<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">11</span>]</span>
<span id="cb42-14"><a href="#cb42-14" tabindex="-1"></a></span>
<span id="cb42-15"><a href="#cb42-15" tabindex="-1"></a><span class="co"># Converting `num_list` list to an advanced data structure: `numpy array`</span></span>
<span id="cb42-16"><a href="#cb42-16" tabindex="-1"></a>num_list_np_array <span class="op">=</span> np.array(num_list)</span>
<span id="cb42-17"><a href="#cb42-17" tabindex="-1"></a></span>
<span id="cb42-18"><a href="#cb42-18" tabindex="-1"></a><span class="co"># Filtering the elements which produces a remainder of `1`, after dividing by `2`</span></span>
<span id="cb42-19"><a href="#cb42-19" tabindex="-1"></a>odd_from_list <span class="op">=</span> num_list_np_array[num_list_np_array<span class="op">%</span><span class="dv">2</span> <span class="op">==</span> <span class="dv">1</span>]</span>
<span id="cb42-20"><a href="#cb42-20" tabindex="-1"></a><span class="bu">print</span>(odd_from_list)</span>
<span id="cb42-21"><a href="#cb42-21" tabindex="-1"></a></span>
<span id="cb42-22"><a href="#cb42-22" tabindex="-1"></a><span class="co"># or, Using a concept called `masking`</span></span>
<span id="cb42-23"><a href="#cb42-23" tabindex="-1"></a><span class="co"># Create a boolean list `is_odd` of the same length of `num_list` with `True` at the position of the odd values.</span></span>
<span id="cb42-24"><a href="#cb42-24" tabindex="-1"></a>is_odd <span class="op">=</span> [<span class="va">False</span>, <span class="va">True</span>, <span class="va">False</span>, <span class="va">True</span>]  <span class="co"># Mask array</span></span>
<span id="cb42-25"><a href="#cb42-25" tabindex="-1"></a>odd_from_list <span class="op">=</span> num_list_np_array[is_odd] <span class="co"># only the values at the position of `True` remain</span></span>
<span id="cb42-26"><a href="#cb42-26" tabindex="-1"></a><span class="bu">print</span>(odd_from_list)</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="the-range-function">The range function<a class="anchor" aria-label="anchor" href="#the-range-function"></a>
</h3>
<p>In addition to explicitly creating lists as we have above it is very
common to create and populate them automatically using the
<code>range()</code> function in combination with the
<code>list()</code> function</p>
<div class="codewrapper sourceCode" id="cb43">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a>list5 <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">5</span>))</span>
<span id="cb43-2"><a href="#cb43-2" tabindex="-1"></a><span class="bu">print</span>(list5)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[0, 1, 2, 3, 4]</code></pre>
</div>
<p>Unless told not to <code>range()</code> returns a sequence which
starts at 0, counts up by 1 and ends 1 before the value of the provided
parameter.</p>
<p>This can be a cause of confusion. <code>range(5)</code> above does
indeed have 5 values, but rather than being 1,2,3,4,5 which you might
naturally think, they are in fact 0,1,2,3,4. The range starts at 0 and
stops one before the value of the single parameter we specified.</p>
<p>If you want different sequences, then you can modify the behavior of
the <code>range()</code> function by using additional parameters.</p>
<div class="codewrapper sourceCode" id="cb45">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a>list6 <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">9</span>))</span>
<span id="cb45-2"><a href="#cb45-2" tabindex="-1"></a><span class="bu">print</span>(list6)</span>
<span id="cb45-3"><a href="#cb45-3" tabindex="-1"></a>list7 <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">2</span>, <span class="dv">11</span>, <span class="dv">2</span>))</span>
<span id="cb45-4"><a href="#cb45-4" tabindex="-1"></a><span class="bu">print</span>(list7)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1, 2, 3, 4, 5, 6, 7, 8]
[2, 4, 6, 8, 10]</code></pre>
</div>
<p>When you specify 3 parameters as we have for list(7); the first is
start value, the second is one past the last value and the 3rd parameter
is a step value by which to count. The step value can be negative</p>
<p><code>list7</code> produces the even numbers from 1 to 10.</p>
<div id="exercise-4" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-4" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#exercise-4"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>What is produced if you change the step value in <code>list7</code>
to -2 ? Is this what you expected?</li>
<li>Create a list using the <code>range()</code> function which contains
the even number between 1 and 10 in reverse order ([10,8,6,4,2])</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution5" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution5" aria-expanded="false" aria-controls="collapseSolution5">
  <h4 class="accordion-header" id="headingSolution5">Show me the solution</h4>
</button>
<div id="collapseSolution5" class="accordion-collapse collapse" aria-labelledby="headingSolution5" data-bs-parent="#accordionSolution5">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb47">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a>list7 <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">2</span>, <span class="dv">11</span>, <span class="op">-</span><span class="dv">2</span>))</span>
<span id="cb47-2"><a href="#cb47-2" tabindex="-1"></a><span class="bu">print</span>(list7)</span>
<span id="cb47-3"><a href="#cb47-3" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" tabindex="-1"></a>list8 <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">10</span>, <span class="dv">1</span>, <span class="op">-</span><span class="dv">2</span>))</span>
<span id="cb47-5"><a href="#cb47-5" tabindex="-1"></a><span class="bu">print</span>(list8)</span></code></pre>
</div>
<p>list7 will print nothing because starting at 2 and incrementing by -2
is the wrong direction to 11.</p>
</div>
</div>
</div>
</div>
<p>The other main structured data type is the Dictionary. We will
introduce this in a later episode when we look at JSON.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>The Jupyter environment can be used to write code segments and
display results</li>
<li>Data types in Python are implicit based on variable values</li>
<li>Basic data types are Integer, Float, String and Boolean</li>
<li>Lists and Dictionaries are structured data types</li>
<li>Arithmetic uses standard arithmetic operators, precedence can be
changed using brackets</li>
<li>Help is available for builtin functions using the
<code>help()</code> function further help and code examples are
available online</li>
<li>In Jupyter you can get help on function parameters using
<kbd>shift</kbd>+<kbd>tab</kbd>
</li>
<li>Many functions are in fact methods associated with specific object
types</li>
</ul>
</div>
</div>
</div>
</div>
</section></section><section id="aio-03-control-structures"><p>Content from <a href="03-control-structures.html">Python control structures</a></p>
<hr>
<p>Last updated on 2023-05-04 |
        
        <a href="https://github.com/datacarpentry/python-socialsci/edit/main/episodes/03-control-structures.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 45 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What constructs are available for changing the flow of a
program?</li>
<li>How can I repeat an action many times?</li>
<li>How can I perform the same task(s) on a set of items?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Change program flow using available language constructs</li>
<li>Demonstrate how to execute a section of code a fixed number of
times</li>
<li>Demonstrate how to conditionally execute a section of code</li>
<li>Demonstrate how to execute a section of code on a list of items</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="programs-are-rarely-linear"><h2 class="section-heading">Programs are rarely linear<a class="anchor" aria-label="anchor" href="#programs-are-rarely-linear"></a>
</h2>
<hr class="half-width">
<p>Most programs do not work by executing a simple sequential set of
statements. The code is constructed so that decisions and different
paths through the program can be taken based on changes in variable
values.</p>
<p>To make this possible all programming language have a set of control
structures which allow this to happen.</p>
<p>In this episode we are going to look at how we can create loops and
branches in our Python code. Specifically we will look at three control
structures, namely:</p>
<ul>
<li>if..else..</li>
<li>while…</li>
<li>for …</li>
</ul></section><section id="the-if-statement-and-variants"><h2 class="section-heading">The <code>if</code> statement and variants<a class="anchor" aria-label="anchor" href="#the-if-statement-and-variants"></a>
</h2>
<hr class="half-width">
<p>The simple <code>if</code> statement allows the program to branch
based on the evaluation of an expression</p>
<p>The basic format of the <code>if</code> statement is:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="cf">if</span> expression :</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>    statement <span class="dv">1</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>    statement <span class="dv">2</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>    ...</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>    statement n</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>statement always executed</span></code></pre>
</div>
<p>If the expression evaluates to <code>True</code> then the statements
1 to n will be executed followed by
<code>statement always executed</code> . If the expression is
<code>False</code>, only <code>statement always executed</code> is
executed. Python knows which lines of code are related to the
<code>if</code> statement by the indentation, no extra syntax is
necessary.</p>
<p>Below are some examples:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Example 1</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>value <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>threshold<span class="op">=</span> <span class="dv">4</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"value is"</span>, value, <span class="st">"threshold is "</span>,threshold)</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="cf">if</span> value <span class="op">&gt;</span> threshold :</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>    <span class="bu">print</span>(value, <span class="st">"is bigger than "</span>, threshold)</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Example 2</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>high_threshold <span class="op">=</span> <span class="dv">6</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"value is"</span>, value, <span class="st">"new threshold is "</span>,high_threshold)</span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="cf">if</span> value <span class="op">&gt;</span> high_threshold :</span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a>    <span class="bu">print</span>(value , <span class="st">"is above "</span>, high_threshold, <span class="st">"threshold"</span>)</span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Example 3</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a>mid_threshold <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"value is"</span>, value, <span class="st">"final threshold is "</span>,mid_threshold)</span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a><span class="cf">if</span> value <span class="op">==</span> mid_threshold :</span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"value, "</span>, value, <span class="st">" and threshold,"</span>, mid_threshold, <span class="st">", are equal"</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Example 1

value is 5 threshold is 4
5 is bigger than 4

Example 2

value is 5 new threshold is 6

Example 3

value is 5 final threshold is 5
value, 5, and threshold, 5, are equal</code></pre>
</div>
<p>In the examples above there are three things to notice:</p>
<ol style="list-style-type: decimal">
<li>The colon <code>:</code> at the end of the <code>if</code> line.
Leaving this out is a common error.</li>
<li>The indentation of the print statement. If you remembered the
<code>:</code> on the line before, Jupyter (or any other Python IDE)
will automatically do the indentation for you. All of the statements
indented at this level are considered to be part of the <code>if</code>
statement. This is a feature fairly unique to Python, that it cares
about the indentation. If there is too much, or too little indentation,
you will get an error.</li>
<li>The <code>if</code> statement is ended by removing the indent. There
is no explicit end to the <code>if</code> statement as there is in many
other programming languages</li>
</ol>
<p>In the last example, notice that in Python the operator used to check
equality is <code>==</code>.</p>
<div id="exercise" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#exercise"></a>
</h3>
<div class="callout-content">
<p>Add another if statement to example 2 that will check if b is greater
than or equal to a</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Show me the solution</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Example 2a</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>a<span class="op">=</span> <span class="dv">3</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>b<span class="op">=</span> <span class="dv">4</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"a is"</span>, a, <span class="st">"b is"</span>,b)</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="cf">if</span> a <span class="op">&gt;</span> b :</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>    <span class="bu">print</span>(a, <span class="st">"is bigger than "</span>, b)</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="cf">if</span> a <span class="op">&lt;=</span> b :</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>    <span class="bu">print</span>(b, <span class="st">"is bigger than or equal to "</span>, a)</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Instead of using two separate <code>if</code> statements to decide
which is larger we can use the <code>if ... else ...</code>
construct</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># if ... else ...</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>value <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>threshold <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"value = "</span>, value, <span class="st">"and threshold = "</span>, threshold)</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="cf">if</span> value <span class="op">&gt;</span> threshold :</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"above threshold"</span>)</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="cf">else</span> :</span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"below threshold"</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>value = 4 and threshold = 5
below threshold</code></pre>
</div>
<div id="exercise-1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="exercise-1" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#exercise-1"></a>
</h3>
<div class="callout-content">
<p>Repeat above with different operators ‘&lt;’ , ‘==’</p>
</div>
</div>
</div>
<p>A further extension of the <code>if</code> statement is the
<code>if ... elif ...else</code> version.</p>
<p>The example below allows you to be more specific about the comparison
of a and b.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># if ... elif ... else ... endIf</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>a <span class="op">=</span> <span class="dv">5</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>b <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"a = "</span>, a, <span class="st">"and b = "</span>, b)</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="cf">if</span> a <span class="op">&gt;</span> b :</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>    <span class="bu">print</span>(a, <span class="st">" is greater than "</span>, b)</span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="cf">elif</span> a <span class="op">==</span> b :</span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a>    <span class="bu">print</span>(a, <span class="st">" equals "</span>, b)</span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="cf">else</span> :</span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a>    <span class="bu">print</span>(a, <span class="st">" is less than "</span>, b)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>a = 5 and b = 4
5 is greater than 4</code></pre>
</div>
<p>The overall structure is similar to the <code>if ... else</code>
statement. There are three additional things to notice:</p>
<ol style="list-style-type: decimal">
<li>Each <code>elif</code> clause has its own test expression.</li>
<li>You can have as many <code>elif</code> clauses as you need</li>
<li>Execution of the whole statement stops after an <code>elif</code>
expression is found to be True. Therefore the ordering of the
<code>elif</code> clause can be significant.</li>
</ol></section><section id="the-while-loop"><h2 class="section-heading">The <code>while</code> loop<a class="anchor" aria-label="anchor" href="#the-while-loop"></a>
</h2>
<hr class="half-width">
<p>The while loop is used to repeatedly execute lines of code until some
condition becomes False.</p>
<p>For the loop to terminate, there has to be something in the code
which will potentially change the condition.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># while loop</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>n <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>cur_sum <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co"># sum of n  numbers</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>i <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="cf">while</span>  i <span class="op">&lt;=</span> n :</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>    cur_sum <span class="op">=</span> cur_sum <span class="op">+</span> i</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>    i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The sum of the numbers from 1 to"</span>, n, <span class="st">"is "</span>, cur_sum)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The sum of the numbers from 1 to 10 is 55</code></pre>
</div>
<p>Points to note:</p>
<ol style="list-style-type: decimal">
<li>The condition clause (i &lt;= n) in the while statement can be
anything which when evaluated would return a Boolean value of either
True of False. Initially i has been set to 1 (before the start of the
loop) and therefore the condition is <code>True</code>.</li>
<li>The clause can be made more complex by use of parentheses and
<code>and</code> and <code>or</code> operators amongst others</li>
<li>The statements after the while clause are only executed if the
condition evaluates as True.</li>
<li>Within the statements after the while clause there should be
something which potentially will make the condition evaluate as
<code>False</code> next time around. If not the loop will never
end.</li>
<li>In this case the last statement in the loop changes the value of i
which is part of the condition clause, so hopefully the loop will
end.</li>
<li>We called our variable <code>cur_sum</code> and not <code>sum</code>
because <code>sum</code> is a builtin function (try typing it in, notice
the editor changes it to green). If we define <code>sum = 0</code> now
we can’t use the function <code>sum</code> in this Python session.</li>
</ol>
<div id="exercise---things-that-can-go-wrong-with-while-loops" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise---things-that-can-go-wrong-with-while-loops" class="callout-inner">
<h3 class="callout-title">Exercise - Things that can go wrong with while
loops<a class="anchor" aria-label="anchor" href="#exercise---things-that-can-go-wrong-with-while-loops"></a>
</h3>
<div class="callout-content">
<p>In the examples below, without running them try to decide why we will
not get the required answer. Run each, one at a time, and then correct
them. Remember that when the input next to a notebook cell is [*] your
Python interpreter is still working.</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="co"># while loop - summing the numbers 1 to 10</span></span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>n <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>cur_sum <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="co"># sum of n  numbers</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>i <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="cf">while</span>  i <span class="op">&lt;=</span> n :</span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>    i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a>    cur_sum <span class="op">=</span> cur_sum <span class="op">+</span> i</span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a>    </span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The sum of the numbers from 1 to"</span>, n, <span class="st">"is "</span>, cur_sum)</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># while loop - summing the numbers 1 to 10</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>n <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>cur_sum <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>boolvalue <span class="op">=</span> <span class="va">False</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="co"># sum of n  numbers</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>i <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="cf">while</span>  i <span class="op">&lt;=</span> n <span class="kw">and</span> boolvalue:</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>    cur_sum <span class="op">=</span> cur_sum <span class="op">+</span> i</span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>    i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a>    </span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The sum of the numbers from 1 to"</span>, n, <span class="st">"is "</span>, cur_sum)</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># while loop - summing the numbers 1 to 10</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>n <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>cur_sum <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="co"># sum of n  numbers</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>i <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a><span class="cf">while</span>  i <span class="op">!=</span> n :</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>    cur_sum <span class="op">=</span> cur_sum <span class="op">+</span> i</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>    i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The sum of the numbers from 1 to"</span>, n, <span class="st">"is "</span>, cur_sum)</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># while loop - summing the numbers 1.1 to 9.9 i. steps of 1.1</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>n <span class="op">=</span> <span class="fl">9.9</span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>cur_sum <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="co"># sum of n  numbers</span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>i <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a><span class="cf">while</span>  i <span class="op">!=</span> n :</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>    cur_sum <span class="op">=</span> cur_sum <span class="op">+</span> i</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>    i <span class="op">=</span> i <span class="op">+</span> <span class="fl">1.1</span></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>    <span class="bu">print</span>(i)</span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a>    </span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The sum of the numbers from 1.1 to"</span>, n, <span class="st">"is "</span>, <span class="bu">sum</span>)</span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Show me the solution</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li>Because i is incremented before the sum, you are summing 1 to
11.</li>
<li>The Boolean value is set to False the loop will never be
executed.</li>
<li>When i does equal 10 the expression is False and the loop does not
execute so we have only summed 1 to 9</li>
<li>Because you cannot guarantee the internal representation of Float,
you should never try to compare them for equality. In this particular
case the i never ‘equals’ n and so the loop never ends. - If you did try
running this, you can stop it using <kbd>Ctrl</kbd>+<kbd>c</kbd> in a
terminal or going to the kernel menu of a notebook and choosing
interrupt.</li>
</ol>
</div>
</div>
</div>
</div>
</section><section id="the-for-loop"><h2 class="section-heading">The <code>for</code> loop<a class="anchor" aria-label="anchor" href="#the-for-loop"></a>
</h2>
<hr class="half-width">
<p>The for loop, like the while loop repeatedly executes a set of
statements. The difference is that in the for loop we know in at the
outset how often the statements in the loop will be executed. We don’t
have to rely on a variable being changed within the looping
statements.</p>
<p>The basic format of the <code>for</code> statement is</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="cf">for</span> variable_name <span class="kw">in</span> some_sequence :</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>    statement1</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>    statement2</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>    ...</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>    statementn</span></code></pre>
</div>
<p>The key part of this is the <code>some_sequence</code>. The phrase
used in the documentation is that it must be ‘iterable’. That means, you
can count through the sequence, starting at the beginning and stopping
at the end.</p>
<p>There are many examples of things which are iterable some of which we
have already come across.</p>
<ul>
<li>Lists are iterable - they don’t have to contain numbers, you iterate
over the elements in the list.</li>
<li>The <code>range()</code> function</li>
<li>The characters in a string</li>
</ul>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Example 1</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>] :</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>    <span class="bu">print</span>(i)</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Example 2</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a><span class="cf">for</span> name <span class="kw">in</span> [<span class="st">"Tom"</span>, <span class="st">"Dick"</span>, <span class="st">"Harry"</span>] :</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>    <span class="bu">print</span>(name)</span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Example 3</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a><span class="cf">for</span> name <span class="kw">in</span> [<span class="st">"Tom"</span>, <span class="dv">42</span>, <span class="fl">3.142</span>] :</span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a>    <span class="bu">print</span>(name)</span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a></span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Example 4</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>) :</span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a>    <span class="bu">print</span>(i)</span>
<span id="cb16-16"><a href="#cb16-16" tabindex="-1"></a></span>
<span id="cb16-17"><a href="#cb16-17" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Example 5</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb16-18"><a href="#cb16-18" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">4</span>) :</span>
<span id="cb16-19"><a href="#cb16-19" tabindex="-1"></a>    <span class="bu">print</span>(i)</span>
<span id="cb16-20"><a href="#cb16-20" tabindex="-1"></a></span>
<span id="cb16-21"><a href="#cb16-21" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Example 6</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb16-22"><a href="#cb16-22" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span>, <span class="dv">11</span>, <span class="dv">2</span>) :</span>
<span id="cb16-23"><a href="#cb16-23" tabindex="-1"></a>    <span class="bu">print</span>(i)</span>
<span id="cb16-24"><a href="#cb16-24" tabindex="-1"></a></span>
<span id="cb16-25"><a href="#cb16-25" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Example 7</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb16-26"><a href="#cb16-26" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="st">"ABCDE"</span> :</span>
<span id="cb16-27"><a href="#cb16-27" tabindex="-1"></a>    <span class="bu">print</span>(i)</span>
<span id="cb16-28"><a href="#cb16-28" tabindex="-1"></a></span>
<span id="cb16-29"><a href="#cb16-29" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Example 8</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb16-30"><a href="#cb16-30" tabindex="-1"></a>longString <span class="op">=</span> <span class="st">"The quick brown fox jumped over the lazy sleeping dog"</span></span>
<span id="cb16-31"><a href="#cb16-31" tabindex="-1"></a><span class="cf">for</span> word <span class="kw">in</span> longString.split() :</span>
<span id="cb16-32"><a href="#cb16-32" tabindex="-1"></a>    <span class="bu">print</span>(word)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Example 1

1
2
3

Example 2

Tom
Dick
Harry

Example 3

Tom
42
3.142

Example 4

0
1
2

Example 5

1
2
3

Example 6

2
4
6
8
10

Example 7

A
B
C
D
E

Example 8

The
quick
brown
fox
jumped
over
the
lazy
sleeping
dog</code></pre>
</div>
<div id="exercise-2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-2" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#exercise-2"></a>
</h3>
<div class="callout-content">
<p>Suppose that we have a string containing a set of 4 different types
of values separated by <code>,</code> like this:</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>variablelist <span class="op">=</span> <span class="st">"01/01/2010,34.5,Yellow,True"</span></span></code></pre>
</div>
<p>Research the <code>split()</code> method and then rewrite example 8
from the <code>for</code> loop section above so that it prints the 4
components of <code>variablelist</code></p>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">Show me the solution</h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="co"># From the for loop section above</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>variablelist <span class="op">=</span> <span class="st">"01/01/2010,34.5,Yellow,True"</span></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a><span class="cf">for</span> word <span class="kw">in</span> variablelist.split(<span class="st">","</span>) :</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>    <span class="bu">print</span>(word)</span></code></pre>
</div>
<p>The format of <code>variablelist</code> is very much like that of a
record in a csv file. In later episodes we will see how we can extract
these values and assign them to variables for further processing rather
than printing them out.</p>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Most programs will require ‘Loops’ and ‘Branching’ constructs.</li>
<li>The <code>if</code>, <code>elif</code>, <code>else</code> statements
allow for branching in code.</li>
<li>The <code>for</code> and <code>while</code> statements allow for
looping through sections of code</li>
<li>The programmer must provide a condition to end a <code>while</code>
loop.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-04-reusable"><p>Content from <a href="04-reusable.html">Creating re-usable code</a></p>
<hr>
<p>Last updated on 2023-05-04 |
        
        <a href="https://github.com/datacarpentry/python-socialsci/edit/main/episodes/04-reusable.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 40 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What are user defined functions?</li>
<li>How can I automate my code for re-use?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Describe the syntax for a user defined function</li>
<li>Create and use simple functions</li>
<li>Explain the advantages of using functions</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="defining-a-function"><h2 class="section-heading">Defining a function<a class="anchor" aria-label="anchor" href="#defining-a-function"></a>
</h2>
<hr class="half-width">
<p>We have already made use of several Python builtin functions like
<code>print</code>, <code>list</code> and <code>range</code>.</p>
<p>In addition to the functions provided by Python, you can write your
own functions.</p>
<p>Functions are used when a section of code needs to be repeated at
various different points in a program. It saves you re-writing it all.
In reality you rarely need to repeat the exact same code. Usually there
will be some variation in variable values needed. Because of this, when
you create a function you are allowed to specify a set of
<code>parameters</code> which represent variables in the function.</p>
<p>In our use of the <code>print</code> function, we have provided
whatever we want to <code>print</code>, as a <code>parameter</code>.
Typically whenever we use the <code>print</code> function, we pass a
different <code>parameter</code> value.</p>
<p>The ability to specify parameters make functions very flexible.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="kw">def</span> get_item_count(items_str,sep):</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>    <span class="co">'''</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="co">    This function takes a string with a list of items and the character that they're separated by and returns the number of items</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co">    '''</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>    items_list <span class="op">=</span> items_str.split(sep)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>    num_items <span class="op">=</span> <span class="bu">len</span>(items_list)</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>    <span class="cf">return</span> num_items</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>items_owned <span class="op">=</span> <span class="st">"bicycle;television;solar_panel;table"</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="bu">print</span>(get_item_count(items_owned,<span class="st">';'</span>))</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">4</span></span></code></pre>
</div>
<figure><img src="../fig/functionAnatomy.png" alt="Python_Repl" class="figure mx-auto d-block"></figure><p>Points to note:</p>
<ol style="list-style-type: decimal">
<li>The definition of a function (or procedure) starts with the def
keyword and is followed by the name of the function with any parameters
used by the function in parentheses.</li>
<li>The definition clause is terminated with a <code>:</code> which
causes indentation on the next and subsequent lines. All of these lines
form the statements which make up the function. The function ends after
the indentation is removed.</li>
<li>Within the function, the parameters behave as variables whose
initial values will be those that they were given when the function was
called.</li>
<li>functions have a return statement which specifies the value to be
returned. This is the value assigned to the variable on the left-hand
side of the call to the function. (power in the example above)</li>
<li>You call (run the code) of a function simply by providing its name
and values for its parameters the same way you would for any builtin
function.</li>
<li>Once the definition of the function has been executed, it becomes
part of Python for the current session and can be used anywhere.</li>
<li>Like any other builtin function you can use <code>shift</code> +
<code>tab</code> in Jupyter to see the parameters.</li>
<li>At the beginning of the function code we have a multiline
<code>comment</code> denoted by the <code>'''</code> at the beginning
and end. This kind of comment is known as a <code>docstring</code> and
can be used anywhere in Python code as a documentation aid. It is
particularly common, and indeed best practice, to use them to give a
brief description of the function at the beginning of a function
definition in this way. This is because this description will be
displayed along with the parameters when you use the help() function or
<code>shift</code> + <code>tab</code> in Jupyter.</li>
<li>The variable <code>x</code> defined within the function only exists
within the function, it cannot be used outside in the main program.</li>
</ol>
<p>In our <code>get_item_count</code> function we have two parameters
which must be provided every time the function is used. You need to
provide the parameters in the right order or to explicitly name the
parameter you are referring to and use the <code>=</code> sign to give
it a value.</p>
<p>In many cases of functions we want to provide default values for
parameters so the user doesn’t have to. We can do this in the following
way</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="kw">def</span> get_item_count(items_str,sep<span class="op">=</span><span class="st">';'</span>):</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>    <span class="co">'''</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co">    This function takes a string with a list of items and the character that they're separated by and returns the number of items</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co">    '''</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>    items_list <span class="op">=</span> items_str.split(sep)</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>    num_items <span class="op">=</span> <span class="bu">len</span>(items_list)</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>    <span class="cf">return</span> num_items</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="bu">print</span>(get_item_count(items_owned))</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">4</span></span></code></pre>
</div>
<p>The only change we have made is to provide a default value for the
<code>sep</code> parameter. Now if the user does not provide a value,
then the value of 2 will be used. Because <code>items_str</code> is the
first parameter we can specify its value by position. We could however
have explicitly named the parameters we were referring to.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="bu">print</span>(get_item_count(items_owned, sep <span class="op">=</span> <span class="st">','</span>))</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="bu">print</span>(get_item_count(items_str <span class="op">=</span> items_owned, sep<span class="op">=</span><span class="st">';'</span>))</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">1</span></span>
<span><span class="fl">4</span></span></code></pre>
</div>
<div id="volume-of-a-cube" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="volume-of-a-cube" class="callout-inner">
<h3 class="callout-title">Volume of a cube<a class="anchor" aria-label="anchor" href="#volume-of-a-cube"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li><p>Write a function definition to calculate the volume of a cuboid.
The function will use three parameters <code>h</code>, <code>w</code>
and <code>l</code> and return the volume.</p></li>
<li><p>Supposing that in addition to the volume I also wanted to
calculate the surface area and the sum of all of the edges. Would I (or
should I) have three separate functions or could I write a single
function to provide all three values together?</p></li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Show me the solution</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<ul>
<li>A function to calculate the volume of a cuboid could be:</li>
</ul>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="kw">def</span> calculate_vol_cuboid(h, w, <span class="bu">len</span>):</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="co">    Calculates the volume of a cuboid.</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co">    Takes in h, w, len, that represent height, width, and length of the cube.</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co">    Returns the volume.</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>    volume <span class="op">=</span> h <span class="op">*</span> w <span class="op">*</span> <span class="bu">len</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>    <span class="cf">return</span> volume</span></code></pre>
</div>
<ul>
<li>It depends. As a rule-of-thumb, we want our function to <strong>do
one thing and one thing only, and to do it well.</strong> If we always
have to calculate these three pieces of information, the ‘one thing’
could be ‘calculate the volume, surface area, and sum of all edges of a
cube’. Our function would look like this:</li>
</ul>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co"># Method 1 - single function</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="kw">def</span> calculate_cuboid(h, w, <span class="bu">len</span>):</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co">    Calculates information about a cuboid defined by the dimensions h(eight), w(idth), and len(gth).</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="co">    Returns the volume, surface area, and sum of edges of the cuboid.</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>    volume <span class="op">=</span> h <span class="op">*</span> w <span class="op">*</span> <span class="bu">len</span></span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>    surface_area <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> (h <span class="op">*</span> w <span class="op">+</span> h <span class="op">*</span> <span class="bu">len</span> <span class="op">+</span> <span class="bu">len</span> <span class="op">*</span> w)</span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a>    edges <span class="op">=</span> <span class="dv">4</span> <span class="op">*</span> (h <span class="op">+</span> w <span class="op">+</span> <span class="bu">len</span>)</span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a>    <span class="cf">return</span> volume, surface_area, edges</span></code></pre>
</div>
<p>It may be better, however, to break down our function into separate
ones - one for each piece of information we are calculating. Our
functions would look like this:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># Method 2 - separate functions</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="kw">def</span> calc_volume_of_cuboid(h, w, <span class="bu">len</span>):</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co">    Calculates the volume of a cuboid defined by the dimensions h(eight), w(idth), and len(gth).</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>    volume <span class="op">=</span> h <span class="op">*</span> w <span class="op">*</span> <span class="bu">len</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>    <span class="cf">return</span> volume</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="kw">def</span> calc_surface_area_of_cuboid(h, w, <span class="bu">len</span>):</span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="co">    Calculates the surface area of a cuboid defined by the dimensions h(eight), w(idth), and len(gth).</span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a><span class="co">    """</span>   </span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a>    surface_area <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> (h <span class="op">*</span> w <span class="op">+</span> h <span class="op">*</span> <span class="bu">len</span> <span class="op">+</span> <span class="bu">len</span> <span class="op">*</span> w)</span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a>    <span class="cf">return</span> surface_area</span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a></span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a></span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a><span class="kw">def</span> calc_sum_of_edges_of_cuboid(h, w, <span class="bu">len</span>):</span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb9-20"><a href="#cb9-20" tabindex="-1"></a><span class="co">    Calculates the sum of edges of a cuboid defined by the dimensions h(eight), w(idth), and len(gth).</span></span>
<span id="cb9-21"><a href="#cb9-21" tabindex="-1"></a><span class="co">    """</span>   </span>
<span id="cb9-22"><a href="#cb9-22" tabindex="-1"></a>    sum_of_edges <span class="op">=</span> <span class="dv">4</span> <span class="op">*</span> (h <span class="op">+</span> w <span class="op">+</span> <span class="bu">len</span>)</span>
<span id="cb9-23"><a href="#cb9-23" tabindex="-1"></a>    <span class="cf">return</span> sum_of_edges</span></code></pre>
</div>
<p>We could then rewrite our first solution:</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="kw">def</span> calculate_cuboid(h, w, <span class="bu">len</span>):</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a><span class="co">    Calculates information about a cuboid defined by the dimensions h(eight), w(idth), and len(gth).</span></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a><span class="co">    Returns the volume, surface area, and sum of edges of the cuboid.</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>    volume <span class="op">=</span> calc_volume_of_cuboid(h, w, <span class="bu">len</span>)</span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>    surface_area <span class="op">=</span> calc_surface_area_of_cuboid(h, w, <span class="bu">len</span>)</span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>    edges <span class="op">=</span> calc_sum_of_edges_of_cuboid(h, w, <span class="bu">len</span>)</span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>    <span class="cf">return</span> volume, surface_area, edges</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section id="using-libraries"><h2 class="section-heading">Using libraries<a class="anchor" aria-label="anchor" href="#using-libraries"></a>
</h2>
<hr class="half-width">
<p>The functions we have created above only exist for the duration of
the session in which they have been defined. If you start a new Jupyter
notebook you will have to run the code to define them again.</p>
<p>If all of your code is in a single file or notebook this isn’t really
a problem.</p>
<p>There are however many (thousands) of useful functions which other
people have written and have made available to all Python users by
creating libraries (also referred to as packages or modules) of
functions.</p>
<p>You can find out what all of these libraries are and their contents
by visiting the main (python.org) site.</p>
<p>We need to go through a 2-step process before we can use them in our
own programs.</p>
<p>Step 1. use the <code>pip</code> command from the commandline.
<code>pip</code> is installed as part of the Python install and is used
to fetch the package from the Internet and install it in your Python
configuration.</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">BASH<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode bash" tabindex="0"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="ex">$</span> pip install <span class="op">&lt;</span>package name<span class="op">&gt;</span></span></code></pre>
</div>
<p>pip stands for Python install package and is a commandline function.
Because we are using the Anaconda distribution of Python, all of the
packages that we will be using in this lesson are already installed for
us, so we can move straight on to step 2.</p>
<p>Step 2. In your Python code include an
<code>import package-name</code> statement. Once this is done, you can
use all of the functions contained within the package.</p>
<p>As all of these packages are produced by 3rd parties independently of
each other, there is the strong possibility that there may be clashes in
function names. To allow for this, when you are calling a function from
a package that you have imported, you do so by prefixing the function
name with the package name. This can make for long-winded function names
so the <code>import</code> statement allows you to specify an
<code>alias</code> for the package name which you must then use instead
of the package name.</p>
<p>In future episodes, we will be importing the <code>csv</code>,
<code>json</code>, <code>pandas</code>, <code>numpy</code> and
<code>matplotlib</code> modules. We will describe their use as we use
them.</p>
<p>The code that we will use is shown below</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="im">import</span> csv</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span></code></pre>
</div>
<p>The first two we don’t alias as they have short names. The last three
we do. Matplotlib is a very large library broken up into what can be
thought of as sub-libraries. As we will only be using the functions
contained in the <code>pyplot</code> sub-library we can specify that
explicitly when we import. This saves time and space. It does not effect
how we call the functions in our code.</p>
<p>The <code>alias</code> we use (specified after the <code>as</code>
keyword) is entirely up to us. However those shown here for
<code>pandas</code>, <code>numpy</code> and <code>matplotlib</code> are
nearly universally adopted conventions used for these popular libraries.
If you are searching for code examples for these libraries on the
Internet, using these aliases will appear most of the time.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Functions are used to create re-usable sections of code</li>
<li>Using parameters with functions make them more flexible</li>
<li>You can use functions written by others by importing the libraries
containing them into your code</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-05-processing-data-from-file"><p>Content from <a href="05-processing-data-from-file.html">Processing data from a file</a></p>
<hr>
<p>Last updated on 2023-05-04 |
        
        <a href="https://github.com/datacarpentry/python-socialsci/edit/main/episodes/05-processing-data-from-file.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 70 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I read and write files?</li>
<li>What kind of data files can I read?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Describe a file handle</li>
<li>Use <code>with open() as</code> to open files for reading and
auto-close files</li>
<li>Create and open for writing or appending and auto-close files</li>
<li>Explain what is meant by a record</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="reading-and-writing-datasets"><h2 class="section-heading">Reading and Writing datasets<a class="anchor" aria-label="anchor" href="#reading-and-writing-datasets"></a>
</h2>
<hr class="half-width">
<p>In all of our examples so far, we have directly allocated values to
variables in the code we have written before using the variables.</p>
<p>Python has an <code>input()</code> function which will ask for input
from the user, but for any large amounts of data this will be an
impractical way of collecting data.</p>
<p>The reality is that most of the data that your program uses will be
read from a file. Additionally, apart from when you are developing, most
of your program output will be written to a file.</p>
<p>In this episode we will look at how to read and write files of data
in Python.</p>
<p>There are in fact many different approaches to reading data files and
which one you choose will depend on such things as the size of the file
and the data format of the file.</p>
<p>In this episode we will;</p>
<ul>
<li>We will read a file which is in .csv (Comma Separated Values)
format.</li>
<li>We will use standard core Python functions to do this</li>
<li>We will read the file one line at a time ( line = record = row of a
table)</li>
<li>We will perform simple processing of the file data and print the
output</li>
<li>We will split the file into smaller files based on some
processing</li>
</ul>
<p>The file we will be using is only a small file (131 data records),
but the approach we are using will work for any size of file. Imagine
131M records. This is because we only process one record at a time so
the memory requirements of the programs will be very small. The larger
the file the more the processing time required.</p>
<p>Other approaches to reading files will typically expect to read the
whole file in one go. This can be efficient when you subsequently
process the data but it require large amounts of memory to hold the
entire file. We will look at this approach later when the look at the
Pandas package.</p>
<p>For our examples in this episode we are going to use the
SAFI_results.csv file. This is available for download <a href="../data/SAFI_results.csv">here</a> and the description of the file is
available <a href="https://datacarpentry.org/socialsci-workshop/data/index.html" class="external-link">here</a>.</p>
<p>The code assumes that the file is in the same directory as your
notebook.</p>
<p>We will build up our programs in simple steps.</p>
<div class="section level3">
<h3 id="step-1---open-the-file-read-through-it-and-close-the-file">Step 1 - Open the file , read through it and close the file<a class="anchor" aria-label="anchor" href="#step-1---open-the-file-read-through-it-and-close-the-file"></a>
</h3>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">"SAFI_results.csv"</span>) <span class="im">as</span> f:       <span class="co"># Open the file and assign it to a new variable which we call 'f'.</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>                                          <span class="co"># The file will be read-only by default.</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>                                          <span class="co"># As long as the following code is indented, the file 'f' will be open.</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> f:                        <span class="co"># We use a for loop to iterate through the file one line at a time.</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>        <span class="bu">print</span>(line)                       <span class="co"># We simply print the line.</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>        </span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"I'm on to something else now."</span>)    <span class="co"># When we are finished with this file, we stop indenting the code and the file is closed automatically.</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Column1,A01_interview_date,A03_quest_no,A04_start,A05_end,A06_province,A07_district,A08_ward,A09_village,A11_years_farm,A12_agr_assoc,B11_remittance_money,B16_years_liv,B17_parents_liv,B18_sp_parents_liv,B19_grand_liv,B20_sp_grand_liv,B_no_membrs,C01_respondent_roof_type,C02_respondent_wall_type,C02_respondent_wall_type_other,C03_respondent_floor_type,C04_window_type,C05_buildings_in_compound,C06_rooms,C07_other_buildings,D_plots_count,E01_water_use,E17_no_enough_water,E19_period_use,E20_exper_other,E21_other_meth,E23_memb_assoc,E24_resp_assoc,E25_fees_water,E26_affect_conflicts,E_no_group_count,E_yes_group_count,F04_need_money,F05_money_source_other,F06_crops_contr,F08_emply_lab,F09_du_labour,F10_liv_owned_other,F12_poultry,F13_du_look_aftr_cows,F_liv_count,G01_no_meals,_members_count,_note,gps:Accuracy,gps:Altitude,gps:Latitude,gps:Longitude,instanceID

0,17/11/2016,1,2017-03-23T09:49:57.000Z,2017-04-02T17:29:08.000Z,Province1,District1,Ward2,Village2,11,no,no,4,no,yes,no,yes,3,grass,muddaub,,earth,no,1,1,no,2,no,,,,,,,,,2,,,,,no,no,,yes,no,1,2,3,,14,698,-19.11225943,33.48345609,uuid:ec241f2c-0609-46ed-b5e8-fe575f6cefef
...</code></pre>
</div>
<p>You can think of the file as being a list of strings. Each string in
the list is one complete line from the file.</p>
<p>If you look at the output, you can see that the first record in the
file is a header record containing column names. When we read a file in
this way, the column headings have no significance, the computer sees
them as another record in the file.</p>
</div>
<div class="section level3">
<h3 id="step-2---select-a-specific-column-from-the-records-in-the-file">Step 2 - Select a specific ‘column’ from the records in the
file<a class="anchor" aria-label="anchor" href="#step-2---select-a-specific-column-from-the-records-in-the-file"></a>
</h3>
<p>We know that the first record in the file is a header record and we
want to ignore it. To do this we call the <code>readline()</code> method
of the file handle f. We don’t need to assign the line that it will
return to a variable as we are not going to use it.</p>
<p>As we read the file the line variable is a string containing a
complete record. The fields or columns of the record are separated by
each other by “,” as it is a csv file.</p>
<p>As line is a string we can use the <code>split()</code> method to
convert it to a list of column values. We are specicically going to
select the column which is the 19th entry in the list (remember the list
index starts at 0). This refers to the C01_respondent_roof_type column.
We are going to examine the different roof types.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span> (<span class="st">"SAFI_results.csv"</span>) <span class="im">as</span> f:  <span class="co"># Open the file and assign it to a variable called 'f'.</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>                                      <span class="co"># Indent the code to keep the file open. Stop indenting to close.</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>    f.readline()                      <span class="co"># First line is a header so ignore it.</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> f:</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>        <span class="bu">print</span>(line.split(<span class="st">","</span>)[<span class="dv">18</span>])    <span class="co"># Index 18, the 19th column is C01_respondent_roof_type.</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">grass</span></span>
<span><span class="va">grass</span></span>
<span><span class="va">mabatisloping</span></span>
<span><span class="va">mabatisloping</span></span>
<span><span class="va">grass</span></span>
<span><span class="va">grass</span></span>
<span><span class="va">grass</span></span>
<span><span class="va">mabatisloping</span></span>
<span><span class="va">...</span></span></code></pre>
</div>
<p>Having a list of the roof types from all of the records is one thing,
but it is more likely that we would want a count of each type. By
scanning up and down the previous output, there appear to be 3 different
types, but we will play safe and assume there may be more.</p>
</div>
<div class="section level3">
<h3 id="step-3---how-many-of-each-different-roof-types-are-there">Step 3 - How many of each different roof types are there?<a class="anchor" aria-label="anchor" href="#step-3---how-many-of-each-different-roof-types-are-there"></a>
</h3>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># 1</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span> (<span class="st">"SAFI_results.csv"</span>) <span class="im">as</span> f:</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co"># 2</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>    f.readline()</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co"># 3</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>    grass_roof <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>    mabatisloping_roof <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>    mabatipitched_roof <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>    roof_type_other <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> f:</span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="co"># 4</span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a>        roof_type <span class="op">=</span> line.split(<span class="st">","</span>)[<span class="dv">18</span>]</span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="co"># 5    </span></span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a>        <span class="cf">if</span> roof_type <span class="op">==</span> <span class="st">'grass'</span> :</span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a>            grass_roof <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a>        <span class="cf">elif</span> roof_type <span class="op">==</span> <span class="st">'mabatisloping'</span> :</span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a>            mabatisloping_roof <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a>        <span class="cf">elif</span> roof_type <span class="op">==</span> <span class="st">'mabatipitched'</span> :</span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a>            mabatipitched_roof <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb5-23"><a href="#cb5-23" tabindex="-1"></a>        <span class="cf">else</span> :</span>
<span id="cb5-24"><a href="#cb5-24" tabindex="-1"></a>            roof_type_other <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb5-25"><a href="#cb5-25" tabindex="-1"></a></span>
<span id="cb5-26"><a href="#cb5-26" tabindex="-1"></a><span class="co">#6</span></span>
<span id="cb5-27"><a href="#cb5-27" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"There are "</span>, grass_roof, <span class="st">" grass roofs"</span>)</span>
<span id="cb5-28"><a href="#cb5-28" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"There are "</span>, mabatisloping_roof, <span class="st">" mabatisloping roofs"</span>)</span>
<span id="cb5-29"><a href="#cb5-29" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"There are "</span>, mabatipitched_roof, <span class="st">" mabatipitchedg roofs"</span>)</span>
<span id="cb5-30"><a href="#cb5-30" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"There are "</span>, roof_type_other, <span class="st">" other roof types"</span>)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>There are 73 grass roofs
There are 48 mabatisloping roofs
There are 10 mabatipitchedg roofs
There are 0 other roof types</code></pre>
</div>
<p>What are we doing here?</p>
<ol style="list-style-type: decimal">
<li>Open the file</li>
<li>Ignore the headerline</li>
<li>Initialise roof type variables to 0</li>
<li>Extract the C01_respondent_roof_type information from each
record</li>
<li>Increment the appropriate variable</li>
<li>Print out the results (we have stopped indenting so the file will be
closed)</li>
</ol>
<p>Instead of printing out the counts of the roof types, you may want to
extract all of one particular roof type to a separate file. Let us
assume we want all of the grass roof records to be written to a
file.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># 1</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span> (<span class="st">"SAFI_results.csv"</span>) <span class="im">as</span> fr:              <span class="co"># Note how we have used a new variable name, 'fr'.</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>                                                   <span class="co"># The file is read-only by default.</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>    <span class="cf">with</span> <span class="bu">open</span> (<span class="st">"SAFI_grass_roof.csv"</span>, <span class="st">"w"</span>) <span class="im">as</span> fw:  <span class="co"># We are keeping 'fr' open so we indent.</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>                                                   <span class="co"># We specify a second parameter, "w" to make this file writeable.</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>                                                   <span class="co"># We use a different variable, 'fw'.</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>        <span class="cf">for</span> line <span class="kw">in</span> fr:</span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="co"># 2    </span></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a>            <span class="cf">if</span> line.split(<span class="st">","</span>)[<span class="dv">18</span>] <span class="op">==</span> <span class="st">'grass'</span> :</span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a>                fw.write(line)</span></code></pre>
</div>
<p>What are we doing here?</p>
<ol style="list-style-type: decimal">
<li>Open the files. Because there are now two files, each has its own
file handle: <code>fr</code> for the file we read and <code>fw</code>
for the file we are going to write. (They are just variable names so you
can use anything you like). For the file we are going to write to we use
<code>w</code> for the second parameter. If the file does not exist it
will be created. If it does exist, then the contents will be
overwritten. If we want to append to an existing file we can use
<code>a</code> as the second parameter.</li>
<li>Because we are just testing a specific field from the record to have
a certain value, we don’t need to put it into a variable first. If the
expression is True, then we use <code>write()</code> method to write the
complete line just as we read it to the output file.</li>
</ol>
<p>In this example we didn’t bother skipping the header line as it would
fail the test in the if statement. If we did want to include it we could
have added the line</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>fw.write(fr.readline())</span></code></pre>
</div>
<p>before the for loop</p>
<div id="exercise" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#exercise"></a>
</h3>
<div class="callout-content">
<p>From the SAFI_results.csv file extract all of the records where the
<code>C01_respondent_roof_type</code> (index 18) has a value of
<code>'grass'</code> and the <code>C02_respondent_wall_type</code>
(index 19) has a value of <code>'muddaub'</code> and write them to a
file. Within the same program write all of the records where
<code>C01_respondent_roof_type</code> (index 18) has a value of
<code>'grass'</code> and the <code>C02_respondent_wall_type</code>
(index 19) has a value of <code>'burntbricks'</code> and write them to a
separate file. In both files include the header record.</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Show me the solution</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span> (<span class="st">"SAFI_results.csv"</span>) <span class="im">as</span> fr:</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>   <span class="cf">with</span> <span class="bu">open</span> (<span class="st">"SAFI_grass_roof_muddaub.csv"</span>, <span class="st">"w"</span>) <span class="im">as</span> fw1:</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>      <span class="cf">with</span> <span class="bu">open</span> (<span class="st">"SAFI_grass_roof_burntbricks.csv"</span>, <span class="st">"w"</span>) <span class="im">as</span> fw2:</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>          headerline <span class="op">=</span> fr.readline()</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>          fw1.write(headerline)</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>          fw2.write(headerline)</span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>          <span class="cf">for</span> line <span class="kw">in</span> fr:</span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a>              <span class="cf">if</span> line.split(<span class="st">","</span>)[<span class="dv">18</span>] <span class="op">==</span> <span class="st">'grass'</span> :</span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a>                  <span class="cf">if</span> line.split(<span class="st">","</span>)[<span class="dv">19</span>] <span class="op">==</span> <span class="st">'muddaub'</span> :</span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a>                      fw1.write(line)</span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a>                  <span class="cf">if</span> line.split(<span class="st">","</span>)[<span class="dv">19</span>] <span class="op">==</span> <span class="st">'burntbricks'</span> :</span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a>                      fw2.write(line)    </span></code></pre>
</div>
</div>
</div>
</div>
</div>
<p>In our example of printing the counts for the roof types, we assumed
that we knew what the likely roof types were. Although we did have an
<code>'other'</code> option to catch anything we missed. Had there been
any we would still be non the wiser as to what they represented. We were
able to decide on the specific roof types by manually scanning the list
of <code>C01_respondent_roof_type</code> values. This was only practical
because of the small file size. For a multi-million record file we could
not have done this.</p>
<p>We would like a way of creating a list of the different roof types
and at the same time counting them. We can do this by using not a Python
list structure, but a Python dictionary.</p>
</div>
</section><section id="the-python-dictionary-structure"><h2 class="section-heading">The Python dictionary structure<a class="anchor" aria-label="anchor" href="#the-python-dictionary-structure"></a>
</h2>
<hr class="half-width">
<p>In Python a dictionary object maps keys to values. A dictionary can
hold any number of keys and values but a key cannot be duplicated.</p>
<p>The following code shows examples of creating a dictionary object and
manipulating keys and values.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># an empty dictionary</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>myDict <span class="op">=</span> {}</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="co"># A dictionary with a single Key-value pair</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>personDict <span class="op">=</span> {<span class="st">'Name'</span> : <span class="st">'Peter'</span>}</span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a><span class="co"># I can add more about 'Peter' to the dictionary</span></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>personDict[<span class="st">'Location'</span>] <span class="op">=</span> <span class="st">'Manchester'</span></span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a><span class="co"># I can print all of the keys and values from the dictionary</span></span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a></span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a><span class="bu">print</span>(personDict.items())</span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a></span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a><span class="co"># I can print all of the keys and values from the dictionary - and make it look a bit nicer</span></span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a></span>
<span id="cb10-19"><a href="#cb10-19" tabindex="-1"></a><span class="cf">for</span> item <span class="kw">in</span> personDict:</span>
<span id="cb10-20"><a href="#cb10-20" tabindex="-1"></a>    <span class="bu">print</span>(item, <span class="st">"="</span>, personDict[item])</span>
<span id="cb10-21"><a href="#cb10-21" tabindex="-1"></a></span>
<span id="cb10-22"><a href="#cb10-22" tabindex="-1"></a><span class="co"># or all of the keys</span></span>
<span id="cb10-23"><a href="#cb10-23" tabindex="-1"></a></span>
<span id="cb10-24"><a href="#cb10-24" tabindex="-1"></a><span class="bu">print</span>(personDict.keys())</span>
<span id="cb10-25"><a href="#cb10-25" tabindex="-1"></a></span>
<span id="cb10-26"><a href="#cb10-26" tabindex="-1"></a><span class="co"># or all of the values</span></span>
<span id="cb10-27"><a href="#cb10-27" tabindex="-1"></a></span>
<span id="cb10-28"><a href="#cb10-28" tabindex="-1"></a><span class="bu">print</span>(personDict.values())</span>
<span id="cb10-29"><a href="#cb10-29" tabindex="-1"></a></span>
<span id="cb10-30"><a href="#cb10-30" tabindex="-1"></a><span class="co"># I can access the value for a given key</span></span>
<span id="cb10-31"><a href="#cb10-31" tabindex="-1"></a></span>
<span id="cb10-32"><a href="#cb10-32" tabindex="-1"></a>x <span class="op">=</span> personDict[<span class="st">'Name'</span>]</span>
<span id="cb10-33"><a href="#cb10-33" tabindex="-1"></a><span class="bu">print</span>(x)</span>
<span id="cb10-34"><a href="#cb10-34" tabindex="-1"></a></span>
<span id="cb10-35"><a href="#cb10-35" tabindex="-1"></a><span class="co"># I can change value for a given key</span></span>
<span id="cb10-36"><a href="#cb10-36" tabindex="-1"></a></span>
<span id="cb10-37"><a href="#cb10-37" tabindex="-1"></a>personDict[<span class="st">'Name'</span>] <span class="op">=</span> <span class="st">"Fred"</span></span>
<span id="cb10-38"><a href="#cb10-38" tabindex="-1"></a><span class="bu">print</span>(personDict[<span class="st">'Name'</span>])</span>
<span id="cb10-39"><a href="#cb10-39" tabindex="-1"></a></span>
<span id="cb10-40"><a href="#cb10-40" tabindex="-1"></a><span class="co"># I can check if a key exists</span></span>
<span id="cb10-41"><a href="#cb10-41" tabindex="-1"></a></span>
<span id="cb10-42"><a href="#cb10-42" tabindex="-1"></a>key <span class="op">=</span> <span class="st">'Name'</span></span>
<span id="cb10-43"><a href="#cb10-43" tabindex="-1"></a></span>
<span id="cb10-44"><a href="#cb10-44" tabindex="-1"></a><span class="cf">if</span> key <span class="kw">in</span> personDict :</span>
<span id="cb10-45"><a href="#cb10-45" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"already exists"</span>)</span>
<span id="cb10-46"><a href="#cb10-46" tabindex="-1"></a><span class="cf">else</span> :</span>
<span id="cb10-47"><a href="#cb10-47" tabindex="-1"></a>    personDict[key] <span class="op">=</span> <span class="st">"New value"</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>dict_items([('Location', 'Manchester'), ('Name', 'Peter')])
Location = Manchester
Name = Peter
dict_keys(['Location', 'Name'])
dict_values(['Manchester', 'Peter'])
Peter
Fred
already exists</code></pre>
</div>
<div id="exercise-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-1" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#exercise-1"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>Create a dictionary called <code>dict_roof_types</code> with initial
keys of <code>type1</code> and <code>type2</code> and give them values
of 1 and 3.</li>
<li>Add a third key <code>type3</code> with a value of 6.</li>
<li>Add code to check if a key of <code>type4</code> exists. If it does
not add it to the dictionary with a value of 1 if it does, increment its
value by 1</li>
<li>Add code to check if a key of <code>type2</code> exists. If it does
not add it to the dictionary with a value of 1 if it does, increment its
value by 1</li>
<li>Print out all of the keys and values from the dictionary</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Show me the solution</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="co"># 1</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>dict_roof_types <span class="op">=</span> {<span class="st">'type1'</span> : <span class="dv">1</span> , <span class="st">'type2'</span> : <span class="dv">3</span>}</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="co"># 2</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>dict_roof_types[<span class="st">'type3'</span>] <span class="op">=</span> <span class="dv">6</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="co"># 3</span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>key <span class="op">=</span> <span class="st">'type4'</span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="cf">if</span> key <span class="kw">in</span> dict_roof_types :</span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a>    dict_roof_types[key] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a><span class="cf">else</span> :</span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a>    dict_roof_types[key] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a></span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a><span class="co"># 4</span></span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a>key <span class="op">=</span> <span class="st">'type2'</span></span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a><span class="cf">if</span> key <span class="kw">in</span> dict_roof_types :</span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a>    dict_roof_types[key] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a><span class="cf">else</span> :</span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a>    dict_roof_types[key] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a> </span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a><span class="co"># 5</span></span>
<span id="cb12-23"><a href="#cb12-23" tabindex="-1"></a><span class="cf">for</span> item <span class="kw">in</span> dict_roof_types:</span>
<span id="cb12-24"><a href="#cb12-24" tabindex="-1"></a>    <span class="bu">print</span>(item, <span class="st">"="</span>, dict_roof_types[item])</span>
<span id="cb12-25"><a href="#cb12-25" tabindex="-1"></a>    </span></code></pre>
</div>
</div>
</div>
</div>
</div>
<p>We are now in a position to re-write our count of roof types example
without knowing in advance what any of the roof types are.</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># 1</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span> (<span class="st">"SAFI_results.csv"</span>) <span class="im">as</span> f:</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="co"># 2</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>    f.readline()</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a><span class="co"># 3</span></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>    dict_roof_types <span class="op">=</span> {}</span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> f:</span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a><span class="co"># 4</span></span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a>        roof_type <span class="op">=</span> line.split(<span class="st">","</span>)[<span class="dv">18</span>]</span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a><span class="co"># 5    </span></span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a>        <span class="cf">if</span> roof_type <span class="kw">in</span> dict_roof_types :</span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a>            dict_roof_types[roof_type] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a>        <span class="cf">else</span> :</span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a>            dict_roof_types[roof_type] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a></span>
<span id="cb13-19"><a href="#cb13-19" tabindex="-1"></a><span class="co"># 6</span></span>
<span id="cb13-20"><a href="#cb13-20" tabindex="-1"></a></span>
<span id="cb13-21"><a href="#cb13-21" tabindex="-1"></a><span class="cf">for</span> item <span class="kw">in</span> dict_roof_types:</span>
<span id="cb13-22"><a href="#cb13-22" tabindex="-1"></a>    <span class="bu">print</span>(item, <span class="st">"="</span>, dict_roof_types[item])</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">grass</span> <span class="op">=</span> <span class="fl">73</span></span>
<span><span class="va">mabatisloping</span> <span class="op">=</span> <span class="fl">48</span></span>
<span><span class="va">mabatipitched</span> <span class="op">=</span> <span class="fl">10</span></span></code></pre>
</div>
<p>What are we doing here?</p>
<ol style="list-style-type: decimal">
<li>Open the file</li>
<li>Ignore the headerline</li>
<li>Create an empty dictionary</li>
<li>Extract the C01_respondent_roof_type information from each
record</li>
<li>Either add to the dictionary with a value of 1 or increment the
current value for the key by 1</li>
<li>Print out the contents of the dictionary (stopped indenting so file
is closed)</li>
</ol>
<p>You can apply the same approach to count values in any of the
fields/columns of the file.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Reading data from files is far more common than program ‘input’
requests or hard coding values</li>
<li>Python provides simple means of reading from a text file and writing
to a text file</li>
<li>Tabular data is commonly recorded in a ‘csv’ file</li>
<li>Text files like csv files can be thought of as being a list of
strings. Each string is a complete record</li>
<li>You can read and write a file one record at a time</li>
<li>Python has builtin functions to parse (split up) records into
individual tokens</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-06-date-and-time"><p>Content from <a href="06-date-and-time.html">Dates and Time</a></p>
<hr>
<p>Last updated on 2023-05-04 |
        
        <a href="https://github.com/datacarpentry/python-socialsci/edit/main/episodes/06-date-and-time.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 25 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How are dates and time represented in Python?</li>
<li>How can I manipulate dates and times?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Describe some of the datetime functions available in Python</li>
<li>Describe the use of format strings to describe the layout of a date
and/or time string</li>
<li>Make use of date arithmetic</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="date-and-times-in-python"><h2 class="section-heading">Date and Times in Python<a class="anchor" aria-label="anchor" href="#date-and-times-in-python"></a>
</h2>
<hr class="half-width">
<p>Python can be very flexible in how it interprets ‘strings’ which you
want to be considered as a date, time, or date and time, but you have to
tell Python how the various parts of the date and/or time are
represented in your ‘string’. You can do this by creating a
<code>format</code>. In a <code>format</code>, different case sensitive
characters preceded by the <code>%</code> character act as placeholders
for parts of the date/time, for example <code>%Y</code> represents year
formatted as 4 digit number such as 2014.</p>
<p>A full list of the characters used and what they represent can be
found towards the end of the <a href="https://docs.python.org/3/library/datetime.html" class="external-link">datetime</a>
section of the official Python documentation.</p>
<p>There is a <code>today()</code> method which allows you to get the
current date and time. By default it is displayed in a format similar to
the <a href="https://en.wikipedia.org/wiki/ISO_8601" class="external-link">ISO 8601</a>
standard format.</p>
<p>To use the date and time functions you need to import the
<code>datetime</code> module.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>today <span class="op">=</span> datetime.today()</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'ISO     :'</span>, today)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>ISO     : 2018-04-12 16:19:17.177441</code></pre>
</div>
<p>We can use our own formatting instead. For example, if we wanted
words instead of number and the 4 digit year at the end we could use the
following.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="bu">format</span> <span class="op">=</span> <span class="st">"%a %b </span><span class="sc">%d</span><span class="st"> %H:%M:%S %Y"</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>today_str <span class="op">=</span> today.strftime(<span class="bu">format</span>)</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'strftime:'</span>, today_str)</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(today_str))</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>today_date <span class="op">=</span> datetime.strptime(today_str, <span class="bu">format</span>)</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'strptime:'</span>, today_date.strftime(<span class="bu">format</span>))</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(today_date))</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>strftime: Thu Apr 12 16:19:17 2018
&lt;class 'str'&gt;
strptime: Thu Apr 12 16:19:17 2018
&lt;class 'datetime.datetime'&gt;</code></pre>
</div>
<p><code>strftime</code> converts a datetime object to a string and
<code>strptime</code> creates a datetime object from a string. When you
print them using the same format string, they look the same.</p>
<p>The format of the date fields in the SAFI_results.csv file have been
generated automatically to comform to the <a href="https://en.wikipedia.org/wiki/ISO_8601" class="external-link">ISO 8601</a> standard.</p>
<p>When we read the file and extract the date fields, they are of type
string. Before we can use them as dates, we need to convert them into
Python date objects.</p>
<p>In the format string we use below, the <code>-</code> ,
<code>:</code> , <code>T</code> and <code>Z</code> characters are just
that, characters in the string representing the date/time. Only the
character preceded with <code>%</code> have special meanings.</p>
<p>Having converted the strings to datetime objects, there are a variety
of methods that we can use to extract different components of the
date/time.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="bu">format</span> <span class="op">=</span> <span class="st">"%Y-%m-</span><span class="sc">%d</span><span class="st">T%H:%M:%S.</span><span class="sc">%f</span><span class="st">Z"</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>f <span class="op">=</span> <span class="bu">open</span>(<span class="st">'SAFI_results.csv'</span>, <span class="st">'r'</span>)</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="co">#skip the header line</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>line <span class="op">=</span> f.readline()</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="co"># next line has data</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>line <span class="op">=</span> f.readline()</span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a>strdate_start <span class="op">=</span> line.split(<span class="st">','</span>)[<span class="dv">3</span>]  <span class="co"># A04_start</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a>strdate_end <span class="op">=</span> line.split(<span class="st">','</span>)[<span class="dv">4</span>]    <span class="co"># A05_end</span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(strdate_start), strdate_start)</span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(strdate_end), strdate_end)</span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a></span>
<span id="cb5-19"><a href="#cb5-19" tabindex="-1"></a></span>
<span id="cb5-20"><a href="#cb5-20" tabindex="-1"></a><span class="co"># the full date and time</span></span>
<span id="cb5-21"><a href="#cb5-21" tabindex="-1"></a>datetime_start <span class="op">=</span> datetime.strptime(strdate_start, <span class="bu">format</span>)</span>
<span id="cb5-22"><a href="#cb5-22" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(datetime_start))</span>
<span id="cb5-23"><a href="#cb5-23" tabindex="-1"></a>datetime_end <span class="op">=</span> datetime.strptime(strdate_end, <span class="bu">format</span>)</span>
<span id="cb5-24"><a href="#cb5-24" tabindex="-1"></a></span>
<span id="cb5-25"><a href="#cb5-25" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'formatted date and time'</span>, datetime_start)</span>
<span id="cb5-26"><a href="#cb5-26" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'formatted date and time'</span>, datetime_end)</span>
<span id="cb5-27"><a href="#cb5-27" tabindex="-1"></a></span>
<span id="cb5-28"><a href="#cb5-28" tabindex="-1"></a></span>
<span id="cb5-29"><a href="#cb5-29" tabindex="-1"></a><span class="co"># the date component</span></span>
<span id="cb5-30"><a href="#cb5-30" tabindex="-1"></a>date_start <span class="op">=</span> datetime.strptime(strdate_start, <span class="bu">format</span>).date()</span>
<span id="cb5-31"><a href="#cb5-31" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(date_start))</span>
<span id="cb5-32"><a href="#cb5-32" tabindex="-1"></a>date_end <span class="op">=</span> datetime.strptime(strdate_end, <span class="bu">format</span>).date()</span>
<span id="cb5-33"><a href="#cb5-33" tabindex="-1"></a></span>
<span id="cb5-34"><a href="#cb5-34" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'formatted start date'</span>, date_start)</span>
<span id="cb5-35"><a href="#cb5-35" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'formatted end date'</span>, date_end)</span>
<span id="cb5-36"><a href="#cb5-36" tabindex="-1"></a></span>
<span id="cb5-37"><a href="#cb5-37" tabindex="-1"></a><span class="co"># the time component</span></span>
<span id="cb5-38"><a href="#cb5-38" tabindex="-1"></a>time_start <span class="op">=</span> datetime.strptime(strdate_start, <span class="bu">format</span>).time()</span>
<span id="cb5-39"><a href="#cb5-39" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(time_start))</span>
<span id="cb5-40"><a href="#cb5-40" tabindex="-1"></a>time_end <span class="op">=</span> datetime.strptime(strdate_end, <span class="bu">format</span>).time()</span>
<span id="cb5-41"><a href="#cb5-41" tabindex="-1"></a></span>
<span id="cb5-42"><a href="#cb5-42" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'formatted start time'</span>, time_start)</span>
<span id="cb5-43"><a href="#cb5-43" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'formatted end time'</span>, time_end)</span>
<span id="cb5-44"><a href="#cb5-44" tabindex="-1"></a></span>
<span id="cb5-45"><a href="#cb5-45" tabindex="-1"></a></span>
<span id="cb5-46"><a href="#cb5-46" tabindex="-1"></a>f.close()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>&lt;class 'str'&gt; 2017-03-23T09:49:57.000Z
&lt;class 'str'&gt; 2017-04-02T17:29:08.000Z
&lt;class 'datetime.datetime'&gt;
formatted date and time 2017-03-23 09:49:57
formatted date and time 2017-04-02 17:29:08
&lt;class 'datetime.date'&gt;
formatted start date 2017-03-23
formatted end date 2017-04-02
&lt;class 'datetime.time'&gt;
formatted start time 09:49:57
formatted end time 17:29:08</code></pre>
</div>
</section><section id="components-of-dates-and-times"><h2 class="section-heading">Components of dates and times<a class="anchor" aria-label="anchor" href="#components-of-dates-and-times"></a>
</h2>
<hr class="half-width">
<p>For a date or time we can also extract individual components of them.
They are held internally in the datetime datastructure.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># date parts.</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'formatted end date'</span>, date_end)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="bu">print</span>(<span class="st">' end date year'</span>, date_end.year)</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="bu">print</span>(<span class="st">' end date month'</span>, date_end.month)</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="bu">print</span>(<span class="st">' end date day'</span>, date_end.day)</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="bu">print</span> (<span class="bu">type</span>(date_end.day))</span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co"># time parts.</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'formatted end time'</span>, time_end)</span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a><span class="bu">print</span>(<span class="st">' end time hour'</span>, time_end.hour)</span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a><span class="bu">print</span>(<span class="st">' end time minutes'</span>, time_end.minute)</span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a><span class="bu">print</span>(<span class="st">' end time seconds'</span>, time_end.second)</span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(time_end.second))</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>formatted end date 2017-04-02
 end date year 2017
 end date month 4
 end date day 2
&lt;class 'int'&gt;
formatted end time 17:29:08
 end time hour 17
 end time minutes 29
 end time seconds 8
&lt;class 'int'&gt;</code></pre>
</div>
</section><section id="date-arithmetic"><h2 class="section-heading">Date arithmetic<a class="anchor" aria-label="anchor" href="#date-arithmetic"></a>
</h2>
<hr class="half-width">
<p>We can also do arithmetic with the dates.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>date_diff <span class="op">=</span> datetime_end <span class="op">-</span> datetime_start</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>date_diff</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(datetime_start))</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(date_diff))</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="bu">print</span>(date_diff)</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>date_diff <span class="op">=</span> datetime_start <span class="op">-</span> datetime_end</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(date_diff))</span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="bu">print</span>(date_diff)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>&lt;class 'datetime.datetime'&gt;
&lt;class 'datetime.timedelta'&gt;
10 days, 7:39:11
&lt;class 'datetime.timedelta'&gt;
-11 days, 16:20:49</code></pre>
</div>
<div id="exercise" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="exercise" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#exercise"></a>
</h3>
<div class="callout-content">
<p>How do you interpret the last result?</p>
</div>
</div>
</div>
<p>The code below calculates the time difference between supposedly
starting the survey and ending the survey (for each respondent).</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="bu">format</span> <span class="op">=</span> <span class="st">"%Y-%m-</span><span class="sc">%d</span><span class="st">T%H:%M:%S.</span><span class="sc">%f</span><span class="st">Z"</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>f <span class="op">=</span> <span class="bu">open</span>(<span class="st">'SAFI_results.csv'</span>, <span class="st">'r'</span>)</span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" tabindex="-1"></a>line <span class="op">=</span> f.readline()</span>
<span id="cb11-8"><a href="#cb11-8" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" tabindex="-1"></a><span class="cf">for</span> line <span class="kw">in</span> f:</span>
<span id="cb11-10"><a href="#cb11-10" tabindex="-1"></a>    <span class="co">#print(line)</span></span>
<span id="cb11-11"><a href="#cb11-11" tabindex="-1"></a>    strdate_start <span class="op">=</span> line.split(<span class="st">','</span>)[<span class="dv">3</span>]</span>
<span id="cb11-12"><a href="#cb11-12" tabindex="-1"></a>    strdate_end <span class="op">=</span> line.split(<span class="st">','</span>)[<span class="dv">4</span>]</span>
<span id="cb11-13"><a href="#cb11-13" tabindex="-1"></a></span>
<span id="cb11-14"><a href="#cb11-14" tabindex="-1"></a>    datetime_start <span class="op">=</span> datetime.strptime(strdate_start, <span class="bu">format</span>)</span>
<span id="cb11-15"><a href="#cb11-15" tabindex="-1"></a>    datetime_end <span class="op">=</span> datetime.strptime(strdate_end, <span class="bu">format</span>)</span>
<span id="cb11-16"><a href="#cb11-16" tabindex="-1"></a>    date_diff <span class="op">=</span> datetime_end <span class="op">-</span> datetime_start</span>
<span id="cb11-17"><a href="#cb11-17" tabindex="-1"></a>    <span class="bu">print</span>(datetime_start, datetime_end, date_diff )</span>
<span id="cb11-18"><a href="#cb11-18" tabindex="-1"></a></span>
<span id="cb11-19"><a href="#cb11-19" tabindex="-1"></a></span>
<span id="cb11-20"><a href="#cb11-20" tabindex="-1"></a>f.close()</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>2017-03-23 09:49:57 2017-04-02 17:29:08 10 days, 7:39:11
2017-04-02 09:48:16 2017-04-02 17:26:19 7:38:03
2017-04-02 14:35:26 2017-04-02 17:26:53 2:51:27
2017-04-02 14:55:18 2017-04-02 17:27:16 2:31:58
2017-04-02 15:10:35 2017-04-02 17:27:35 2:17:00
2017-04-02 15:27:25 2017-04-02 17:28:02 2:00:37
2017-04-02 15:38:01 2017-04-02 17:28:19 1:50:18
2017-04-02 15:59:52 2017-04-02 17:28:39 1:28:47
2017-04-02 16:23:36 2017-04-02 16:42:08 0:18:32
...</code></pre>
</div>
<div id="exercise-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-1" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#exercise-1"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li><p>In the <code>SAFI_results.csv</code> file the
<code>A01_interview_date field</code> (index 1) contains a date in the
form of ‘dd/mm/yyyy’. Read the file and calculate the differences in
days (because the interview date is only given to the day) between the
<code>A01_interview_date</code> values and the <code>A04_start</code>
values. You will need to create a format string for the
<code>A01_interview_date</code> field.</p></li>
<li><p>Looking at the results here and from the previous section of
code. Do you think the use of the smartphone data entry system for the
survey was being used in real time?</p></li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Show me the solution</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>format1 <span class="op">=</span> <span class="st">"%Y-%m-</span><span class="sc">%d</span><span class="st">T%H:%M:%S.</span><span class="sc">%f</span><span class="st">Z"</span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>format2 <span class="op">=</span> <span class="st">"</span><span class="sc">%d</span><span class="st">/%m/%Y"</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>f <span class="op">=</span> <span class="bu">open</span>(<span class="st">'SAFI_results.csv'</span>, <span class="st">'r'</span>)</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a>line <span class="op">=</span> f.readline()</span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a><span class="cf">for</span> line <span class="kw">in</span> f:</span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a>    A01 <span class="op">=</span> line.split(<span class="st">','</span>)[<span class="dv">1</span>]</span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a>    A04 <span class="op">=</span> line.split(<span class="st">','</span>)[<span class="dv">3</span>]</span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a>   </span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a>    datetime_A04 <span class="op">=</span> datetime.strptime(A04, format1)</span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a>    datetime_A01 <span class="op">=</span> datetime.strptime(A01, format2)</span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a>    date_diff <span class="op">=</span> datetime_A04 <span class="op">-</span> datetime_A01</span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a>    <span class="bu">print</span>(datetime_A04, datetime_A01, date_diff.days )</span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a>     </span>
<span id="cb13-19"><a href="#cb13-19" tabindex="-1"></a>f.close()</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Date and Time functions in Python come from the datetime library,
which needs to be imported</li>
<li>You can use format strings to have dates/times displayed in any
representation you like</li>
<li>Internally date and times are stored in special data structures
which allow you to access the component parts of dates and times</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-07-json"><p>Content from <a href="07-json.html">Processing JSON data</a></p>
<hr>
<p>Last updated on 2023-05-04 |
        
        <a href="https://github.com/datacarpentry/python-socialsci/edit/main/episodes/07-json.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 45 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is JSON format?</li>
<li>How can I extract specific data items from a JSON record?</li>
<li>How can I convert an array of JSON record into a table?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Describe the JSON data format</li>
<li>Understand where JSON is typically used</li>
<li>Appreciate some advantages of using JSON over tabular data</li>
<li>Appreciate some dis-advantages of processing JSON documents</li>
<li>Compare JSON to the Python Dict data type</li>
<li>Use the JSON package to read a JSON file</li>
<li>Display formatted JSON</li>
<li>Select and display specific fields from a JSON document</li>
<li>Write tabular data from selected elements from a JSON document to a
csv file</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="more-on-dictionaries"><h2 class="section-heading">More on Dictionaries<a class="anchor" aria-label="anchor" href="#more-on-dictionaries"></a>
</h2>
<hr class="half-width">
<p>In the <a href="05-processing-data-from-file.html">Processing data
from file</a> episode we introduced the dictionary object.</p>
<p>We created dictionaries and we added <code>key : value</code> pairs
to the dictionary.</p>
<p>In all of the examples that we used, the <code>value</code> was
always a simple data type like an integer or a string.</p>
<p>The <code>value</code> associated with a <code>key</code> in a
dictionary can be of any type including a <code>list</code> or even
another <code>dictionary</code>.</p>
<p>We created a simple dictionary object with the following code:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>personDict <span class="op">=</span> {<span class="st">'Name'</span> : <span class="st">'Peter'</span>}</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>personDict[<span class="st">'Location'</span>] <span class="op">=</span> <span class="st">'Manchester'</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="bu">print</span>(personDict)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>{'Name': 'Peter', 'Location': 'Manchester'}</code></pre>
</div>
<p>So far the keys in the dictionary each relate to a single piece of
information about the person. What if we wanted to add a list of
items?</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>personDict[<span class="st">'Children'</span>] <span class="op">=</span> [<span class="st">'John'</span>, <span class="st">'Jane'</span>, <span class="st">'Jack'</span>]</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>personDict[<span class="st">'Children_count'</span>] <span class="op">=</span> <span class="dv">3</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="bu">print</span>(personDict)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>{'Name': 'Peter', 'Children': ['John', 'Jane', 'Jack'], 'Children_count': 3, 'Location': 'Manchester'}</code></pre>
</div>
<p>Not only can I have a key where the value is a list, the value could
also be another dictionary object. Suppose I want to add some telephone
numbers</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>personDict[<span class="st">'phones'</span>] <span class="op">=</span> {<span class="st">'home'</span> : <span class="st">'0102345678'</span>, <span class="st">'mobile'</span> : <span class="st">'07770123456'</span>}</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="bu">print</span>(personDict.values())</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="co"># adding another phone</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>personDict[<span class="st">'phones'</span>][<span class="st">'business'</span>] <span class="op">=</span>  <span class="st">'0161234234546'</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="bu">print</span>(personDict)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>dict_values(['Peter', ['John', 'Jane', 'Jack'], {'home': '0102345678', 'mobile': '07770123456'}, 3, 'Manchester'])
{'Name': 'Peter', 'Children': ['John', 'Jane', 'Jack'], 'phones': {'home': '0102345678', 'mobile': '07770123456', 'business': '0161234234546'}, 'Children_count': 3, 'Location': 'Manchester'}</code></pre>
</div>
<div id="exercise" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#exercise"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>Using the personDict as a base add information relating to the
persons home and work addresses including postcodes.</li>
<li>Print out the postcode for the work address.</li>
<li>Print out the names of the children on seperate lines (i.e. not as a
list)</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Show me the solution</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>personDict[<span class="st">'Addresses'</span>] <span class="op">=</span> {<span class="st">'Home'</span> : {<span class="st">'Addressline1'</span> : <span class="st">'23 acacia ave.'</span>, <span class="st">'Addressline2'</span> : <span class="st">'Romford'</span>, <span class="st">'PostCode'</span> : <span class="st">'RO6 5WR'</span>},</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>                          <span class="st">'Work'</span> : {<span class="st">'Addressline1'</span> : <span class="st">'19 Orford Road.'</span>, <span class="st">'Addressline2'</span> : <span class="st">'London'</span>, <span class="st">'PostCode'</span> : <span class="st">'EC4J 3XY'</span>}</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>                          }</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="bu">print</span>(personDict[<span class="st">'Addresses'</span>][<span class="st">'Work'</span>][<span class="st">'PostCode'</span>])</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="cf">for</span> child <span class="kw">in</span> personDict[<span class="st">'Children'</span>]:</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>    <span class="bu">print</span>(child)</span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>    </span></code></pre>
</div>
</div>
</div>
</div>
</div>
<p>The ability to create dictionaries containing lists and other
dictionaries, makes the dictionary object very versatile, you can create
an arbitrarily complex data structure of dictionaries within
dictionaries.</p>
<p>In practice you will not be doing this manually, instead like most
data you will read it in from a file.</p>
</section><section id="the-json-data-format"><h2 class="section-heading">The JSON data format<a class="anchor" aria-label="anchor" href="#the-json-data-format"></a>
</h2>
<hr class="half-width">
<p>The JSON data format was designed as a way of allowing different
machines or processes within machines to communicate with each other by
sending messages constructed in a well defined format. JSON is now the
preferred data format used by APIs (Application Programming
Interfaces).</p>
<p>The JSON format although somewhat verbose is not only Human readable
but it can also be mapped very easily to a Python dictionary object.</p>
<p>We are going to read a file of data formatted as JSON, convert it
into a dictionary object in Python then selectively extract Key-Value
pairs and create a csv file from the extracted data.</p>
<p>The JSON file we are going to use is the <a href="../data/SAFI.json">SAFI.json</a> file. This is the output file from
an electronic survey system called ODK. The JSON represents the answers
to a series of survey questions. The questions themselves have been
replaced with unique Keys, the values are the answers.</p>
<p>Because detailed surveys are by nature nested structures making it
possible to record different levels of detail or selectively ask a set
of specific questions based on the answer given a previous question, the
structure of the answers for the survey can not only be complex and
convoluted, it could easily be different from one survey respondent’s
set of answers to another.</p>
<div class="section level3">
<h3 id="advantages-of-json">Advantages of JSON<a class="anchor" aria-label="anchor" href="#advantages-of-json"></a>
</h3>
<ul>
<li>Very popular data format for APIs (e.g. results from an Internet
search)</li>
<li>Human readable</li>
<li>Each record (or document as they are called) is self contained. The
equivalent of the column name and column values are in every
record.</li>
<li>Documents do not all have to have the same structure within the same
file</li>
<li>Document structures can be complex and nested</li>
</ul>
</div>
<div class="section level3">
<h3 id="dis-advantages-of-json">Dis-advantages of JSON<a class="anchor" aria-label="anchor" href="#dis-advantages-of-json"></a>
</h3>
<ul>
<li>It is more verbose than the equivalent data in csv format</li>
<li>Can be more difficult to process and display than csv formatted
data</li>
</ul>
</div>
<div class="section level3">
<h3 id="viewing-json-data">Viewing JSON data<a class="anchor" aria-label="anchor" href="#viewing-json-data"></a>
</h3>
<ul>
<li>JSON can often be viewed directly in the web browsers: <a href="https://api.crossref.org/works/10.1037/0003-066X.59.1.29/agency" class="external-link">example</a>.</li>
<li>Browser extensions are often available for ease of viewing JSON data
e.g., <a href="https://chrome.google.com/webstore/search/json?hl=en-US" class="external-link">Chrome</a>,
<a href="https://addons.mozilla.org/en-US/firefox/search/?q=json" class="external-link">Firefox</a>,
<a href="https://www.apple.com/us/search/json?src=serp" class="external-link">Safari</a>,
etc.</li>
<li>JSON files can be opened using text editors e.g., notepad, nano,
textedit, etc.</li>
<li>There are many websites which allow viewing or beautifying JSON data
with ease. For example, <a href="https://jsonviewer.stack.hu/" class="external-link">http://jsonviewer.stack.hu/</a>. Try
pasting or loading JSON data in the second tab called “text” on that
website and then clicking on the “format” button. Clicking on the first
tab, “viewer” also gives another view of the data.</li>
</ul>
</div>
</section><section id="use-the-json-package-to-read-a-json-file"><h2 class="section-heading">Use the JSON package to read a JSON file<a class="anchor" aria-label="anchor" href="#use-the-json-package-to-read-a-json-file"></a>
</h2>
<hr class="half-width">
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="im">import</span> json</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="cf">with</span> <span class="bu">open</span>(<span class="st">'SAFI.json'</span>) <span class="im">as</span> json_data:</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>    d <span class="op">=</span> json.load(json_data)</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>    <span class="bu">print</span>(<span class="bu">type</span>(d))</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>    <span class="bu">print</span>(<span class="bu">type</span>(d[<span class="dv">0</span>]))</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>    <span class="bu">print</span>(json.dumps(d[<span class="dv">0</span>], indent<span class="op">=</span><span class="dv">2</span>))</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>&lt;class 'list'&gt;
&lt;class 'dict'&gt;
{
  "G02_months_lack_food": [
    "Jan"
  ],
  "G01_no_meals": 2,
  "E_no_group_count": "2",
  "A03_quest_no": "01",
...</code></pre>
</div>
<p>Points to note:</p>
<ol style="list-style-type: decimal">
<li>We import the json package with an import statement.</li>
<li>We have chosen to use the <code>with</code> statement to open the
SAFI.json file. Notice the <code>:</code> at the end of the line and the
subsequent indentation. The <code>with</code> statement is in effect
until we un-indent. At which time the file will automatically be closed.
So we don’t need to do so explicitly.</li>
<li>‘json_data’ is the file handle.</li>
<li>The <code>json.load</code> method is passed the file handle and
reads the complete file.</li>
<li>The variable <code>d</code> is a list of dictionaries. (When we read
the csv file we considered it to be a list of strings).</li>
<li>The <code>json.dumps</code> method can be used to print either the
entire file or a specific dictionary from the list in a formatted manner
by using the indent parameter)</li>
</ol>
<p>By default the order in which the keys of the dictionary are printed
is not guaranteed. If we want them in sorted order we can have them
sorted by using the <code>sort_keys</code> parameter</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="bu">print</span>(json.dumps(d[<span class="dv">0</span>], indent<span class="op">=</span><span class="dv">2</span>, sort_keys<span class="op">=</span><span class="va">True</span>))</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>{
  "A01_interview_date": "2016-11-17",
  "A03_quest_no": "01",
  "A04_start": "2017-03-23T09:49:57.000Z",
  "A05_end": "2017-04-02T17:29:08.000Z",
  "A06_province": "province1",
...
}</code></pre>
</div>
</section><section id="extracting-specific-fields-from-a-json-document"><h2 class="section-heading">Extracting specific fields from a JSON document<a class="anchor" aria-label="anchor" href="#extracting-specific-fields-from-a-json-document"></a>
</h2>
<hr class="half-width">
<p>If we want to extract fields from a JSON document, the first step
isto convert the JSON document into a Python dictionary. We have in fact
already done this with the</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>d <span class="op">=</span> json.load(json_data)</span></code></pre>
</div>
<p>line. <code>d</code> a list object and each entry in the list is a
Dictionary object.</p>
</section><section id="extract-the-fields-we-want-into-a-flat-format"><h2 class="section-heading">Extract the fields we want into a flat format<a class="anchor" aria-label="anchor" href="#extract-the-fields-we-want-into-a-flat-format"></a>
</h2>
<hr class="half-width">
<p>Despite the arbitrary complexity of a JSON document or a Python
dictionary object, we can adopt a very systematic approach to extracting
individual fields form the structure.</p>
<p>The story so far: Our JSON file has been read into a variable
<code>d</code>. We know that <code>d</code> is a list of dictionaries.
Each dictionary represents a JSON document ( a record).</p>
<p>We can print the contents of the first dictionary in the list
with</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="bu">print</span>(json.dumps(d[<span class="dv">0</span>], indent<span class="op">=</span><span class="dv">2</span>, sort_keys<span class="op">=</span><span class="va">True</span>))</span></code></pre>
</div>
<div id="exercise-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-1" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#exercise-1"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li><p>In the output from the code above there is a key with the name of
<code>D_curr_crop</code>. Find it and by looking at the indentation and
the <code>[</code> (lists) and <code>{</code> (dictionaries) describe in
English how you could find the first occurrence of
<code>D_curr_crop</code> starting with <code>d</code>.</p></li>
<li><p>Use a print statement to find out what it is.</p></li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Show me the solution</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<ul>
<li>
<code>d</code> is a list of dictionaries</li>
<li>
<code>d[0]</code> is the first dictionary</li>
<li>within <code>d[0]</code> there is a key <code>D_plots</code> whose
value is a list and contains dictionaries</li>
<li>
<code>d[0]['D_plots'][0]</code> is the first dictionary in the
list</li>
<li>within <code>d[0]['D_plots'][0]</code> there is a key
<code>D_crops</code> which is also a list of dictionaries</li>
<li>
<code>d[0]['D_plots'][0]['D_crops'][0]</code> is the first
dictionary in the list</li>
<li>within this dictionary there is a key <code>D_curr_crop</code>
</li>
</ul>
<p>Being able to start at the outermost level and work your way in is
very important when you need to extract specific items.</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="bu">print</span>(d[<span class="dv">0</span>][<span class="st">'D_plots'</span>][<span class="dv">0</span>][<span class="st">'D_crops'</span>][<span class="dv">0</span>][<span class="st">'D_curr_crop'</span>])</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Being able to drill down in this way is very useful in helping you
get a feel for the JSON data structure. In practice it is more likely
that instead of returning the first occurrence of
<code>D_curr_crop</code> you will want to return all of them. This
requires a little more programming and to be aware of two potential
problems.</p>
<ol style="list-style-type: decimal">
<li>
<code>D_curr_crop</code> may not exist in any particular dictionary
within <code>D_crops</code>
</li>
<li>any of the lists <code>D_plots</code> or <code>D_crops</code> could
be missing or just empty lists (<code>[]</code>)</li>
</ol>
<p>In our first attempt we will ignore these problems.</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="cf">for</span> farms <span class="kw">in</span> d:</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>    plot <span class="op">=</span> farms[<span class="st">'D_plots'</span>]</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>    <span class="cf">for</span> crops <span class="kw">in</span> plot:</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>        crop <span class="op">=</span> crops[<span class="st">'D_crops'</span>]</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>        <span class="cf">for</span> curr_crops <span class="kw">in</span> crop:</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>            <span class="bu">print</span>(curr_crops[<span class="st">'D_curr_crop'</span>])</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="va">maize</span></span>
<span><span class="va">maize</span></span>
<span><span class="va">maize</span></span>
<span><span class="va">tomatoes</span></span>
<span><span class="va">vegetable</span></span>
<span><span class="va">maize</span></span>
<span><span class="va">maize</span></span>
<span><span class="va">maize</span></span>
<span><span class="va">sorghum</span></span>
<span><span class="va">...</span></span></code></pre>
</div>
<p>In this version we test if all of the keys exist. This could be
extended to check that the lists are not empty.</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="cf">for</span> farms <span class="kw">in</span> d:</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">'D_plots'</span> <span class="kw">in</span> farms :</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>        plot <span class="op">=</span> farms[<span class="st">'D_plots'</span>]</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>        <span class="cf">for</span> crops <span class="kw">in</span> plot:</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">'D_crops'</span> <span class="kw">in</span> crops :</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>                crop <span class="op">=</span> crops[<span class="st">'D_crops'</span>]</span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>                <span class="cf">for</span> curr_crops <span class="kw">in</span> crop:</span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>                    <span class="cf">if</span> <span class="st">'D_curr_crop'</span> <span class="kw">in</span> curr_crops:</span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>                        <span class="bu">print</span>(curr_crops[<span class="st">'D_curr_crop'</span>])</span></code></pre>
</div>
<p>We can now produce a list of all of the crops in all of the plots in
all of the farms.</p>
<p>We can also create a unique set of all of the crops grown using the
Python <code>set</code> data structure as shown in the code below. A set
is like a list but does not allow duplicate values (but doesn’t raise an
error if you try to add a duplicate).</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>unique_crops <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="cf">for</span> farms <span class="kw">in</span> d:</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">'D_plots'</span> <span class="kw">in</span> farms :</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>        plot <span class="op">=</span> farms[<span class="st">'D_plots'</span>]</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>        <span class="cf">for</span> crops <span class="kw">in</span> plot:</span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">'D_crops'</span> <span class="kw">in</span> crops :</span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>                crop <span class="op">=</span> crops[<span class="st">'D_crops'</span>]</span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>                <span class="cf">for</span> curr_crops <span class="kw">in</span> crop:</span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>                    <span class="cf">if</span> <span class="st">'D_curr_crop'</span> <span class="kw">in</span> curr_crops:</span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>                        <span class="co">#print(curr_crops['D_curr_crop'])</span></span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a>                        unique_crops.add(curr_crops[<span class="st">'D_curr_crop'</span>])</span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a><span class="bu">print</span>(unique_crops)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>{'peanut', 'potatoes', 'tomatoes', 'other', 'vegetable', 'amendoim', 'sunflower', 'bananas', 'sesame', None, 'cucumber', 'onion', 'sorghum', 'piri_piri', 'baby_corn', 'cabbage', 'ngogwe', 'maize', 'pigeonpeas', 'beans'}</code></pre>
</div>
<p>Simply having a list of all of the crops is unlikely to be enough.
What you are really interested in is which farm grows which crops in
which plot.</p>
<p>We can accumulate this information as we move through the list of
dictionary objects. At the top level, <code>farm</code>, there is a
unique identifier <code>A03_quest_no</code> which we can use. for the
plot and the crop within the plot we will create our own simple indexing
system (<code>plot_no</code> and <code>crop_no</code>). At the end
instead of just printing the crop name, we also print the details of
where this crop is being grown.</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a><span class="cf">for</span> farms <span class="kw">in</span> d:</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>    plot_no <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>    <span class="bu">id</span> <span class="op">=</span> farms[<span class="st">'A03_quest_no'</span>]</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">'D_plots'</span> <span class="kw">in</span> farms :</span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>        plot <span class="op">=</span> farms[<span class="st">'D_plots'</span>]</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>        <span class="cf">for</span> crops <span class="kw">in</span> plot:</span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a>            crop_no <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a>            plot_no <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">'D_crops'</span> <span class="kw">in</span> crops :</span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a>                crop <span class="op">=</span> crops[<span class="st">'D_crops'</span>]</span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a>                <span class="cf">for</span> curr_crops <span class="kw">in</span> crop:</span>
<span id="cb20-12"><a href="#cb20-12" tabindex="-1"></a>                    crop_no <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb20-13"><a href="#cb20-13" tabindex="-1"></a>                    <span class="cf">if</span> <span class="st">'D_curr_crop'</span> <span class="kw">in</span> curr_crops:</span>
<span id="cb20-14"><a href="#cb20-14" tabindex="-1"></a>                        <span class="bu">print</span>(<span class="st">"Farm no "</span>, <span class="bu">id</span>,<span class="st">" grows "</span>, curr_crops[<span class="st">'D_curr_crop'</span>],<span class="st">" in plot"</span>, plot_no , <span class="st">" and it is crop number "</span>, crop_no)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Farm no 01 grows maize in plot 1 and it is crop number 1
Farm no 01 grows maize in plot 2 and it is crop number 1
Farm no 01 grows maize in plot 1 and it is crop number 1
Farm no 01 grows tomatoes in plot 2 and it is crop number 1
Farm no 01 grows vegetable in plot 3 and it is crop number 1
...</code></pre>
</div>
<p>The final stage of this data extraction process is to save the
extracted data to a file for subsequent use.</p>
<p>Rather than manually appending all of the information items into a
string with <code>,</code> seperating each, we can use the
<code>csv</code> module.</p>
<p>To do this we need to create a <code>csv.writer</code> object and use
it to write complete rows of data at a time. <code>csv.writer</code>
expects the data to be provided as a list of items.</p>
<p>For the header row we provide a list of strings containing the colmn
names we want and at the end we proivide the data items in a list as
well.</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a><span class="im">import</span> csv</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>filename <span class="op">=</span> <span class="st">"SAFI_crops.csv"</span></span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>fw <span class="op">=</span> <span class="bu">open</span>(filename, <span class="st">'w'</span>)</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a>cf <span class="op">=</span> csv.writer(fw, lineterminator<span class="op">=</span><span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a><span class="co"># write the header</span></span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a>cf.writerow([<span class="st">"Farm"</span>,<span class="st">"plot_no"</span>,<span class="st">"plot_area"</span>,<span class="st">"crop_no"</span>,<span class="st">"crop_name"</span>])</span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a></span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a><span class="cf">for</span> farms <span class="kw">in</span> d:</span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a>    plot_no <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a>    <span class="bu">id</span> <span class="op">=</span> farms[<span class="st">'A03_quest_no'</span>]</span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a>    <span class="cf">if</span> <span class="st">'D_plots'</span> <span class="kw">in</span> farms :</span>
<span id="cb22-13"><a href="#cb22-13" tabindex="-1"></a>        plot <span class="op">=</span> farms[<span class="st">'D_plots'</span>]</span>
<span id="cb22-14"><a href="#cb22-14" tabindex="-1"></a>        <span class="cf">for</span> crops <span class="kw">in</span> plot:</span>
<span id="cb22-15"><a href="#cb22-15" tabindex="-1"></a>            crop_no <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb22-16"><a href="#cb22-16" tabindex="-1"></a>            plot_no <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb22-17"><a href="#cb22-17" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">'D_crops'</span> <span class="kw">in</span> crops :</span>
<span id="cb22-18"><a href="#cb22-18" tabindex="-1"></a>                plot_area <span class="op">=</span> crops[<span class="st">'D02_total_plot'</span>]</span>
<span id="cb22-19"><a href="#cb22-19" tabindex="-1"></a>                crop <span class="op">=</span> crops[<span class="st">'D_crops'</span>]</span>
<span id="cb22-20"><a href="#cb22-20" tabindex="-1"></a>                <span class="cf">for</span> curr_crops <span class="kw">in</span> crop:</span>
<span id="cb22-21"><a href="#cb22-21" tabindex="-1"></a>                    crop_no <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb22-22"><a href="#cb22-22" tabindex="-1"></a>                    <span class="cf">if</span> <span class="st">'D_curr_crop'</span> <span class="kw">in</span> curr_crops:</span>
<span id="cb22-23"><a href="#cb22-23" tabindex="-1"></a>                        <span class="co">#print( id, plot_no , plot_area , crop_no, curr_crops['D_curr_crop'])</span></span>
<span id="cb22-24"><a href="#cb22-24" tabindex="-1"></a>                        cf.writerow([<span class="bu">id</span>, plot_no , plot_area , crop_no, curr_crops[<span class="st">'D_curr_crop'</span>]])</span>
<span id="cb22-25"><a href="#cb22-25" tabindex="-1"></a></span>
<span id="cb22-26"><a href="#cb22-26" tabindex="-1"></a>fw.close()</span></code></pre>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>JSON is a popular data format for transferring data used by a great
many Web based APIs</li>
<li>The JSON data format is very similar to the Python Dictionary
structure.</li>
<li>The complex structure of a JSON document means that it cannot easily
be ‘flattened’ into tabular data</li>
<li>We can use Python code to extract values of interest and place them
in a csv file</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-08-Pandas"><p>Content from <a href="08-Pandas.html">Reading data from a file using Pandas</a></p>
<hr>
<p>Last updated on 2023-05-04 |
        
        <a href="https://github.com/datacarpentry/python-socialsci/edit/main/episodes/08-Pandas.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 20 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What is Pandas?</li>
<li>How do I read files using Pandas?</li>
<li>What is the difference between reading files using Pandas and other
methods of reading files?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain what a module is and how they are used in Python</li>
<li>Describe what the Python Data Analysis Library (pandas) is</li>
<li>Load the Python Data Analysis Library (pandas)</li>
<li>Use read_csv to read tabular data into Python</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="what-is-pandas"><h2 class="section-heading">What is Pandas?<a class="anchor" aria-label="anchor" href="#what-is-pandas"></a>
</h2>
<hr class="half-width">
<p>pandas is a Python library containing a set of functions and
specialised data structures that have been designed to help Python
programmers to perform data analysis tasks in a structured way.</p>
<p>Most of the things that pandas can do can be done with basic Python,
but the collected set of pandas functions and data structure makes the
data analysis tasks more consistent in terms of syntax and therefore
aids readabilty.</p>
<p>Particular features of pandas that we will be looking at over this
and the next couple of episodes include:</p>
<ul>
<li>Reading data stored in CSV files (other file formats can be read as
well)</li>
<li>Slicing and subsetting data in Dataframes (tables!)</li>
<li>Dealing with missing data</li>
<li>Reshaping data (long -&gt; wide, wide -&gt; long)</li>
<li>Inserting and deleting columns from data structures</li>
<li>Aggregating data using data grouping facilities using the
split-apply-combine paradigm</li>
<li>Joining of datasets (after they have been loaded into
Dataframes)</li>
</ul>
<p>If you are wondering why I write pandas with a lower case ‘p’ it is
because it is the name of the package and Python is case sensitive.</p>
</section><section id="importing-the-pandas-library"><h2 class="section-heading">Importing the pandas library<a class="anchor" aria-label="anchor" href="#importing-the-pandas-library"></a>
</h2>
<hr class="half-width">
<p>Importing the pandas library is done in exactly the same way as for
any other library. In almost all examples of Python code using the
pandas library, it will have been imported and given an alias of
<code>pd</code>. We will follow the same convention.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span></code></pre>
</div>
</section><section id="pandas-data-structures"><h2 class="section-heading">Pandas data structures<a class="anchor" aria-label="anchor" href="#pandas-data-structures"></a>
</h2>
<hr class="half-width">
<p>There are two main data structure used by pandas, they are the Series
and the Dataframe. The Series equates in general to a vector or a list.
The Dataframe is equivalent to a table. Each column in a pandas
Dataframe is a pandas Series data structure.</p>
<p>We will mainly be looking at the Dataframe.</p>
<p>We can easily create a Pandas Dataframe by reading a .csv file</p>
</section><section id="reading-a-csv-file"><h2 class="section-heading">Reading a csv file<a class="anchor" aria-label="anchor" href="#reading-a-csv-file"></a>
</h2>
<hr class="half-width">
<p>When we read a csv dataset in base Python we did so by opening the
dataset, reading and processing a record at a time and then closing the
dataset after we had read the last record. Reading datasets in this way
is slow and places all of the responsibility for extracting individual
data items of information from the records on the programmer.</p>
<p>The main advantage of this approach, however, is that you only have
to store one dataset record in memory at a time. This means that if you
have the time, you can process datasets of any size.</p>
<p>In Pandas, csv files are read as complete datasets. You do not have
to explicitly open and close the dataset. All of the dataset records are
assembled into a Dataframe. If your dataset has column headers in the
first record then these can be used as the Dataframe column names. You
can explicitly state this in the parameters to the call, but pandas is
usually able to infer that there ia a header row and use it
automatically.</p>
<p>For our examples in this episode we are going to use the SN7577.tab
file. This is available for download <a href="../data/SN7577.tab">here</a>
and the description of the file is available <a href="https://beta.ukdataservice.ac.uk/datacatalogue/studies/study?id=7577&amp;type=data%20catalogue#!/details" class="external-link">here</a></p>
<p>We are going to read in our SN7577.tab file. Although this is a tab
delimited file we will still use the pandas <code>read_csv</code>
method, but we will explicitly tell the method that the separator is the
tab character and not a comma which is the default.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>df_SN7577 <span class="op">=</span> pd.read_csv(<span class="st">"SN7577.tab"</span>, sep<span class="op">=</span><span class="st">'</span><span class="ch">\t</span><span class="st">'</span>)</span></code></pre>
</div>
<div id="exercise" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#exercise"></a>
</h3>
<div class="callout-content">
<p>What happens if you forget to specify <code>sep='\t'</code> when
reading a tab delimited dataset</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Show me the solution</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>df_SN7577_oops <span class="op">=</span> pd.read_csv(<span class="st">"SN7577.tab"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="bu">print</span>(df_SN7577_oops.shape)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="bu">print</span>(df_SN7577_oops)</span></code></pre>
</div>
<p>If you allow pandas to assume that your columns are separated by
commas (the default) and there aren’t any, then each record will be
treated as a single column. So the shape is given as 1286 rows (correct)
but only one column. When the contents is display the only column name
is the complete first record. Notice the <code>\t</code> used to
represent the tab characters in the output. This is the same format we
used to specify the tab separator when we correctly read in the
file.</p>
</div>
</div>
</div>
</div>
</section><section id="getting-information-about-a-dataframe"><h2 class="section-heading">Getting information about a Dataframe<a class="anchor" aria-label="anchor" href="#getting-information-about-a-dataframe"></a>
</h2>
<hr class="half-width">
<p>You can find out the type of the variable <code>df_SN7577</code> by
using the <code>type</code> function.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(df_SN7577))</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>&lt;class 'pandas.core.frame.DataFrame'&gt;</code></pre>
</div>
<p>You can see the contents by simply entering the variable name. You
can see from the output that it is a tabular format. The column names
have been taken from the first record of the file. On the left hand side
is a column with no name. The entries here have been provided by pandas
and act as an index to reference the individual rows of the
Dataframe.</p>
<p>The <code>read_csv()</code> function has an <code>index_col</code>
parameter which you can use to indicate which of the columns in the file
you wish to use as the index instead. As the SN7577 dataset doesn’t have
a column which would uniquely identify each row we cannot do that.</p>
<p>Another thing to notice about the display is that it is truncated. By
default you will see the first and last 30 rows. For the columns you
will always get the first few columns and typically the last few
depending on display space.</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>df_SN7577</span></code></pre>
</div>
<p>Similar information can be obtained with
<code>df_SN7577.head()</code> But here you are only returned the first 5
rows by default.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>df_SN7577.head()</span></code></pre>
</div>
<div id="exercise-1" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="exercise-1" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#exercise-1"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>As well as the <code>head()</code> method there is a
<code>tail()</code> method. What do you think it does? Try it.</li>
<li>Both methods accept a single numeric parameter. What do you think it
does? Try it.</li>
</ol>
</div>
</div>
</div>
<p>You can obtain other basic information about your Dataframe of data
with:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co"># How many rows?</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(df_SN7577))</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="co"># How many rows and columns - returned as a tuple</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="bu">print</span>(df_SN7577.shape)</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="co">#How many 'cells' in the table</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="bu">print</span>(df_SN7577.size)</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co"># What are the column names</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="bu">print</span>(df_SN7577.columns)</span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a><span class="co"># what are the data types of the columns?</span></span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="bu">print</span>(df_SN7577.dtypes)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>1286
(1286, 202)
259772
Index(['Q1', 'Q2', 'Q3', 'Q4', 'Q5ai', 'Q5aii', 'Q5aiii', 'Q5aiv', 'Q5av',
       'Q5avi',
       ...
       'numhhd', 'numkid', 'numkid2', 'numkid31', 'numkid32', 'numkid33',
       'numkid34', 'numkid35', 'numkid36', 'wts'],
      dtype='object', length=202)
Q1             int64
Q2             int64
Q3             int64
...
Length: 202, dtype: object</code></pre>
</div>
<div id="exercise-2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-2" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#exercise-2"></a>
</h3>
<div class="callout-content">
<p>When we asked for the column names and their data types, the output
was abridged, i.e. we didn’t get the values for all of the columns. Can
you write a small piece of code which will return all of the values</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Show me the solution</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="cf">for</span> name <span class="kw">in</span> df_SN7577.columns:</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>    <span class="bu">print</span>(name)</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>pandas is a Python library containing functions and data structures
to assist in data analysis</li>
<li>pandas data structures are the Series (like a vector) and the
Dataframe (like a table)</li>
<li>the pandas <code>read_csv</code> function allows you to read an
entire <code>csv</code> file into a Dataframe</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-09-extracting-data"><p>Content from <a href="09-extracting-data.html">Extracting row and columns</a></p>
<hr>
<p>Last updated on 2023-05-04 |
        
        <a href="https://github.com/datacarpentry/python-socialsci/edit/main/episodes/09-extracting-data.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 30 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I extract specific rows and columns from a Dataframe?</li>
<li>How can I add or delete columns from a Dataframe?</li>
<li>How can I find and change missing values in a Dataframe?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Define indexing as it relates to data structures</li>
<li>Select specific columns from a data frame</li>
<li>Select specific rows from a data frame based on conditional
expressions</li>
<li>Using indexes to access rows and columns</li>
<li>Copy a data frame</li>
<li>Add columns to a data frame</li>
<li>Analyse datasets having missing/null values</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>We will continue this episode from where we left off in the last
episode. If you have restarted Jupyter or you want to use a new notebook
make sure that you import pandas and have read the SN7577.tab dataset
into a Dataframe.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>df_SN7577 <span class="op">=</span> pd.read_csv(<span class="st">"SN7577.tab"</span>, sep<span class="op">=</span><span class="st">'</span><span class="ch">\t</span><span class="st">'</span>)</span></code></pre>
</div>
<div class="section level3">
<h3 id="selecting-rows-and-columns-from-a-pandas-dataframe">Selecting rows and columns from a pandas Dataframe<a class="anchor" aria-label="anchor" href="#selecting-rows-and-columns-from-a-pandas-dataframe"></a>
</h3>
<p>If we know which columns we want before we read the data from the
file we can tell <code>read_csv()</code> to only import those columns by
specifying columns either by their index number (starting at 0) as a
list to the <code>usecols</code> parameter. Alternatively we can also
provide a list of column names.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>df_SN7577_some_cols <span class="op">=</span> pd.read_csv(<span class="st">"SN7577.tab"</span>, sep<span class="op">=</span><span class="st">'</span><span class="ch">\t</span><span class="st">'</span>, usecols<span class="op">=</span> [<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">173</span>,<span class="dv">174</span>,<span class="dv">175</span>])</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="bu">print</span>(df_SN7577_some_cols.shape)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="bu">print</span>(df_SN7577_some_cols.columns)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>df_SN7577_some_cols <span class="op">=</span> pd.read_csv(<span class="st">"SN7577.tab"</span>, sep<span class="op">=</span><span class="st">'</span><span class="ch">\t</span><span class="st">'</span>, usecols<span class="op">=</span> [<span class="st">'Q1'</span>, <span class="st">'Q2'</span>, <span class="st">'Q3'</span>, <span class="st">'sex'</span>, <span class="st">'age'</span>, <span class="st">'agegroups'</span>])</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="bu">print</span>(df_SN7577_some_cols.columns)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>(1286, 6)
Index(['Q1', 'Q2', 'Q3', 'sex', 'age', 'agegroups'], dtype='object')
Index(['Q1', 'Q2', 'Q3', 'sex', 'age', 'agegroups'], dtype='object')</code></pre>
</div>
<p>Let us assume for now that we read in the complete file which is now
in the Dataframe <code>df_SN7577</code>, how can we now refer to
specific columns?</p>
<p>There are two ways of doing this using the column names (or
labels):</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># Both of these statements are the same</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="bu">print</span>(df_SN7577[<span class="st">'Q1'</span>])</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="co"># and</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="bu">print</span>(df_SN7577.Q1)</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>0        1
1        3
2       10
3        9
...</code></pre>
</div>
<p>If we are interested in more than one column, the 2nd method above
cannot be used. However in the first, although we used a string with the
value of <code>'Q1'</code> we could also have provided a list of
strings. Remember that lists are enclosed in <code>[]</code>.</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="bu">print</span>(df_SN7577[[<span class="st">'Q1'</span>, <span class="st">'Q2'</span>, <span class="st">'Q3'</span>]])</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>Q1  Q2  Q3</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="dv">0</span>      <span class="dv">1</span>  <span class="op">-</span><span class="dv">1</span>   <span class="dv">1</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="dv">1</span>      <span class="dv">3</span>  <span class="op">-</span><span class="dv">1</span>   <span class="dv">1</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="dv">2</span>     <span class="dv">10</span>   <span class="dv">3</span>   <span class="dv">2</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="dv">3</span>      <span class="dv">9</span>  <span class="op">-</span><span class="dv">1</span>  <span class="dv">10</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a>...</span></code></pre>
</div>
<div id="exercise" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#exercise"></a>
</h3>
<div class="callout-content">
<p>What happens if you:</p>
<ol style="list-style-type: decimal">
<li>List the columns you want out of order from the way they appear in
the file?</li>
<li>Put the same column name in twice?</li>
<li>Put in a non-existing column name? (a.k.a Typo)</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Show me the solution</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="bu">print</span>(df_SN7577[[<span class="st">'Q3'</span>, <span class="st">'Q2'</span>]])</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="bu">print</span>(df_SN7577[[<span class="st">'Q3'</span>, <span class="st">'Q2'</span>, <span class="st">'Q3'</span>]])</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="bu">print</span>(df_SN7577[[<span class="st">'Q33'</span>, <span class="st">'Q2'</span>]])</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<section id="filtering-by-rows"><h2 class="section-heading">Filtering by Rows<a class="anchor" aria-label="anchor" href="#filtering-by-rows"></a>
</h2>
<hr class="half-width">
<p>You can filter the Dataframe by rows by specifying a range in the
form of <code>a:b</code>. <code>a</code> is the first row and
<code>b</code> is one beyond the last row required.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># select row with index of 1, 2 and 3 (rows 2, 3 and 4 in the Dataframe)</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>df_SN7577_some_rows <span class="op">=</span> df_SN7577[<span class="dv">1</span>:<span class="dv">4</span>]</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>df_SN7577_some_rows</span></code></pre>
</div>
<div id="exercise-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-1" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#exercise-1"></a>
</h3>
<div class="callout-content">
<p>What happens if we ask for a single row instead of a range?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Show me the solution</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>df_SN7577[<span class="dv">1</span>]</span></code></pre>
</div>
<p>You get an error if you only specify <code>1</code>. You need to use
<code>:1</code> or <code>0:1</code> to get the first row returned. The
<code>:</code> is always required. You can use <code>:</code> by itself
to return all of the rows.</p>
</div>
</div>
</div>
</div>
</section><section id="using-criteria-to-filter-rows"><h2 class="section-heading">Using criteria to filter rows<a class="anchor" aria-label="anchor" href="#using-criteria-to-filter-rows"></a>
</h2>
<hr class="half-width">
<p>It is more likely that you will want to select rows from the
Dataframe based on some criteria, such as “all rows where the value for
Q2 is -1”.</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>df_SN7577_some_rows <span class="op">=</span> df_SN7577[(df_SN7577.Q2 <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>)]</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>df_SN7577_some_rows</span></code></pre>
</div>
<p>The criteria can be more complex and isn’t limited to a single
column’s values:</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>df_SN7577_some_rows <span class="op">=</span> df_SN7577[ (df_SN7577.Q2 <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>) <span class="op">&amp;</span> (df_SN7577.numage <span class="op">&gt;</span> <span class="dv">60</span>)]</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>df_SN7577_some_rows</span></code></pre>
</div>
<p>We can combine the row selection with column selection:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>df_SN7577_some_rows <span class="op">=</span> df_SN7577[ (df_SN7577.Q2 <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>) <span class="op">&amp;</span> (df_SN7577.numage <span class="op">&gt;</span> <span class="dv">60</span>)][[<span class="st">'Q1'</span>, <span class="st">'Q2'</span>,<span class="st">'numage'</span>]]</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>df_SN7577_some_rows</span></code></pre>
</div>
<p>Selecting rows on the row index is of limited use unless you need to
select a contiguous range of rows.</p>
<p>There is however another way of selecting rows using the row
index:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>df_SN7577_some_rows <span class="op">=</span> df_SN7577.iloc[<span class="dv">1</span>:<span class="dv">4</span>]</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>df_SN7577_some_rows</span></code></pre>
</div>
<p>Using the <code>iloc</code> method gives the same results as our
previous example.</p>
<p>However, now we can specify a single value and more importantly we
can use the <code>range()</code> function to indicate the records that
we want. This can be useful for making pseudo-random selections of rows
from across the Dataframe.</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="co"># Select the first row from the Dataframe</span></span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>df_SN7577_some_rows <span class="op">=</span> df_SN7577.iloc[<span class="dv">0</span>]</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>df_SN7577_some_rows</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a><span class="co"># select every 100th record from the Dataframe.</span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>df_SN7577_some_rows <span class="op">=</span> df_SN7577.iloc[<span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(df_SN7577), <span class="dv">100</span>)]</span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>df_SN7577_some_rows</span></code></pre>
</div>
<p>You can also specify column ranges using the <code>iloc</code> method
again using the column index numbers:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="co"># columns 0,1,2 and 3</span></span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>df_SN7577_some_rows <span class="op">=</span> df_SN7577.iloc[<span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(df_SN7577), <span class="dv">100</span>),<span class="dv">0</span>:<span class="dv">4</span>]</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>df_SN7577_some_rows</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a><span class="co"># columns 0,1,2,78 and 95</span></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>df_SN7577_some_rows <span class="op">=</span> df_SN7577.iloc[<span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(df_SN7577), <span class="dv">100</span>),[<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">78</span>,<span class="dv">95</span>]]</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>df_SN7577_some_rows</span></code></pre>
</div>
<p>There is also a <code>loc</code> method which allows you to use the
column names.</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="co"># columns 0,1,2,78 and 95 using the column names and changing 'iloc' to 'loc'</span></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>df_SN7577_some_rows <span class="op">=</span> df_SN7577.loc[<span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(df_SN7577), <span class="dv">100</span>),[<span class="st">'Q1'</span>, <span class="st">'Q2'</span>, <span class="st">'Q3'</span>, <span class="st">'Q18bii'</span>, <span class="st">'access6'</span> ]]</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>df_SN7577_some_rows</span></code></pre>
</div>
</section><section id="sampling"><h2 class="section-heading">Sampling<a class="anchor" aria-label="anchor" href="#sampling"></a>
</h2>
<hr class="half-width">
<p>Pandas does have a <code>sample</code> method which allows you to
extract a sample of the records from the Dataframe.</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>df_SN7577.sample(<span class="dv">10</span>, replace<span class="op">=</span><span class="va">False</span>)             <span class="co"># ten records, do not select same record twice (this is the default)</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>df_SN7577.sample(frac<span class="op">=</span><span class="fl">0.05</span>, random_state<span class="op">=</span><span class="dv">1</span>)     <span class="co"># 5% of records , same records if run again</span></span></code></pre>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Import specific columns when reading in a .csv with the
<code>usecols</code> parameter</li>
<li>We easily can chain boolean conditions when filtering rows of a
pandas dataframe</li>
<li>The <code>loc</code> and <code>iloc</code> methods allow us to get
rows with particular labels and at particular integer locations
respectively</li>
<li>pandas has a handy <code>sample</code> method which allows us to
extract a sample of rows from a dataframe</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-10-aggregations"><p>Content from <a href="10-aggregations.html">Data Aggregation using Pandas</a></p>
<hr>
<p>Last updated on 2023-05-04 |
        
        <a href="https://github.com/datacarpentry/python-socialsci/edit/main/episodes/10-aggregations.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 30 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I summarise the data in a data frame?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Access and summarize data stored in a Data Frame</li>
<li>Perform basic mathematical operations and summary statistics on data
in a Pandas Data Frame</li>
<li>Understand missing data</li>
<li>Changing to and from ‘NaN’ values</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="using-pandas-functions-to-summarise-data-in-a-data-frame"><h2 class="section-heading">Using Pandas functions to summarise data in a Data Frame<a class="anchor" aria-label="anchor" href="#using-pandas-functions-to-summarise-data-in-a-data-frame"></a>
</h2>
<hr class="half-width">
<p>For variables which contain numerical values we are often interested
in various statistical measures relating to those values. For
categorical variable we are often interested in the how many of each
unique values are present in the dataset.</p>
<p>We shall use the SAFI_results.csv dataset to demonstrate how we can
obtain these pieces of information</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>df_SAFI <span class="op">=</span> pd.read_csv(<span class="st">"SAFI_results.csv"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>df_SAFI</span></code></pre>
</div>
<p>For numeric variables we can obtain a variety of basic statistical
information by using the <code>describe()</code> method.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>df_SAFI.describe()</span></code></pre>
</div>
<p>This can be done for the Dataframe as a whole, in which case some of
the results might have no sensible meaning. If there are any missing
values, represented in the display as <code>NaN</code> you will get a
warning message.</p>
<p>You can also <code>.describe()</code> on a single variable basis.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>df_SAFI[<span class="st">'B_no_membrs'</span>].describe()</span></code></pre>
</div>
<p>There are also a set of methods which allow us to obtain individual
values.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="bu">print</span>(df_SAFI[<span class="st">'B_no_membrs'</span>].<span class="bu">min</span>())</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="bu">print</span>(df_SAFI[<span class="st">'B_no_membrs'</span>].<span class="bu">max</span>())</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="bu">print</span>(df_SAFI[<span class="st">'B_no_membrs'</span>].mean())</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="bu">print</span>(df_SAFI[<span class="st">'B_no_membrs'</span>].std())</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="bu">print</span>(df_SAFI[<span class="st">'B_no_membrs'</span>].count())</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="bu">print</span>(df_SAFI[<span class="st">'B_no_membrs'</span>].<span class="bu">sum</span>())</span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="fl">2</span></span>
<span><span class="fl">19</span></span>
<span><span class="fl">7.190839694656488</span></span>
<span><span class="fl">3.1722704895263734</span></span>
<span><span class="fl">131</span></span>
<span><span class="fl">942</span></span></code></pre>
</div>
<p>Unlike the <code>describe()</code> method which converts the variable
to a float (when it was originally an integer), the individual summary
methods only does so for the returned result if needed.</p>
<p>We can do the same thing for the <code>E19_period_use</code>
variable</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="bu">print</span>(df_SAFI[<span class="st">'E19_period_use'</span>].<span class="bu">min</span>())</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="bu">print</span>(df_SAFI[<span class="st">'E19_period_use'</span>].<span class="bu">max</span>())</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="bu">print</span>(df_SAFI[<span class="st">'E19_period_use'</span>].mean())</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="bu">print</span>(df_SAFI[<span class="st">'E19_period_use'</span>].std())</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="bu">print</span>(df_SAFI[<span class="st">'E19_period_use'</span>].count())</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="bu">print</span>(df_SAFI[<span class="st">'E19_period_use'</span>].<span class="bu">sum</span>())</span></code></pre>
</div>
<pre><code><span><span class="fl">1.0</span></span>
<span><span class="fl">45.0</span></span>
<span><span class="fl">12.043478260869565</span></span>
<span><span class="fl">8.583030848015385</span></span>
<span><span class="fl">92</span></span>
<span><span class="fl">1108.0</span></span></code></pre>
<p>{: output}</p>
<div id="exercise" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#exercise"></a>
</h3>
<div class="callout-content">
<p>Compare the count values returned for the <code>B_no_membrs</code>
and the <code>E19_period_use</code> variables.</p>
<ol style="list-style-type: decimal">
<li>Why do you think they are different?</li>
<li>How does this affect the calculation of the mean values?</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Show me the solution</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li>We know from when we originally displayed the contents of the
<code>df_SAFI</code> Dataframe that there are 131 rows in it. This
matches the value for the <code>B_no_membrs</code> count. The count for
<code>E19_period_use</code> however is only 92. If you look at the
values in the <code>E19_period_use</code> column using</li>
</ol>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>df_SAFI[<span class="st">'E19_period_use'</span>]</span></code></pre>
</div>
<p>you will see that there are several <code>NaN</code> values. They
also occurred when we used <code>describe()</code> on the full
Dataframe. <code>NaN</code> stands for Not a Number, ie. the value is
missing. There are only 92 non-missing values and this is what is
reported by the <code>count()</code> method. This value is also used in
the calculation of the mean and std values.</p>
</div>
</div>
</div>
</div>
</section><section id="dealing-with-missing-values"><h2 class="section-heading">Dealing with missing values<a class="anchor" aria-label="anchor" href="#dealing-with-missing-values"></a>
</h2>
<hr class="half-width">
<p>We can find out how many variables in our Dataframe contains any
<code>NaN</code> values with the code</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>df_SAFI.isnull().<span class="bu">sum</span>()</span></code></pre>
</div>
<pre><code>Column1                             0
A01_interview_date                  0
A03_quest_no                        0
A04_start                           0
...</code></pre>
<p>{: output}</p>
<p>or for a specific variable</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>df_SAFI[<span class="st">'E19_period_use'</span>].isnull().<span class="bu">sum</span>()</span></code></pre>
</div>
<pre><code><span><span class="fl">39</span></span></code></pre>
<p>{: output}</p>
<p>Data from most sources has the potential to include missing data.
Whether or not this presents a problem at all depends on what you are
planning to do.</p>
<p>We have been using data from two very different sources.</p>
<p>The SN7577 dataset is provided by the <a href="https://www.ukdataservice.ac.uk" class="external-link">UK Data Service</a>. Datasets
from the UK data Service, have already been ‘cleaned’ and it is unlikely
that there will be any genuinely missing data. However you may find that
data which was missing has been replaced with a value such as ‘-1’ or
‘Not Specified’. In cases like these it may be appropriate to replace
these values with ‘NaN’ before you try to process the data further.</p>
<p>The SAFI dataset we have been using comes from a project called
‘Studying African Farmer-led Irrigation’. The data for this project is
questionnaire based, but rather than using a paper-based questionnaire,
it has been created and is completed electronically via an app on a
smartphone. This provides flexibility in the design and presentation of
the questionnaire; a section of the questionnaire may only be presented
depending on the answer given to some preceding question. This means
that there can quite legitimately be a set of ‘NaN’ values in a record
(one complete questionnaire) where you would still consider the record
to be complete.</p>
<p>We have already seen how we can check for missing values. There are
three other actions we need to be able to do:</p>
<ol style="list-style-type: decimal">
<li>Remove complete rows which contain <code>NaN</code>
</li>
<li>Replace <code>NaN</code> with a value of our choice</li>
<li>Replace specific values with <code>NaN</code>
</li>
</ol>
<p>With these options we can ensure that the data is suitable for the
further processing we have planned.</p>
<div class="section level3">
<h3 id="completely-remove-rows-with-nans">Completely remove rows with NaNs<a class="anchor" aria-label="anchor" href="#completely-remove-rows-with-nans"></a>
</h3>
<p>The <code>dropna()</code> method will delete all rows if <em>any</em>
of the variables contain an <code>NaN</code>. For some datasets this may
be acceptable. You will need to take care that you have enough rows left
for your analysis to have meaning.</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>df_SAFI <span class="op">=</span> pd.read_csv(<span class="st">"SAFI_results.csv"</span>)</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="bu">print</span>(df_SAFI.shape)</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>df_SAFI.dropna(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="bu">print</span>(df_SAFI.shape)</span></code></pre>
</div>
<pre><code>(131, 55)
(0, 55)</code></pre>
<p>{: output}</p>
<p>Because there are variables in the SAFI dataset which are all
<code>NaN</code> using the <code>dropna()</code> method effectively
deletes all of the rows from the Dataframe, probably not what you
wanted. Instead we can use the <code>notnull()</code> method as a row
selection criteria and delete the rows where a specific variable has
<code>NaN</code> values.</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>df_SAFI <span class="op">=</span> pd.read_csv(<span class="st">"SAFI_results.csv"</span>)</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="bu">print</span>(df_SAFI.shape)</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>df_SAFI <span class="op">=</span> df_SAFI[(df_SAFI[<span class="st">'E_no_group_count'</span>].notnull())]</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a><span class="bu">print</span>(df_SAFI.shape)</span></code></pre>
</div>
<pre><code>(131, 55)
(39, 55)</code></pre>
<p>{: output}</p>
</div>
<div class="section level3">
<h3 id="replace-nan-with-a-value-of-our-choice">Replace NaN with a value of our choice<a class="anchor" aria-label="anchor" href="#replace-nan-with-a-value-of-our-choice"></a>
</h3>
<p>The <code>E19_period_use</code> variable answers the question: “For
how many years have you been irrigating the land?”. In some cases the
land is not irrigated and these are represented by NaN in the dataset.
So when we run</p>
<pre><code>df_SAFI['E19_period_use'].describe()</code></pre>
<p>we get a count value of 92 and all of the other statistics are based
on this count value.</p>
<p>Now supposing that instead of NaN the interviewer entered a value of
0 to indicate the land which is <em>not</em> irrigated has been
irrigated for 0 years, technically correct.</p>
<p>To see what happens we can convert all of the NaN values in the
<code>E19_period_use</code> column to 0 with the following code:</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>df_SAFI[<span class="st">'E19_period_use'</span>].fillna(<span class="dv">0</span>, inplace<span class="op">=</span><span class="va">True</span>)</span></code></pre>
</div>
<p>If we now run the <code>describe()</code> again you can see that all
of the statistic have been changed because the calculations are NOW
based on a count of 131. Probably not what we would have wanted.</p>
<p>Conveniently this allows us to demonstrate our 3rd action.</p>
</div>
<div class="section level3">
<h3 id="replace-specific-values-with-nan">Replace specific values with NaN<a class="anchor" aria-label="anchor" href="#replace-specific-values-with-nan"></a>
</h3>
<p>Although we can recognise <code>NaN</code> with methods like
<code>isnull()</code> or <code>dropna()</code> actually creating a
<code>NaN</code> value and putting it into a Dataframe, requires the
<code>numpy</code> module. The following code will replace our 0 values
with <code>NaN</code>. We can demonstrate that this has occurred by
running the <code>describe()</code> again and see that we now have our
original values back.</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>df_SAFI[<span class="st">'E19_period_use'</span>].replace(<span class="dv">0</span>, np.NaN, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>df_SAFI[<span class="st">'E19_period_use'</span>].describe()</span></code></pre>
</div>
</div>
</section><section id="categorical-variables"><h2 class="section-heading">Categorical variables<a class="anchor" aria-label="anchor" href="#categorical-variables"></a>
</h2>
<hr class="half-width">
<p>For categorical variables, numerical statistics don’t make any sense.
For a categorical variable we can obtain a list of unique values used by
the variable by using the <code>unique()</code> method.</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>df_SAFI <span class="op">=</span> pd.read_csv(<span class="st">"SAFI_results.csv"</span>)</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>pd.unique(df_SAFI[<span class="st">'C01_respondent_roof_type'</span>])</span></code></pre>
</div>
<pre><code>array(['grass', 'mabatisloping', 'mabatipitched'], dtype=object)</code></pre>
<p>{: output}</p>
<p>Knowing all of the unique values is useful but what is more useful is
knowing how many occurrences of each there are. In order to do this we
can use the <code>groupby</code> method.</p>
<p>Having performed the <code>groupby()</code> we can them
<code>describe()</code> the results. The format is similar to that which
we have seen before except that the ‘grouped by’ variable appears to the
left and there is a set of statistics for each unique value of the
variable.</p>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>grouped_data <span class="op">=</span> df_SAFI.groupby(<span class="st">'C01_respondent_roof_type'</span>)</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a>grouped_data.describe()</span></code></pre>
</div>
<p>You can group by more than one variable at a time by providing them
as a list.</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>grouped_data <span class="op">=</span> df_SAFI.groupby([<span class="st">'C01_respondent_roof_type'</span>, <span class="st">'C02_respondent_wall_type'</span>])</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>grouped_data.describe()</span></code></pre>
</div>
<p>You can also obtain individual statistics if you want.</p>
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>A11_years_farm <span class="op">=</span> df_SAFI.groupby([<span class="st">'C01_respondent_roof_type'</span>, <span class="st">'C02_respondent_wall_type'</span>])[<span class="st">'A11_years_farm'</span>].count()</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a>A11_years_farm</span></code></pre>
</div>
<pre><code>C01_respondent_roof_type  C02_respondent_wall_type
grass                     burntbricks                 22
                          muddaub                     42
                          sunbricks                    9
mabatipitched             burntbricks                  6
                          muddaub                      3
...</code></pre>
<p>{: output}</p>
<div id="exercise-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-1" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#exercise-1"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>Read in the SAFI_results.csv dataset.</li>
<li>Get a list of the different <code>C01_respondent_roof_type</code>
values.</li>
<li>Groupby <code>C01_respondent_roof_type</code> and describe the
results.</li>
<li>Remove rows with NULL values for <code>E_no_group_count</code>.</li>
<li>repeat steps 2 &amp; 3 and compare the results.</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Show me the solution</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="co"># Steps 1 and 2</span></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>df_SAFI <span class="op">=</span> pd.read_csv(<span class="st">"SAFI_results.csv"</span>)</span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a><span class="bu">print</span>(df_SAFI.shape)</span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a><span class="bu">print</span>(pd.unique(df_SAFI[<span class="st">'C01_respondent_roof_type'</span>]))</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="co"># Step 3</span></span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>grouped_data <span class="op">=</span> df_SAFI.groupby(<span class="st">'C01_respondent_roof_type'</span>)</span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a>grouped_data.describe()</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="co"># steps 4 and 5</span></span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>df_SAFI <span class="op">=</span> df_SAFI[(df_SAFI[<span class="st">'E_no_group_count'</span>].notnull())]</span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>grouped_data <span class="op">=</span> df_SAFI.groupby(<span class="st">'C01_respondent_roof_type'</span>)</span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a><span class="bu">print</span>(df_SAFI.shape)</span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a><span class="bu">print</span>(pd.unique(df_SAFI[<span class="st">'C01_respondent_roof_type'</span>]))</span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a>grouped_data.describe()</span></code></pre>
</div>
<p><code>E_no_group_count</code> is related to whether or not farm plots
are irrigated or not. It has no obvious connection to farm buildings. By
restricting the data to non-irrigated plots we have accidentally?
removed one of the roof_types completely.</p>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Summarising numerical and categorical variables is a very common
requirement</li>
<li>Missing data can interfere with how statistical summaries are
calculated</li>
<li>Missing data can be replaced or created depending on
requirement</li>
<li>Summarising or aggregation can be done over single or multiple
variables at the same time</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-11-joins"><p>Content from <a href="11-joins.html">Joining Pandas Dataframes</a></p>
<hr>
<p>Last updated on 2023-05-04 |
        
        <a href="https://github.com/datacarpentry/python-socialsci/edit/main/episodes/11-joins.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 35 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I join two Dataframes with a common key?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Understand why we would want to join Dataframes</li>
<li>Know what is needed for a join to be possible</li>
<li>Understand the different types of joins</li>
<li>Understand what the joined results tell us about our data</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="joining-dataframes"><h2 class="section-heading">Joining Dataframes<a class="anchor" aria-label="anchor" href="#joining-dataframes"></a>
</h2>
<hr class="half-width">
<div class="section level3">
<h3 id="why-do-we-want-to-do-this">Why do we want to do this<a class="anchor" aria-label="anchor" href="#why-do-we-want-to-do-this"></a>
</h3>
<p>There are many occasions when we have related data spread across
multiple files.</p>
<p>The data can be related to each other in different ways. How they are
related and how completely we can join the data from the datasets will
vary.</p>
<p>In this episode we will consider different scenarios and show we
might join the data. We will use csv files and in all cases the first
step will be to read the datasets into a pandas Dataframe from where we
will do the joining. The csv files we are using are cut down versions of
the SN7577 dataset to make the displays more manageable.</p>
<p>First, let’s download the datafiles. They are listed in the <a href="https://datacarpentry.org/python-socialsci/setup.html" class="external-link">setup
page</a> for the lesson. Alternatively, you can download the <a href="https://github.com/datacarpentry/python-socialsci/archive/gh-pages.zip" class="external-link">GitHub
repository for this lesson</a>. The data files are in the <em>data</em>
directory. If you’re using Jupyter, make sure to place these files in
the same directory where your notebook file is.</p>
</div>
<div class="section level3">
<h3 id="scenario-1---two-data-sets-containing-the-same-columns-but-different-rows-of-data">Scenario 1 - Two data sets containing the same columns but different
rows of data<a class="anchor" aria-label="anchor" href="#scenario-1---two-data-sets-containing-the-same-columns-but-different-rows-of-data"></a>
</h3>
<p>Here we want to add the rows from one Dataframe to the rows of the
other Dataframe. In order to do this we can use the
<code>pd.concat()</code> function.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>df_SN7577i_a <span class="op">=</span> pd.read_csv(<span class="st">"SN7577i_a.csv"</span>)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>df_SN7577i_b <span class="op">=</span> pd.read_csv(<span class="st">"SN7577i_b.csv"</span>)</span></code></pre>
</div>
<p>Have a quick look at what these Dataframes look like with</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="bu">print</span>(df_SN7577i_a)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="bu">print</span>(df_SN7577i_b)</span></code></pre>
</div>
<pre><code>  Id  Q1  Q2  Q3  Q4
0   1   1  -1   1   8
1   2   3  -1   1   4
2   3  10   3   2   6
3   4   9  -1  10  10
...

  Id  Q1  Q2  Q3  Q4
0  1277  10  10   4   6
1  1278   2  -1   5   4
2  1279   2  -1   4   5
3  1280   1  -1   2   3
...</code></pre>
<p>{: output}</p>
<p>The <code>concat()</code> function appends the rows from the two
Dataframes to create the df_all_rows Dataframe. When you list this out
you can see that all of the data rows are there, however, there is a
problem with the <code>index</code>.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>df_all_rows <span class="op">=</span> pd.concat([df_SN7577i_a, df_SN7577i_b])</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>df_all_rows</span></code></pre>
</div>
<p>We didn’t explicitly set an index for any of the Dataframes we have
used. For <code>df_SN7577i_a</code> and <code>df_SN7577i_b</code>
default indexes would have been created by pandas. When we concatenated
the Dataframes the indexes were also concatenated resulting in duplicate
entries.</p>
<p>This is really only a problem if you need to access a row by its
index. We can fix the problem with the following code.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>df_all_rows<span class="op">=</span>df_all_rows.reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co"># or, alternatively, there's the `ignore_index` option in the `pd.concat()` function:</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>df_all_rows <span class="op">=</span> pd.concat([df_SN7577i_a, df_SN7577i_b], ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>df_all_rows</span></code></pre>
</div>
<p>What if the columns in the Dataframes are not the same?</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>df_SN7577i_aa <span class="op">=</span> pd.read_csv(<span class="st">"SN7577i_aa.csv"</span>)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>df_SN7577i_bb <span class="op">=</span> pd.read_csv(<span class="st">"SN7577i_bb.csv"</span>)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>df_all_rows <span class="op">=</span> pd.concat([df_SN7577i_aa, df_SN7577i_bb])</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>df_all_rows</span></code></pre>
</div>
<p>In this case <code>df_SN7577i_aa</code> has no Q4 column and
<code>df_SN7577i_bb</code> has no <code>Q3</code> column. When they are
concatenated, the resulting Dataframe has a column for <code>Q3</code>
and <code>Q4</code>. For the rows corresponding to
<code>df_SN7577i_aa</code> the values in the <code>Q4</code> column are
missing and denoted by <code>NaN</code>. The same applies to
<code>Q3</code> for the <code>df_SN7577i_bb</code> rows.</p>
</div>
<div class="section level3">
<h3 id="scenario-2---adding-the-columns-from-one-dataframe-to-those-of-another-dataframe">Scenario 2 - Adding the columns from one Dataframe to those of
another Dataframe<a class="anchor" aria-label="anchor" href="#scenario-2---adding-the-columns-from-one-dataframe-to-those-of-another-dataframe"></a>
</h3>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>df_SN7577i_c <span class="op">=</span> pd.read_csv(<span class="st">"SN7577i_c.csv"</span>)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>df_SN7577i_d <span class="op">=</span> pd.read_csv(<span class="st">"SN7577i_d.csv"</span>)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>df_all_cols <span class="op">=</span> pd.concat([df_SN7577i_c, df_SN7577i_d], axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>df_all_cols</span></code></pre>
</div>
<p>We use the <code>axis=1</code> parameter to indicate that it is the
columns that need to be joined together. Notice that the <code>Id</code>
column appears twice, because it was a column in each dataset. This is
not particularly desirable, but also not necessarily a problem. However,
there are better ways of combining columns from two Dataframes which
avoid this problem.</p>
</div>
<div class="section level3">
<h3 id="scenario-3---using-merge-to-join-columns">Scenario 3 - Using merge to join columns<a class="anchor" aria-label="anchor" href="#scenario-3---using-merge-to-join-columns"></a>
</h3>
<p>We can join columns from two Dataframes using the
<code>merge()</code> function. This is similar to the SQL ‘join’
functionality.</p>
<p>A detailed discussion of different join types is given in the <a href=".././episodes/sql...">SQL lesson</a>.</p>
<p>You specify the type of join you want using the <code>how</code>
parameter. The default is the <code>inner</code> join which returns the
columns from both tables where the <code>key</code> or common column
values match in both Dataframes.</p>
<p>The possible values of the <code>how</code> parameter are shown in
the picture below (taken from the Pandas documentation)</p>
<figure><img src="../fig/pandas_join_types.png" alt="pandas_join_types" class="figure mx-auto d-block"></figure><p>The different join types behave in the same way as they do in SQL. In
Python/pandas, any missing values are shown as <code>NaN</code></p>
<p>In order to <code>merge</code> the Dataframes we need to identify a
column common to both of them.</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>df_cd <span class="op">=</span> pd.merge(df_SN7577i_c, df_SN7577i_d, how<span class="op">=</span><span class="st">'inner'</span>)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>df_cd</span></code></pre>
</div>
<p>In fact, if there is only one column with the same name in each
Dataframe, it will be assumed to be the one you want to join on. In this
example the <code>Id</code> column</p>
<p>Leaving the join column to default in this way is not best practice.
It is better to explicitly name the column using the <code>on</code>
parameter.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>df_cd <span class="op">=</span> pd.merge(df_SN7577i_c, df_SN7577i_d, how<span class="op">=</span><span class="st">'inner'</span>, on <span class="op">=</span> <span class="st">'Id'</span>)</span></code></pre>
</div>
<p>In many circumstances, the column names that you wish to join on are
not the same in both Dataframes, in which case you can use the
<code>left_on</code> and <code>right_on</code> parameters to specify
them separately.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>df_cd <span class="op">=</span> pd.merge(df_SN7577i_c, df_SN7577i_d, how<span class="op">=</span><span class="st">'inner'</span>, left_on <span class="op">=</span> <span class="st">'Id'</span>, right_on <span class="op">=</span> <span class="st">'Id'</span>)</span></code></pre>
</div>
<div id="practice-with-data" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="practice-with-data" class="callout-inner">
<h3 class="callout-title">Practice with data<a class="anchor" aria-label="anchor" href="#practice-with-data"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>Examine the contents of the <code>SN7577i_aa</code> and
<code>SN7577i_bb</code> csv files using Excel or equivalent.</li>
<li>Using the <code>SN7577i_aa</code> and <code>SN7577i_bb</code> csv
files, create a Dataframe which is the result of an outer join using the
<code>Id</code> column to join on.</li>
<li>What do you notice about the column names in the new Dataframe?</li>
<li>Using <code>shift</code>+<code>tab</code> in Jupyter examine the
possible parameters for the <code>merge()</code> function.</li>
<li>re-write the code so that the columns names which are common to both
files have suffixes indicating the filename from which they come</li>
<li>If you add the parameter <code>indicator=True</code>, what
additional information is provided in the resulting Dataframe?</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Show me the solution</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>df_SN7577i_aa <span class="op">=</span> pd.read_csv(<span class="st">"SN7577i_aa.csv"</span>)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>df_SN7577i_bb <span class="op">=</span> pd.read_csv(<span class="st">"SN7577i_bb.csv"</span>)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>df_aabb <span class="op">=</span> pd.merge(df_SN7577i_aa, df_SN7577i_bb, how<span class="op">=</span><span class="st">'outer'</span>, on <span class="op">=</span> <span class="st">'Id'</span>)</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>df_aabb</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>df_SN7577i_aa <span class="op">=</span> pd.read_csv(<span class="st">"SN7577i_aa.csv"</span>)</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>df_SN7577i_bb <span class="op">=</span> pd.read_csv(<span class="st">"SN7577i_bb.csv"</span>)</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>df_aabb <span class="op">=</span> pd.merge(df_SN7577i_aa, df_SN7577i_bb, how<span class="op">=</span><span class="st">'outer'</span>, on <span class="op">=</span> <span class="st">'Id'</span>,suffixes<span class="op">=</span>(<span class="st">'_aa'</span>, <span class="st">'_bb'</span>), indicator <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>df_aabb</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>You can join pandas Dataframes in much the same way as you join
tables in SQL</li>
<li>The <code>concat()</code> function can be used to concatenate two
Dataframes by adding the rows of one to the other.</li>
<li>
<code>concat()</code> can also combine Dataframes by columns but the
<code>merge()</code> function is the preferred way</li>
<li>The <code>merge()</code> function is equivalent to the SQL JOIN
clause. ‘left’, ‘right’ and ‘inner’ joins are all possible.</li>
</ul>
</div>
</div>
</div>
</div>
</section></section><section id="aio-12-long-and-wide"><p>Content from <a href="12-long-and-wide.html">Wide and long data formats</a></p>
<hr>
<p>Last updated on 2023-05-04 |
        
        <a href="https://github.com/datacarpentry/python-socialsci/edit/main/episodes/12-long-and-wide.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 35 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>What are long and Wide formats?</li>
<li>Why would I want to change between them?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Explain difference between long and wide formats and why each might
be used</li>
<li>Illustrate how to change between formats using the
<code>melt()</code> and <code>pivot()</code> methods</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="wide-and-long-data-formats"><h2 class="section-heading">Wide and long data formats<a class="anchor" aria-label="anchor" href="#wide-and-long-data-formats"></a>
</h2>
<hr class="half-width">
<p>In the SN7577 dataset that we have been using there is a group of
columns which record which daily newspapers each respondent reads.
Despite the un-informative names like ‘daily1’ each column refers to a
current UK daily national or local newspaper.</p>
<p>Whether the paper is read or not is recorded using the values of 0 or
1 as a boolean indicator. The advantage of using a column for each paper
means that should a respondent read multiple newspapers, all of the
required information can still be recorded in a single record.</p>
<p>Recording information in this <em>wide</em> format is not always
beneficial when trying to analyse the data.</p>
<p>Pandas provides methods for converting data from <em>wide</em> to
<em>long</em> format and from <em>long</em> to <em>wide</em> format</p>
<p>The SN7577 dataset does not contain a variable that can be used to
uniquely identify a row. This is often referred to as a ‘primary key’
field (or column).</p>
<p>A dataset doesn’t need to have such a key. None of the work we have
done so far has required it.</p>
<p>When we create a pandas Dataframe by importing a csv file, we have
seen that pandas will create an index for the rows. This index can be
used a bit like a key field, but as we have seen there can be problems
with the index when we concatenate two Dataframes together.</p>
<p>In the version of SN7577 that we are going to use to demonstrate long
and wide formats we will add a new variable with the name of ‘Id’ and we
will restrict the other columns to those starting with the word
‘daily’.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>df_SN7577 <span class="op">=</span> pd.read_csv(<span class="st">"SN7577.tab"</span>, sep<span class="op">=</span><span class="st">'</span><span class="ch">\t</span><span class="st">'</span>)</span></code></pre>
</div>
<p>We will create a new Dataframe with a single column of ‘Id’.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># create an 'Id' column</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>df_papers1 <span class="op">=</span> pd.DataFrame(pd.Series(<span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">1287</span>)), index<span class="op">=</span><span class="va">None</span>, columns<span class="op">=</span>[<span class="st">'Id'</span>])</span></code></pre>
</div>
<p>Using the range function, we can create values of <code>Id</code>
starting with 1 and going up to 1286 (remember the second parameter to
range is one past the last value used.) We have explicitly coded this
value because we knew how many rows were in the dataset. If we didn’t,
we could have used</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="bu">len</span>(df_SN7577.index) <span class="op">+</span><span class="dv">1</span></span></code></pre>
</div>
<pre><code><span><span class="fl">1287</span></span></code></pre>
<p>{: output}</p>
<p>We will create a 2nd Dataframe, based on SN7577 but containing only
the columns starting with the word ‘daily’.</p>
<p>There are several ways of doing this, we’ll cover the way that we
have covered all of the prerequisites for. We will use the
<code>filter</code> method of <code>pandas</code> with its
<code>like</code> parameter.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>df_papers2 <span class="op">=</span> df_SN7577.<span class="bu">filter</span>(like<span class="op">=</span> <span class="st">'daily'</span>)</span></code></pre>
</div>
<p>The value supplied to <code>like</code> can occur anywhere in the
column name to be matched (and therefore selected).</p>
<div id="callout1" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div class="section level3 callout-title callout-inner">
<h3 class="callout-title" id="another-way">Another way<a class="anchor" aria-label="anchor" href="#another-way"></a>
</h3>
<div class="callout-content">
<p>If we knew the column numbers and they were all continuous we could
use the <code>iloc</code> method and provide the index values of the
range of columns we want.</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>df_papers2 <span class="op">=</span> df_SN7577.iloc[:,<span class="dv">118</span>:<span class="dv">143</span>]</span></code></pre>
</div>
</div>
</div>
</div>
<p>To create the Dataframe that we will use, we will concatenate the two
Dataframes we have created.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>df_papers <span class="op">=</span> pd.concat([df_papers1, df_papers2], axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="bu">print</span>(df_papers.index)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="bu">print</span>(df_papers.columns)</span></code></pre>
</div>
<pre><code>RangeIndex(start=0, stop=1286, step=1)
Index(['Id', 'daily1', 'daily2', 'daily3', 'daily4', 'daily5', 'daily6',
       'daily7', 'daily8', 'daily9', 'daily10', 'daily11', 'daily12',
       'daily13', 'daily14', 'daily15', 'daily16', 'daily17', 'daily18',
       'daily19', 'daily20', 'daily21', 'daily22', 'daily23', 'daily24',
       'daily25'],
      dtype='object')</code></pre>
<p>{: output}</p>
<p>We use <code>axis = 1</code> because we are joining by columns, the
default is joining by rows (<code>axis=0</code>).</p>
</section><section id="from-wide-to-long"><h2 class="section-heading">From ‘wide’ to ‘long’<a class="anchor" aria-label="anchor" href="#from-wide-to-long"></a>
</h2>
<hr class="half-width">
<p>To make the displays more manageable we will use only the first eight
‘daily’ columns</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co">## using df_papers</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>daily_list <span class="op">=</span> df_papers.columns[<span class="dv">1</span>:<span class="dv">8</span>]</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>df_daily_papers_long <span class="op">=</span> pd.melt(df_papers, id_vars <span class="op">=</span> [<span class="st">'Id'</span>], value_vars <span class="op">=</span> daily_list)</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="co"># by default, the new columns created will be called 'variable' which is the name of the 'daily'</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="co"># and 'value' which is the value of that 'daily' for that 'Id'. So, we will rename the columns</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>df_daily_papers_long.columns <span class="op">=</span> [<span class="st">'Id'</span>,<span class="st">'Daily_paper'</span>,<span class="st">'Value'</span>]</span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>df_daily_papers_long</span></code></pre>
</div>
<p>We now have a Dataframe that we can <code>groupby</code>.</p>
<p>We want to <code>groupby</code> the <code>Daily_paper</code> and then
sum the <code>Value</code>.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>a <span class="op">=</span> df_daily_papers_long.groupby(<span class="st">'Daily_paper'</span>)[<span class="st">'Value'</span>].<span class="bu">sum</span>()</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>a</span></code></pre>
</div>
<pre><code>Daily_paper
daily1     0
daily2    26
daily3    52</code></pre>
<p>{: output}</p>
</section><section id="from-long-to-wide"><h2 class="section-heading">From Long to Wide<a class="anchor" aria-label="anchor" href="#from-long-to-wide"></a>
</h2>
<hr class="half-width">
<p>The process can be reversed by using the <code>pivot()</code> method.
Here we need to indicate which column (or columns) remain fixed (this
will become an index in the new Dataframe), which column contains the
values which are to become column names and which column contains the
values for the columns.</p>
<p>In our case we want to use the <code>Id</code> column as the fixed
column, the <code>Daily_paper</code> column contains the column names
and the <code>Value</code> column contains the values.</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>df_daily_papers_wide <span class="op">=</span> df_daily_papers_long.pivot(index <span class="op">=</span> <span class="st">'Id'</span>, columns <span class="op">=</span> <span class="st">'Daily_paper'</span>, values <span class="op">=</span> <span class="st">'Value'</span>)</span></code></pre>
</div>
<p>We can change our <code>Id</code> index back to an ordinary column
with</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>df_daily_papers_wide.reset_index(level<span class="op">=</span><span class="dv">0</span>, inplace<span class="op">=</span><span class="va">True</span>)</span></code></pre>
</div>
<div id="exercise" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#exercise"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>Find out how many people take each of the daily newspapers by
Title.</li>
<li>Which titles don’t appear to be read by anyone?</li>
</ol>
<p>There is a file called Newspapers.csv which lists all of the
newspapers Titles along with the corresponding ‘daily’ value</p>
<p>Hint: Newspapers.csv contains both daily and Sunday newspapers you
can filter out the Sunday papers with the following code:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>df_newspapers <span class="op">=</span> df_newspapers[(df_newspapers.Column_name.<span class="bu">str</span>.startswith(<span class="st">'daily'</span>))]</span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Show me the solution</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li>Read in Newspapers.csv file and keep only the dailies.</li>
</ol>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>df_newspapers <span class="op">=</span> pd.read_csv(<span class="st">"Newspapers.csv"</span>)</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>df_newspapers <span class="op">=</span> df_newspapers[(df_newspapers.Column_name.<span class="bu">str</span>.startswith(<span class="st">'daily'</span>))]</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>df_newspapers</span></code></pre>
</div>
<ol start="2" style="list-style-type: decimal">
<li>Create the df_papers Dataframe as we did before.</li>
</ol>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>df_SN7577 <span class="op">=</span> pd.read_csv(<span class="st">"SN7577.tab"</span>, sep<span class="op">=</span><span class="st">'</span><span class="ch">\t</span><span class="st">'</span>)</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="co">#create an 'Id' column</span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>df_papers1 <span class="op">=</span> pd.DataFrame(pd.Series(<span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">1287</span>)),index<span class="op">=</span><span class="va">None</span>,columns<span class="op">=</span>[<span class="st">'Id'</span>])</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>df_papers2 <span class="op">=</span> df_SN7577.<span class="bu">filter</span>(like<span class="op">=</span> <span class="st">'daily'</span>)</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>df_papers <span class="op">=</span> pd.concat([df_papers1, df_papers2], axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>df_papers</span></code></pre>
</div>
<ol start="3" style="list-style-type: decimal">
<li>Create a list of all of the dailies, one way would be</li>
</ol>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>daily_list <span class="op">=</span> []</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">26</span>):</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>    daily_list.append(<span class="st">'daily'</span><span class="op">+</span><span class="bu">str</span>(i))  </span></code></pre>
</div>
<ol start="4" style="list-style-type: decimal">
<li>Pass the list as the <code>value_vars</code> parameter to the
<code>melt()</code> method</li>
</ol>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="co">#use melt to create df_daily_papers_long  </span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>df_daily_papers_long <span class="op">=</span> pd.melt(df_papers, id_vars <span class="op">=</span> [<span class="st">'Id'</span>], value_vars <span class="op">=</span> daily_list )</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="co">#Change the column names</span></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>df_daily_papers_long.columns <span class="op">=</span> [<span class="st">'Id'</span>, <span class="st">'Daily_paper'</span>, <span class="st">'Value'</span>]</span></code></pre>
</div>
<ol start="5" style="list-style-type: decimal">
<li>
<code>merge</code> the two Dataframes with a left join, because we
want all of the Newspaper Titles to be included.</li>
</ol>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>df_papers_taken <span class="op">=</span> pd.merge(df_newspapers, df_daily_papers_long, how<span class="op">=</span><span class="st">'left'</span>, left_on <span class="op">=</span> <span class="st">'Column_name'</span>,right_on <span class="op">=</span> <span class="st">'Daily_paper'</span>)</span></code></pre>
</div>
<ol start="6" style="list-style-type: decimal">
<li>Then <code>groupby</code> the ‘Title’ and sum the ‘Value’</li>
</ol>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>df_papers_taken.groupby(<span class="st">'Title'</span>)[<span class="st">'Value'</span>].<span class="bu">sum</span>()</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>The <code>melt()</code> method can be used to change from wide to
long format</li>
<li>The <code>pivot()</code> method can be used to change from the long
to wide format</li>
<li>Aggregations are best done from data in the long format.</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-13-matplotlib"><p>Content from <a href="13-matplotlib.html">Data visualisation using Matplotlib</a></p>
<hr>
<p>Last updated on 2023-05-04 |
        
        <a href="https://github.com/datacarpentry/python-socialsci/edit/main/episodes/13-matplotlib.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 50 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I create visualisations of my data?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Create simple plots using pandas</li>
<li>Import pyplot from the matplotlib library</li>
<li>Customise plots using pyplot</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="plotting-in-python"><h2 class="section-heading">Plotting in Python<a class="anchor" aria-label="anchor" href="#plotting-in-python"></a>
</h2>
<hr class="half-width">
<p>There is a wide variety of ways to plot in Python, like many
programming languages. Some do more of the design work for you and
others let you customize the look of the plots and all of the little
details yourself. <a href="https://pandas.pydata.org/" class="external-link">Pandas</a> has
basic plots built into it that reduce the amount of syntax, if your data
is already in a DataFrame. <a href="https://matplotlib.org/" class="external-link">Matplotlib</a>. is a Python graphical
library that can be used to produce a variety of different graph types,
it is fully controllable down to basic elements and includes a module
<code>pylab</code> that is somewhere in between (designed to feel like
MATLAB plotting, if you happen to have done that before).</p>
<p>The Matplotlib library can be imported using any of the import
techniques we have seen. As Pandas is generally imported with
<code>import pandas as pd</code>, you will find that Matplotlib is most
commonly imported with <code>import matplotlib as plt</code> where ‘plt’
is the alias.</p>
<p>In addition to importing the library, in a Jupyter notebook
environment we need to tell Jupyter that when we produce a graph, we
want it to be display the graph in a cell in the notebook just like any
other results. To do this we use the <code>%matplotlib inline</code>
directive.</p>
<p>Although we are using Matplotlib in this episode, Pandas can make use
of several other graphical libraries available from within Python such
as <a href="https://ggplot2.tidyverse.org/" class="external-link">ggplot2</a> and <a href="https://seaborn.pydata.org/" class="external-link">Seaborn</a>. Seaborn has some very
powerful features and advanced plot types. One of its most useful
features is formatting.</p>
</section><section id="plotting-with-pandas"><h2 class="section-heading">Plotting with Pandas<a class="anchor" aria-label="anchor" href="#plotting-with-pandas"></a>
</h2>
<hr class="half-width">
<p>The Pandas library contains very tight integration with Matplotlib.
There are functions in Pandas that automatically call Matplotlib
functions to produce graphs.</p>
<p>To plot with Pandas we have to import it as we have done in past
episodes. To tell Jupyter that when we produce a graph we want it to be
displayed in a cell in the notebook just like any other results, we use
the <code>%matplotlib inline</code> directive. Without that we need to
do a <code>show()</code> command.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span></code></pre>
</div>
<p>We also need data to work with loaded into a DataFrame and it’s
helpful to look at a few rows to remember what’s there.</p>
<p>We are going to use the dataset from the setup page,
<code>SAFI_full_shortname.csv</code>. For the data to load, <strong>make
sure to have that file in the same folder where your Jupyter notebook is
running.</strong> If the file is not in that folder, you are going to
have to type the full path.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">"SAFI_full_shortname.csv"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>df.head()</span></code></pre>
</div>
<p>Next, we can plot the a histogram of a variable.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>df[<span class="st">'years_liv'</span>].hist()</span></code></pre>
</div>
<figure><img src="../fig/histogram1.png" alt="Histogram of years lived spotlighting how to plot a variable with Pandas" class="figure mx-auto d-block"></figure><p>We can change the number of bins to make it look how we would like,
for example</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>df[<span class="st">'years_liv'</span>].hist(bins<span class="op">=</span><span class="dv">20</span>)</span></code></pre>
</div>
<p>We can also specify the column as a parameter and a groupby column
with the <code>by</code> keyword. there are a lot of keywords available
to make it look better, we can see some of the most likely ones (as
decided by Pandas developers) by using <kbd>shift</kbd> + <kbd>tab<kbd>
.</kbd></kbd></p>
<p>Lets try <code>layout</code>, <code>figsize</code>, and
<code>sharex</code>.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>df.hist(column<span class="op">=</span><span class="st">'years_liv'</span>,by<span class="op">=</span><span class="st">'village'</span>,layout<span class="op">=</span>(<span class="dv">1</span>,<span class="dv">3</span>),figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">3</span>),sharex<span class="op">=</span><span class="va">True</span>)</span></code></pre>
</div>
<figure><img src="../fig/histogram3.png" alt="Three separate histograms depicting the number of years lived by village; Chirodzo, God, Ruaca" class="figure mx-auto d-block"></figure></section><section id="scatter-plot"><h2 class="section-heading">Scatter plot<a class="anchor" aria-label="anchor" href="#scatter-plot"></a>
</h2>
<hr class="half-width">
<p>The scatter plot requires the x and y coordinates of each of the
points being plotted. We can add a third dimension as different colors
with the <code>c</code> argument.</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>df.plot.scatter(x<span class="op">=</span><span class="st">'gps_Latitude'</span>, y<span class="op">=</span><span class="st">'gps_Longitude'</span>, c<span class="op">=</span><span class="st">'gps_Altitude'</span>, colormap<span class="op">=</span><span class="st">"viridis"</span>, figsize<span class="op">=</span>[<span class="dv">4</span>,<span class="dv">4</span>])</span></code></pre>
</div>
<figure><img src="../fig/scatter1.png" alt="png" class="figure mx-auto d-block"></figure><div id="exercise" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#exercise"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>Make a scatter plot of <code>years_farm</code> vs
<code>years_liv</code> and color the points by
<code>buildings_in_compound</code>
</li>
<li>Make a bar plot of the mean number of rooms per wall type</li>
</ol>
<p>Compare the two graphs we have just drawn. How do they differ? Are
the differences significant?</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Show me the solution</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<p>Most importantly the data in the graphs is the same. There are
cosmetic differences in the scale points in the x and y axis and in the
width of the bars.</p>
<p>The width of the bars can be changed with a parameter in the ‘bar’
function</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>plt.bar(<span class="bu">range</span>(<span class="bu">len</span>(s)), s, width <span class="op">=</span> <span class="fl">0.5</span>)   <span class="co"># the default width is 0.8</span></span></code></pre>
</div>
<p>Extension: try plotting by wall and roof type?</p>
</div>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Show me the solution</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<p>For the scatter plot:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>df.plot.scatter(x <span class="op">=</span> <span class="st">'years_liv'</span>, y <span class="op">=</span> <span class="st">'years_farm'</span>, c <span class="op">=</span> <span class="st">'buildings_in_compound'</span>, colormap <span class="op">=</span> <span class="st">'viridis'</span>)</span></code></pre>
</div>
<figure><img src="../fig/scatter2.png" alt="png" class="figure mx-auto d-block"></figure><p>For the barplot: we first need to calculate the mean value of rooms
per wall type, then we can make the plot.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>rooms_mean <span class="op">=</span> df.groupby(<span class="st">'respondent_wall_type'</span>).mean()[<span class="st">'rooms'</span>]</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>rooms_mean.plot.bar()</span></code></pre>
</div>
<figure><img src="../fig/barplot1.png" alt="png" class="figure mx-auto d-block"></figure>
</div>
</div>
</div>
</div>
</section><section id="boxplot"><h2 class="section-heading">Boxplot<a class="anchor" aria-label="anchor" href="#boxplot"></a>
</h2>
<hr class="half-width">
<p>A boxplot provides a simple representation of a variety of
statistical qualities of a single set of data values. A common use of
the boxplot is to compare the statistical variations across a set of
variables.</p>
<p>The variables can be an independent series or columns of a Dataframe
using the Pandas plot method</p>
<pre><code>df.boxplot(by ='village',column=['buildings_in_compound'])</code></pre>
<p>{:.language-python}</p>
<figure><img src="../fig/boxplot1.png" alt="png" class="figure mx-auto d-block"></figure><p>We can make it look prettier with Seaborn, much more easily than
fixing components manually with Matplotlib. <a href="https://seaborn.pydata.org" class="external-link">Seaborn</a> is a Python data
visualization library based on Matplotlib. It provides a high-level
interface for drawing attractive and informative statistical graphics.
Seaborn comes with Anaconda; to make it available in our Python session
we need to import it.</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>sns.boxplot(data <span class="op">=</span> df, x <span class="op">=</span> <span class="st">'village'</span>, y <span class="op">=</span> <span class="st">'buildings_in_compound'</span>)</span></code></pre>
</div>
<figure><img src="../fig/boxplot2.png" alt="png" class="figure mx-auto d-block"></figure><p>We can also draw linear models in a plot using <code>lmplot()</code>
from <code>seaborn</code>, e.g. for <code>years_farm</code> vs
<code>years_liv</code> per <code>village</code>.</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>sns.lmplot(x<span class="op">=</span><span class="st">'years_farm'</span>, y<span class="op">=</span><span class="st">'years_liv'</span>,data<span class="op">=</span>df,hue<span class="op">=</span><span class="st">'village'</span>)</span></code></pre>
</div>
<figure><img src="../fig/lm1.png" alt="Plot showing years lived and years farmed by village to spotlight the use of linear models" class="figure mx-auto d-block"></figure><p>In general, most graphs can be broken down into a series of elements
which, although typically related in some way, can all exist
independently of each other. This allows us to create the graph in a
rather piecemeal fashion.</p>
<p>The labels (if any) on the x and y axis are independent of the data
values being represented. The title and the legend are also independent
objects within the overall graph.</p>
<p>In Matplotlib you create the graph by providing values for all of the
individual components you choose to include. When you are ready, you
call the <code>show</code> function.</p>
<p>Using this same approach, we can plot two sets of data on the same
graph.</p>
<p>We will use a scatter plot to demonstrate some of the available
features.</p>
</section><section id="fine-tuning-figures-with-matplotlib"><h2 class="section-heading">Fine-tuning figures with Matplotlib<a class="anchor" aria-label="anchor" href="#fine-tuning-figures-with-matplotlib"></a>
</h2>
<hr class="half-width">
<p>If we want to do more advanced or lower level things with our plots,
we need to use Matplotlib directly, not through Pandas. First we need to
import it.</p>
</section><section id="customising-our-plots-with-matplotlib"><h2 class="section-heading">Customising our plots with Matplotlib<a class="anchor" aria-label="anchor" href="#customising-our-plots-with-matplotlib"></a>
</h2>
<hr class="half-width">
<p>We can further customise our plots with Matplotlib directly. First we
need to import it. The Matplotlib library can be imported using any of
the import techniques we have seen. As Pandas is generally imported with
<code>import pandas as pd</code>, you will find that
<code>matplotlib</code> is most commonly imported with
<code>import matplotlib.pyplot as plt</code> where <code>plt</code> is
the alias. For demonstration purposes, we are going to use randomly
generated data, using the NumPy library (aliased here as
<code>np</code>).</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="co"># Generate some date for 2 sets of points.</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>x1 <span class="op">=</span> pd.Series(np.random.rand(<span class="dv">20</span>) <span class="op">-</span> <span class="fl">0.5</span>)</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>y1 <span class="op">=</span> pd.Series(np.random.rand(<span class="dv">20</span>) <span class="op">-</span> <span class="fl">0.5</span>)</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>x2 <span class="op">=</span> pd.Series(np.random.rand(<span class="dv">20</span>) <span class="op">+</span> <span class="fl">0.5</span>)</span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a>y2 <span class="op">=</span> pd.Series(np.random.rand(<span class="dv">20</span>) <span class="op">+</span> <span class="fl">0.5</span>)</span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a></span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a><span class="co"># Add some features</span></span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a>plt.title(<span class="st">'Scatter Plot'</span>)</span>
<span id="cb13-15"><a href="#cb13-15" tabindex="-1"></a>plt.ylabel(<span class="st">'Range of y values'</span>)</span>
<span id="cb13-16"><a href="#cb13-16" tabindex="-1"></a>plt.xlabel(<span class="st">'Range of x values'</span>)</span>
<span id="cb13-17"><a href="#cb13-17" tabindex="-1"></a></span>
<span id="cb13-18"><a href="#cb13-18" tabindex="-1"></a><span class="co"># plot the points in a scatter plot</span></span>
<span id="cb13-19"><a href="#cb13-19" tabindex="-1"></a>plt.scatter(x1, y1, c<span class="op">=</span><span class="st">'red'</span>, label<span class="op">=</span><span class="st">'Red Range'</span>)  <span class="co"># 'c' parameter is the colour and 'label' is the text for the legend</span></span>
<span id="cb13-20"><a href="#cb13-20" tabindex="-1"></a>plt.scatter(x2, y2, c<span class="op">=</span><span class="st">'blue'</span>, label<span class="op">=</span><span class="st">'Blue Range'</span>)</span>
<span id="cb13-21"><a href="#cb13-21" tabindex="-1"></a></span>
<span id="cb13-22"><a href="#cb13-22" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="dv">4</span>)  <span class="co"># the locations 1,2,3 and 4 are top-right, top-left, bottom-left and bottom-right</span></span>
<span id="cb13-23"><a href="#cb13-23" tabindex="-1"></a><span class="co"># Show the graph with the two sets of points</span></span>
<span id="cb13-24"><a href="#cb13-24" tabindex="-1"></a>plt.show()</span></code></pre>
</div>
<p>In the call to the <code>scatter</code> method, the
<code>label</code> parameter values are used by the <em>legend</em>. The
<code>c</code> or <code>color</code> parameter can be set to any color
Matplotlib recognises. Full details of the available colours are
available in the <a href="https://matplotlib.org/api/colors_api.html" class="external-link">Matplotlib</a>
website. The <a href="https://matplotlib.org/api/markers_api.html" class="external-link">markers</a> section
will tell you what markers you can use instead of the default ‘dots’.
There is also an <code>s</code> (size) parameter which allows you to
change the size of the marker.</p>
<div id="exercise-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-1" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#exercise-1"></a>
</h3>
<div class="callout-content">
<p>In the scatterplot the s parameter determines the size of the dots. s
can be a simple numeric value, say s=100, which will produce dots all of
the same size. However, you can pass a list of values (or a Pandas
Series) to provide sizes for the individual dots. This approach is very
common as it allows us to provide an extra variable worth of information
on the graph.</p>
<ol style="list-style-type: decimal">
<li><p>Modify the code we used for the scatter plot to include a size
value for each of the points in the series being plotted. (The downside
is that some of the smaller dots may be completely covered by the larger
dots. To try and highlight when this has happened, we can change the
opacity of the dots.)</p></li>
<li><p>Find out which parameter controls the opacity of the dots (clue -
it is not called opacity), add it to you code and set it &gt; to a
reasonable value.</p></li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">Show me the solution</h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co"># Generate some data for 2 sets of points.</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="co"># and additional data for the sizes - suitably scaled</span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>x1 <span class="op">=</span> pd.Series(np.random.rand(<span class="dv">20</span>) <span class="op">-</span> <span class="fl">0.5</span>)</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>y1 <span class="op">=</span> pd.Series(np.random.rand(<span class="dv">20</span>) <span class="op">-</span> <span class="fl">0.5</span>)</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>z1 <span class="op">=</span> pd.Series(np.random.rand(<span class="dv">20</span>) <span class="op">*</span> <span class="dv">200</span>)</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a>x2 <span class="op">=</span> pd.Series(np.random.rand(<span class="dv">20</span>) <span class="op">+</span> <span class="fl">0.5</span>)</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a>y2 <span class="op">=</span> pd.Series(np.random.rand(<span class="dv">20</span>) <span class="op">+</span> <span class="fl">0.5</span>)</span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>z2 <span class="op">=</span> pd.Series(np.random.rand(<span class="dv">20</span>) <span class="op">*</span> <span class="dv">200</span>)</span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a><span class="co"># Add some features</span></span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a>plt.title(<span class="st">'Scatter Plot'</span>)</span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a>plt.ylabel(<span class="st">'Range of y values'</span>)</span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a>plt.xlabel(<span class="st">'Range of x values'</span>)</span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a></span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a><span class="co"># plot the points in a scatter plot</span></span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a>plt.scatter(x1, y1, c<span class="op">=</span><span class="st">'red'</span>, label<span class="op">=</span><span class="st">'Red Range'</span>, s<span class="op">=</span>z1, alpha<span class="op">=</span><span class="fl">0.5</span>)  <span class="co"># 's' parameter is the dot size</span></span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a>plt.scatter(x2, y2, c<span class="op">=</span><span class="st">'blue'</span>, label<span class="op">=</span><span class="st">'Blue Range'</span>, s<span class="op">=</span>z2, alpha<span class="op">=</span><span class="fl">0.5</span>) <span class="co"># 'alpha' is the opacity</span></span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a></span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a>plt.show()</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Internally the Pandas ‘plot’ method has called the ‘bar’ method of
Matplotlib and provided a set of parameters, including the pandas.Series
s to generate the graph.</p>
<p>We can use Matplotlib directly to produce a similar graph. In this
case we need to pass two parameters, the number of bars we need and the
Pandas Series holding the values.</p>
<p>Let’s redo the boxplot we did above:</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>df.boxplot(column <span class="op">=</span> <span class="st">'buildings_in_compound'</span>, by <span class="op">=</span> <span class="st">'village'</span>)</span></code></pre>
</div>
<figure><img src="../fig/boxplot1.png" alt="png" class="figure mx-auto d-block"></figure><p>The automatic title of the plot does not look good, we are missing a
title for the y-axis and we do not need the extra x-axis title. We can
also remove the gridlines. Let’s fix these things using functions from
<code>plt</code>. Note: all the adjustments for the plot have to go into
the same notebook cell together with the plot statement itself.</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>df.boxplot(column <span class="op">=</span> <span class="st">'buildings_in_compound'</span>, by <span class="op">=</span> <span class="st">'village'</span>)</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>plt.suptitle(<span class="st">''</span>) <span class="co"># remove the automatic title</span></span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>plt.title(<span class="st">'Buildings in compounds per village'</span>)   <span class="co"># add a title</span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>plt.ylabel(<span class="st">'Number of buildings'</span>)   <span class="co"># add a y-axis title</span></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>plt.xlabel(<span class="st">''</span>)   <span class="co"># remove the x-axis title</span></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>plt.grid(<span class="va">None</span>)   <span class="co"># remove the grid lines</span></span></code></pre>
</div>
<figure><img src="../fig/boxplot3.png" alt="png" class="figure mx-auto d-block"></figure><p>In general most graphs can be broken down into a series of elements
which, although typically related in some way, can all exist
independently of each other. This allows us to create the graph in a
rather piecemeal fashion. The labels (if any) on the x and y axis are
independent of the data values being represented. The title and the
legend are also independent objects within the overall graph. In
<code>matplotlib</code> you create the graph by providing values for all
of the individual components you choose to include.</p>
</section><section id="saving-a-graph"><h2 class="section-heading">Saving a graph<a class="anchor" aria-label="anchor" href="#saving-a-graph"></a>
</h2>
<hr class="half-width">
<p>If you wish to save your graph as an image you can do so using the
<code>plt.savefig()</code> function. The image can be saved as a pdf,
jpg or png file by changing the file extension.
<code>plt.savefig()</code> needs to be called at the end of all your
plot statements in the same notebook cell.</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>df.boxplot(column <span class="op">=</span> <span class="st">'buildings_in_compound'</span>, by <span class="op">=</span> <span class="st">'village'</span>)</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>plt.suptitle(<span class="st">''</span>) <span class="co"># remove the automatic title</span></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>plt.title(<span class="st">'Buildings in compounds per village'</span>)   <span class="co"># add a title</span></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>plt.ylabel(<span class="st">'Number of buildings'</span>)   <span class="co"># add a y-axis title</span></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>plt.xlabel(<span class="st">''</span>)   <span class="co"># remove the x-axis title</span></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a>plt.grid(<span class="va">None</span>)   <span class="co"># remove the grid lines</span></span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a>plt.savefig(<span class="st">'safi_boxplot_buildings.pdf'</span>)   <span class="co"># save as pdf file</span></span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>plt.savefig(<span class="st">'safi_boxplot_buildings.png'</span>, dpi <span class="op">=</span> <span class="dv">150</span>)  <span class="co"># save as png file, some extra arguments are provided</span></span></code></pre>
</div>
<p>In general most graphs can be broken down into a series of elements
which, although typically related in some way, can all exist
independently of each other. This allows us to create the graph in a
rather piecemeal fashion.</p>
<p>The labels (if any) on the x and y axis are independent of the data
values being represented. The title and the legend are also independent
objects within the overall graph.</p>
<p>In Matplotlib you create the graph by providing values for all of the
individual components you choose to include. When you are ready, you
call the <code>show</code> function.</p>
<p>Using this same approach we can plot two sets of data on the same
graph. We will use a scatter plot to demonstrate some of the available
features.</p>
<div id="exercise-2" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="exercise-2" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#exercise-2"></a>
</h3>
<div class="callout-content">
<p>Revisit your favorite plot we’ve made so far, or make one with your
own data then:</p>
<ol style="list-style-type: decimal">
<li>add axes labels</li>
<li>add a title</li>
<li>add a legend</li>
<li>save it in two different formats</li>
</ol>
<p>extension: try plotting by wall and roof type!</p>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>Graphs can be drawn directly from Pandas, but it still uses
Matplotlib</li>
<li>Different graph types have different data requirements</li>
<li>Graphs are created from a variety of discrete components placed on a
‘canvas’, you don’t have to use them all</li>
</ul>
</div>
</div>
</div>
</section></section><section id="aio-14-sqlite"><p>Content from <a href="14-sqlite.html">Accessing SQLite Databases</a></p>
<hr>
<p>Last updated on 2023-05-04 |
        
        <a href="https://github.com/datacarpentry/python-socialsci/edit/main/episodes/14-sqlite.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 60 minutes</p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How can I access database tables using Pandas and Python?</li>
<li>What are the advantages of storing data in a database</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Use the sqlite3 module to interact with a SQL database</li>
<li>Access data stored in SQLite using Python</li>
<li>Describe the difference in interacting with data stored as a CSV
file versus in SQLite</li>
<li>Describe the benefits of accessing data using a database compared to
a CSV file</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section id="introducing-the-sqlite3-module"><h2 class="section-heading">Introducing the sqlite3 module<a class="anchor" aria-label="anchor" href="#introducing-the-sqlite3-module"></a>
</h2>
<hr class="half-width">
<p>SQLite is a relational database system. Despite the ‘Lite’ in the
name it can handle databases in excess of a Terabyte. The ‘Lite’part
really relates to the fact that it is a ’bare bones’ system. It provides
the mechanisms to create and query databases via a simple command line
interface but not much else. In the SQL lesson we used a Firefox plugin
to provide a GUI (Graphical User Interface) to the SQLite database
engine.</p>
<p>In this lesson we will use Python code using the sqlite3 module to
access the engine. We can use Python code and the sqlite3 module to
create, delete and query database tables.</p>
<p>In practice we spend a lot of the time querying database tables.</p>
</section><section id="pandas-dataframe-v-sql-table"><h2 class="section-heading">Pandas Dataframe v SQL table<a class="anchor" aria-label="anchor" href="#pandas-dataframe-v-sql-table"></a>
</h2>
<hr class="half-width">
<p>It is very easy and often very convenient to think of SQL tables and
pandas Dataframes as being similar types of objects. All of the data
manipulations, slicing, dicing, aggragetions and joins associated with
SQL and SQL tables can all be accomplished with pandas methods operating
on a pandas Dataframe.</p>
<p>The difference is that the pandas Dataframe is held in memory within
the Python environment. The SQL table can largely be on disc and when
you access it, it is the SQLite database engine which is doing the work.
This allows you to work with very large tables which your Python
environment may not have the memory to hold completely.</p>
<p>A typical use case for SQLite databases is to hold large datasets,
you use SQL commands from Python to slice and dice and possibly
aggregate the data within the database system to reduce the size to
something that Python can comfortably process and then return the
results to a Dataframe.</p>
</section><section id="accessing-data-stored-in-sqlite-using-python"><h2 class="section-heading">Accessing data stored in SQLite using Python<a class="anchor" aria-label="anchor" href="#accessing-data-stored-in-sqlite-using-python"></a>
</h2>
<hr class="half-width">
<p>We will illustrate the use of the <code>sqlite3</code> module by
connecting to an SQLite database using both core Python and also using
pandas.</p>
<p>The database that we will use is SN7577.sqlite This contains the data
from the SN7577 dataset that we have used in other lessons.</p>
</section><section id="connecting-to-an-sqlite-database"><h2 class="section-heading">Connecting to an SQlite database<a class="anchor" aria-label="anchor" href="#connecting-to-an-sqlite-database"></a>
</h2>
<hr class="half-width">
<p>The first thing we need to do is import the <code>sqlite3</code>
library, We will import pandas at the same time for convenience.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="im">import</span> sqlite3</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span></code></pre>
</div>
<p>We will start looking at the sqlite3 library by connecting to an
existing database and returning the results of running a query.</p>
<p>Initially we will do this without using Pandas and then we will
repreat the exercise so that you can see the difference.</p>
<p>The first thing we need to do is to make a connection to the
database. An SQLite database is just a file. To make a connection to it
we only need to use the sqlite3 <code>connect()</code> function and
specify the database file as the first parameter.</p>
<p>The connection is assigned to a variable. You could use any variable
name, but ‘con’ is quite commonly used for this purpose</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>con <span class="op">=</span> sqlite3.<span class="ex">connect</span>(<span class="st">'SN7577.sqlite'</span>)</span></code></pre>
</div>
<p>The next thing we need to do is to create a <code>cursor</code> for
the connection and assign it to a variable. We do this using the
<code>cursor</code> method of the connection object.</p>
<p>The cursor allows us to pass SQL statements to the database, have
them executed and then get the results back.</p>
<p>To execute an SQL statement we use the <code>execute()</code> method
of the cursor object.</p>
<p>The only paramater we need to pass to <code>execute()</code> is a
string which contains the SQL query we wish to execute.</p>
<p>In our example we are passing a literal string. It could have been
contained in a string variable. The string can contain any valid SQL
query. It could also be a valid DDL statement such as a “CREATE TABLE
…”. In this lesson however we will confine ourseleves to querying
exiting database tables.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>cur <span class="op">=</span> con.cursor()</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>cur.execute(<span class="st">"SELECT * FROM SN7577"</span>)</span></code></pre>
</div>
<pre><code>&lt;sqlite3.Cursor at 0x115e10d50&gt;</code></pre>
<p>{: output}</p>
<p>The <code>execute()</code> method doesn’t actually return any data,
it just indicates that we want the data provided by running the SELECT
statement.</p>
<div id="exercise" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#exercise"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal">
<li>What happens if you if you ask for a non existent table?, field
within a table? or just any kind of syntax error?</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Show me the solution</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>cur <span class="op">=</span> con.cursor()</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="co"># notice the mistyping of 'SELECT'</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>cur.execute(<span class="st">"SELET * FROM SN7577"</span>)</span></code></pre>
</div>
<p>In all cases an error message is returned. The error message is not
from Python but from SQLite. It is the same error message that you would
have got had you made the same errors in the SQLite plugin.</p>
</div>
</div>
</div>
</div>
<p>Before we can make use of the results of the query we need to use the
<code>fetchall()</code> method of the cursor.</p>
<p>The <code>fetchall()</code> method returns a list. Each item in the
list is a tuple containing the values from one row of the table. You can
iterate through the items in a tuple in the same way as you would do so
for a list.</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>cur <span class="op">=</span> con.cursor()</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>cur.execute(<span class="st">"SELECT * FROM SN7577"</span>)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>rows <span class="op">=</span> cur.fetchall()</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="cf">for</span> row <span class="kw">in</span> rows:</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>    <span class="bu">print</span>(row)</span></code></pre>
</div>
<pre><code>(1, -1, 1, 8, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 3, 3, 3, 2, 3, 3, 4, 1, 4, 2, 2, 2, 2, 1, 0, 0, 0, 3, 2, 3, 3, 1, 4, 2, 3
...</code></pre>
<p>{: output}</p>
<p>The output is the data only, you do not get the column names.</p>
<p>The column names are available from the ‘description’ of the
cursor.</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>colnames <span class="op">=</span> []</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="cf">for</span> description <span class="kw">in</span> cur.description :</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>    colnames.append(description[<span class="dv">0</span>])</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="bu">print</span>(colnames)</span></code></pre>
</div>
<pre><code>['Q1', 'Q2', 'Q3', 'Q4', 'Q5ai', 'Q5aii', 'Q5aiii', 'Q5aiv', 'Q5av', 'Q5avi', 'Q5avii', 'Q5aviii', 'Q5aix', 'Q5ax', 'Q5axi', 'Q5axii', 'Q5axiii', 'Q5axiv', 'Q5axv', 'Q5bi', 'Q5bii', 'Q5biii', 'Q5biv', 'Q5bv', 'Q5bvi', 'Q5bvii', 'Q5bviii', 'Q5bix', 'Q5bx', 'Q5bxi', 'Q5bxii', 'Q5bxiii', 'Q5bxiv', 'Q5bxv', 'Q6', 'Q7a', 'Q7b', 'Q8', 'Q9', 'Q10a', 'Q10b', 'Q10c', 'Q10d', 'Q11a',
...</code></pre>
<p>{: output}</p>
<p>One reason for using a database is the size of the data involved.
Consequently it may not be practial to use <code>fetchall()</code> as
this will return the complete result of your query.</p>
<p>An alternative is to use the <code>fetchone()</code> method, which as
the name suggestrs returns only a single row. The cursor keeps track of
where you are in the results of the query, so the next call to
<code>fetchone()</code> will return the next record. When there are no
more records it will return ‘None’.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>cur <span class="op">=</span> con.cursor()</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>cur.execute(<span class="st">"SELECT * FROM SN7577"</span>)</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>row <span class="op">=</span> cur.fetchone()</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a><span class="bu">print</span>(row)</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>row <span class="op">=</span> cur.fetchone()</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="bu">print</span>(row)</span></code></pre>
</div>
<pre><code>(1, -1, 1, 8, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 3, 3, 3, 2, 3, 3, 4, 1, 4, 2, 2, 2, 2, 1, 0, 0, 0, 3, 2, 3, 3, 1, 4, 2, 3, 2, 4, 4, 2, 2, 2, 4, 2, 1, 1, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0</code></pre>
<p>{: output}</p>
<div id="exercise-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-1" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#exercise-1"></a>
</h3>
<div class="callout-content">
<p>Can you write code to return the first 5 records from the SN7577
table in two different ways?</p>
</div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Show me the solution</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" aria-labelledby="headingSolution2" data-bs-parent="#accordionSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="im">import</span> sqlite3</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>con <span class="op">=</span> sqlite3.<span class="ex">connect</span>(<span class="st">'SN7577.sqlite'</span>)</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>cur <span class="op">=</span> con.cursor()</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="co"># we can use the SQLite 'limit' clause to restrict the number of rows returned and then use 'fetchall'</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>cur.execute(<span class="st">"SELECT * FROM SN7577 Limit 5"</span>)</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>rows <span class="op">=</span> cur.fetchall()</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="cf">for</span> row <span class="kw">in</span> rows:</span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a>    <span class="bu">print</span>(row)</span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a><span class="co"># we can use 'fetchone' in a for loop</span></span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a>cur.execute(<span class="st">"SELECT * FROM SN7577"</span>)</span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">6</span>):</span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a>    <span class="bu">print</span>(cur.fetchone())</span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a></span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a><span class="co"># a third way would be to use the 'fetchmany()' method</span></span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a></span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a>cur.execute(<span class="st">"SELECT * FROM SN7577"</span>)</span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a>rows <span class="op">=</span> cur.fetchmany(<span class="dv">5</span>)</span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a></span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a><span class="cf">for</span> row <span class="kw">in</span> rows:</span>
<span id="cb12-23"><a href="#cb12-23" tabindex="-1"></a>    <span class="bu">print</span>(row)</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section id="using-pandas-to-read-a-database-table."><h2 class="section-heading">Using Pandas to read a database table.<a class="anchor" aria-label="anchor" href="#using-pandas-to-read-a-database-table."></a>
</h2>
<hr class="half-width">
<p>When you use Pandas to read a database table, you connect to the
database in the same way as before using the SQLite3
<code>connect()</code> function and providing the filename of the
database file.</p>
<p>Pandas has a method <code>read_sql_query</code> to which you provide
both the string containing the SQL query you wish to run and also the
connection variable.</p>
<p>The results from running the query are placed in a pandas Dataframe
with the table column names automatically added.</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>con <span class="op">=</span> sqlite3.<span class="ex">connect</span>(<span class="st">'SN7577.sqlite'</span>)</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>df <span class="op">=</span> pd.read_sql_query(<span class="st">"SELECT * from SN7577"</span>, con)</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a><span class="co"># verify that result of SQL query is stored in the Dataframe</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(df))</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a><span class="bu">print</span>(df.shape)</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a><span class="bu">print</span>(df.head())</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a>con.close()</span></code></pre>
</div>
</section><section id="saving-a-dataframe-as-an-sqlite-table"><h2 class="section-heading">Saving a Dataframe as an SQLite table<a class="anchor" aria-label="anchor" href="#saving-a-dataframe-as-an-sqlite-table"></a>
</h2>
<hr class="half-width">
<p>There may be occasions when it is convenient to save the data in you
pandas Dataframe as an SQLite table for future use or for access to
other systems. This can be done using the <code>to_sql()</code>
method.</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>con <span class="op">=</span> sqlite3.<span class="ex">connect</span>(<span class="st">'SN7577.sqlite'</span>)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>df <span class="op">=</span> pd.read_sql_query(<span class="st">"SELECT * from SN7577"</span>, con)</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="co"># select only the row where the response to Q1 is 10 meaning undecided voter</span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>df_undecided <span class="op">=</span> df[df.Q1 <span class="op">==</span> <span class="dv">10</span>]</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a><span class="bu">print</span>(df_undecided.shape)</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a><span class="co"># Write the new Dataframe to a new SQLite table</span></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a>df_undecided.to_sql(<span class="st">"Q1_undecided"</span>, con)</span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a><span class="co"># If you want to overwrite an existing SQLite table you can use the 'if_exists' parameter</span></span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a><span class="co">#df_undecided.to_sql("Q1_undecided", con, if_exists="replace")</span></span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a>con.close()</span></code></pre>
</div>
<pre><code>(335, 202)</code></pre>
<p>{: output}</p>
</section><section id="deleting-an-sqlite-table"><h2 class="section-heading">Deleting an SQLite table<a class="anchor" aria-label="anchor" href="#deleting-an-sqlite-table"></a>
</h2>
<hr class="half-width">
<p>If you have created tables in an SQLite database, you may also want
to delete them. You can do this by using the sqlite3 cursor
<code>execute()</code> method</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>con <span class="op">=</span> sqlite3.<span class="ex">connect</span>(<span class="st">'SN7577.sqlite'</span>)</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>cur <span class="op">=</span> con.cursor()</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>cur.execute(<span class="st">'drop table if exists Q1_undecided'</span>)</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>con.close()</span></code></pre>
</div>
<div id="exercise-2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise-2" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#exercise-2"></a>
</h3>
<div class="callout-content">
<p>The code below creates an SQLite table as we have done in previous
examples. Run this code to create the table.</p>
<pre><code><span><span class="va">con</span> <span class="op">=</span> <span class="fu">sqlite3.connect</span><span class="op">(</span><span class="st">'SN7577.sqlite'</span><span class="op">)</span></span>
<span><span class="va">df_undecided</span> <span class="op">=</span> <span class="va">df</span><span class="op">[</span><span class="va">df.Q1</span> <span class="op">==</span> <span class="fl">10</span><span class="op">]</span></span>
<span><span class="fu">df_undecided.to_sql</span><span class="op">(</span><span class="st">"Q1_undecided_v2"</span>, <span class="va">con</span><span class="op">)</span></span>
<span><span class="fu">con.close</span><span class="op">(</span><span class="op">)</span></span></code></pre>
<p>Try using the following pandas code to delete (drop) the table.</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>pd.read_sql_query(<span class="st">"drop table Q1_undecided_v2"</span>, con)</span></code></pre>
</div>
<ol style="list-style-type: decimal">
<li>What happens?</li>
<li>Run this line of code again, What is different?</li>
<li>Can you explain the difference and does the table now exist or
not?</li>
</ol>
</div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">Show me the solution</h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" aria-labelledby="headingSolution3" data-bs-parent="#accordionSolution3">
<div class="accordion-body">
<ol style="list-style-type: decimal">
<li><p>When the line of code is run the first time you get an error
message : ‘NoneType’ object is not iterable.</p></li>
<li><p>When you run it a second time you get a different error message:
DatabaseError: Execution failed on sql ‘drop table Q1_undecided_v2’: no
such table: Q1_undecided_v2</p></li>
<li><p>the <code>read_sql_query()</code> method is designed to send the
SQL containing your query to the SQLite execution engine, which will
execute the SQL and return the output to pandas which will create a
Dataframe from the results.</p></li>
</ol>
<p>The SQL statement we sent is valid SQL but it doesn’t return rows
from a table, it simply reports success of failure (in dropping the
table in this case). The first time we run it the table is deleted and a
response to the effect is returned. The resonse cannot be converted to a
Dataframe, hence the first error message, which is a pandas error.</p>
<p>When we run it for the second time, the table has already has already
been dropped, so this time the error message is from SQLite saying the
table didn’t exist. Pandas recognises that this is an SQLite error
message and simply passes it on to the user.</p>
<p>The moral of the story: pandas may be better for getting data
returned into a Dataframe, but there are some things best left to the
sqlite functions directly.</p>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>The SQLite database system is directly available from within
Python</li>
<li>A database table and a pandas Dataframe can be considered similar
structures</li>
<li>Using pandas to return all of the results from a query is simpler
than using sqlite3 alone</li>
</ul>
</div>
</div>
</div>
</section></section>
</div>
    </main>
</div>
<!-- END  : inst/pkgdown/templates/content-extra.html -->

      </div>
<!--/div.row-->
      		<footer class="row footer mx-md-3"><hr>
<div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>
        
        <a href="https://github.com/datacarpentry/python-socialsci/edit/main/README.md" class="external-link">Edit on GitHub</a>
        
	
        | <a href="https://github.com/datacarpentry/python-socialsci/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/datacarpentry/python-socialsci/" class="external-link">Source</a></p>
				<p><a href="https://github.com/datacarpentry/python-socialsci/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:team@carpentries.org">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">
        
        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>
        
        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.2" class="external-link">sandpaper (0.16.2)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.3" class="external-link">pegboard (0.7.3)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.1" class="external-link">varnish (1.0.1)</a></p>
			</div>
		</footer>
</div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://datacarpentry.github.io/python-socialsci/instructor/aio.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "All in One View",
  "creativeWorkStatus": "active",
  "url": "https://datacarpentry.github.io/python-socialsci/instructor/aio.html",
  "identifier": "https://datacarpentry.github.io/python-socialsci/instructor/aio.html",
  "dateCreated": "2017-05-25",
  "dateModified": "2024-03-05",
  "datePublished": "2024-03-05"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo
    2022-11-07: we have gotten a notification that we have an overage for our
    tracking and I'm pretty sure this has to do with Workbench usage.
    Considering that I am not _currently_ using this tracking because I do not
    yet know how to access the data, I am turning this off for now.
  <script>
    var _paq = window._paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
    _paq.push(["setDomains", ["*.preview.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
    _paq.push(["setDoNotTrack", true]);
    _paq.push(["disableCookies"]);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
          var u="https://carpentries.matomo.cloud/";
          _paq.push(['setTrackerUrl', u+'matomo.php']);
          _paq.push(['setSiteId', '1']);
          var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
          g.async=true; g.src='https://cdn.matomo.cloud/carpentries.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
        })();
  </script>
  End Matomo Code -->
</body>
</html><!-- END:   inst/pkgdown/templates/layout.html-->

