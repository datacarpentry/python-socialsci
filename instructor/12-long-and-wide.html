<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Data Analysis and Visualization with Python for Social Scientists *alpha*: Wide and long data formats</title><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" type="text/css" href="../assets/styles.css"><script src="../assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="manifest" href="../site.webmanifest"><link rel="mask-icon" href="../safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"></head><body>
    <header id="top" class="navbar navbar-expand-md navbar-light bg-white top-nav data"><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-6">
      <div class="large-logo">
        <img alt="Data Carpentry" src="../assets/images/data-logo.svg"><abbr class="badge badge-light" title="This lesson is in the alpha phase, which means that it has been taught once and lesson authors are iterating on feedback." style="background-color: #FFC700; border-radius: 5px">
          <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#field-testing-alpha-stage" class="external-link alert-link" style="color: #383838">
            <i aria-hidden="true" class="icon" data-feather="alert-triangle" style="border-radius: 5px"></i>
            Alpha
          </a>
          <span class="visually-hidden">This lesson is in the alpha phase, which means that it has been taught once and lesson authors are iterating on feedback.</span>
        </abbr>
        
      </div>
    </div>
    <div class="selector-container">
      
      
      <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='../12-long-and-wide.html';">Learner View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl navbar-light bg-white bottom-nav data" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Data Carpentry" src="../assets/images/data-logo-sm.svg"></div>
    <div class="lesson-title-md">
      Data Analysis and Visualization with Python for Social Scientists *alpha*
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="search button" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            Data Analysis and Visualization with Python for Social Scientists *alpha*
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Instructor Notes</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extract All Images</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><hr><li><a class="dropdown-item" href="discuss.html">Discussion</a></li><li><a class="dropdown-item" href="reference.html">Glossary</a></li>
          </ul></li>
      </ul></div>
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled><input class="form-control me-2 searchbox" type="search" placeholder="Search" aria-label="Search"><button class="btn btn-outline-success tablet-search-button" type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="search button"></i>
        </button>
      </fieldset></form>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Data Analysis and Visualization with Python for Social Scientists *alpha*
</div>

<aside class="col-md-12 lesson-progress"><div style="width: 74%" class="percentage">
    74%
  </div>
  <div class="progress data">
    <div class="progress-bar data" role="progressbar" style="width: 74%" aria-valuenow="74" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../12-long-and-wide.html">Learner View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->
      
            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Schedule</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="01-introduction.html">1. Introduction to Python</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="02-basics.html">2. Python basics</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="03-control-structures.html">3. Python control structures</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="04-reusable.html">4. Creating re-usable code</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="05-processing-data-from-file.html">5. Processing data from a file</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="06-date-and-time.html">6. Dates and Time</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="07-json.html">7. Processing JSON data</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush9">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading9">
        <a href="08-Pandas.html">8. Reading data from a file using Pandas</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush10">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading10">
        <a href="09-extracting-data.html">9. Extracting row and columns</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush11">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading11">
        <a href="10-aggregations.html">10. Data Aggregation using Pandas</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush12">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading12">
        <a href="11-joins.html">11. Joining Pandas Dataframes</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapsecurrent" aria-expanded="true" aria-controls="flush-collapsecurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        12. Wide and long data formats
        </span>
      </button>
    </div><!--/div.accordion-header-->
        
    <div id="flush-collapsecurrent" class="accordion-collapse collapse show" aria-labelledby="flush-headingcurrent" data-bs-parent="#accordionFlushcurrent">
      <div class="accordion-body">
        <ul><li><a href="#wide-and-long-data-formats">Wide and long data formats</a></li>
<li><a href="#from-wide-to-long">From ‘wide’ to ‘long’</a></li>
<li><a href="#from-long-to-wide">From Long to Wide</a></li>
        </ul></div><!--/div.accordion-body-->
    </div><!--/div.accordion-collapse-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush14">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading14">
        <a href="13-matplotlib.html">13. Data visualisation using Matplotlib</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush15">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading15">
        <a href="14-sqlite.html">14. Accessing SQLite Databases</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="../instructor/key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Instructor Notes</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extract All Images</a>
                      </li>
                      <hr><li><a class="dropdown-item" href="discuss.html">Discussion</a></li><li><a class="dropdown-item" href="reference.html">Glossary</a></li>
                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width resources"><a href="../instructor/aio.html">See all in one page</a>
            

            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">
            
            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/11-joins.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/13-matplotlib.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/11-joins.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Joining Pandas
        </a>
        <a class="chapter-link float-end" href="../instructor/13-matplotlib.html" rel="next">
          Next: Data visualisation... 
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>Wide and long data formats</h1>
        <p>Last updated on 2023-05-04 |
        
        <a href="https://github.com/datacarpentry/python-socialsci/edit/main/episodes/12-long-and-wide.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
        
        
        
        <p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 35 minutes</p>
        
        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>What are long and Wide formats?</li>
<li>Why would I want to change between them?</li>
</ul></div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul><li>Explain difference between long and wide formats and why each might
be used</li>
<li>Illustrate how to change between formats using the
<code>melt()</code> and <code>pivot()</code> methods</li>
</ul></div>
</div>
</div>
</div>
</div>
<section id="wide-and-long-data-formats"><h2 class="section-heading">Wide and long data formats<a class="anchor" aria-label="anchor" href="#wide-and-long-data-formats"></a>
</h2>
<hr class="half-width"><p>In the SN7577 dataset that we have been using there is a group of
columns which record which daily newspapers each respondent reads.
Despite the un-informative names like ‘daily1’ each column refers to a
current UK daily national or local newspaper.</p>
<p>Whether the paper is read or not is recorded using the values of 0 or
1 as a boolean indicator. The advantage of using a column for each paper
means that should a respondent read multiple newspapers, all of the
required information can still be recorded in a single record.</p>
<p>Recording information in this <em>wide</em> format is not always
beneficial when trying to analyse the data.</p>
<p>Pandas provides methods for converting data from <em>wide</em> to
<em>long</em> format and from <em>long</em> to <em>wide</em> format</p>
<p>The SN7577 dataset does not contain a variable that can be used to
uniquely identify a row. This is often referred to as a ‘primary key’
field (or column).</p>
<p>A dataset doesn’t need to have such a key. None of the work we have
done so far has required it.</p>
<p>When we create a pandas Dataframe by importing a csv file, we have
seen that pandas will create an index for the rows. This index can be
used a bit like a key field, but as we have seen there can be problems
with the index when we concatenate two Dataframes together.</p>
<p>In the version of SN7577 that we are going to use to demonstrate long
and wide formats we will add a new variable with the name of ‘Id’ and we
will restrict the other columns to those starting with the word
‘daily’.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>df_SN7577 <span class="op">=</span> pd.read_csv(<span class="st">"SN7577.tab"</span>, sep<span class="op">=</span><span class="st">'</span><span class="ch">\t</span><span class="st">'</span>)</span></code></pre>
</div>
<p>We will create a new Dataframe with a single column of ‘Id’.</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># create an 'Id' column</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>df_papers1 <span class="op">=</span> pd.DataFrame(pd.Series(<span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">1287</span>)), index<span class="op">=</span><span class="va">None</span>, columns<span class="op">=</span>[<span class="st">'Id'</span>])</span></code></pre>
</div>
<p>Using the range function, we can create values of <code>Id</code>
starting with 1 and going up to 1286 (remember the second parameter to
range is one past the last value used.) We have explicitly coded this
value because we knew how many rows were in the dataset. If we didn’t,
we could have used</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="bu">len</span>(df_SN7577.index) <span class="op">+</span><span class="dv">1</span></span></code></pre>
</div>
<pre><code><span><span class="fl">1287</span></span></code></pre>
<p>{: output}</p>
<p>We will create a 2nd Dataframe, based on SN7577 but containing only
the columns starting with the word ‘daily’.</p>
<p>There are several ways of doing this, we’ll cover the way that we
have covered all of the prerequisites for. We will use the
<code>filter</code> method of <code>pandas</code> with its
<code>like</code> parameter.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>df_papers2 <span class="op">=</span> df_SN7577.<span class="bu">filter</span>(like<span class="op">=</span> <span class="st">'daily'</span>)</span></code></pre>
</div>
<p>The value supplied to <code>like</code> can occur anywhere in the
column name to be matched (and therefore selected).</p>
<div id="callout1" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div class="section level3 callout-title callout-inner">
<h3 class="callout-title" id="another-way">Another way<a class="anchor" aria-label="anchor" href="#another-way"></a></h3>
<div class="callout-content">
<p>If we knew the column numbers and they were all continuous we could
use the <code>iloc</code> method and provide the index values of the
range of columns we want.</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>df_papers2 <span class="op">=</span> df_SN7577.iloc[:,<span class="dv">118</span>:<span class="dv">143</span>]</span></code></pre>
</div>
</div>
</div>
</div>
<p>To create the Dataframe that we will use, we will concatenate the two
Dataframes we have created.</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>df_papers <span class="op">=</span> pd.concat([df_papers1, df_papers2], axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="bu">print</span>(df_papers.index)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="bu">print</span>(df_papers.columns)</span></code></pre>
</div>
<pre><code>RangeIndex(start=0, stop=1286, step=1)
Index(['Id', 'daily1', 'daily2', 'daily3', 'daily4', 'daily5', 'daily6',
       'daily7', 'daily8', 'daily9', 'daily10', 'daily11', 'daily12',
       'daily13', 'daily14', 'daily15', 'daily16', 'daily17', 'daily18',
       'daily19', 'daily20', 'daily21', 'daily22', 'daily23', 'daily24',
       'daily25'],
      dtype='object')</code></pre>
<p>{: output}</p>
<p>We use <code>axis = 1</code> because we are joining by columns, the
default is joining by rows (<code>axis=0</code>).</p>
</section><section id="from-wide-to-long"><h2 class="section-heading">From ‘wide’ to ‘long’<a class="anchor" aria-label="anchor" href="#from-wide-to-long"></a>
</h2>
<hr class="half-width"><p>To make the displays more manageable we will use only the first eight
‘daily’ columns</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co">## using df_papers</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>daily_list <span class="op">=</span> df_papers.columns[<span class="dv">1</span>:<span class="dv">8</span>]</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>df_daily_papers_long <span class="op">=</span> pd.melt(df_papers, id_vars <span class="op">=</span> [<span class="st">'Id'</span>], value_vars <span class="op">=</span> daily_list)</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="co"># by default, the new columns created will be called 'variable' which is the name of the 'daily'</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="co"># and 'value' which is the value of that 'daily' for that 'Id'. So, we will rename the columns</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>df_daily_papers_long.columns <span class="op">=</span> [<span class="st">'Id'</span>,<span class="st">'Daily_paper'</span>,<span class="st">'Value'</span>]</span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>df_daily_papers_long</span></code></pre>
</div>
<p>We now have a Dataframe that we can <code>groupby</code>.</p>
<p>We want to <code>groupby</code> the <code>Daily_paper</code> and then
sum the <code>Value</code>.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>a <span class="op">=</span> df_daily_papers_long.groupby(<span class="st">'Daily_paper'</span>)[<span class="st">'Value'</span>].<span class="bu">sum</span>()</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>a</span></code></pre>
</div>
<pre><code>Daily_paper
daily1     0
daily2    26
daily3    52</code></pre>
<p>{: output}</p>
</section><section id="from-long-to-wide"><h2 class="section-heading">From Long to Wide<a class="anchor" aria-label="anchor" href="#from-long-to-wide"></a>
</h2>
<hr class="half-width"><p>The process can be reversed by using the <code>pivot()</code> method.
Here we need to indicate which column (or columns) remain fixed (this
will become an index in the new Dataframe), which column contains the
values which are to become column names and which column contains the
values for the columns.</p>
<p>In our case we want to use the <code>Id</code> column as the fixed
column, the <code>Daily_paper</code> column contains the column names
and the <code>Value</code> column contains the values.</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>df_daily_papers_wide <span class="op">=</span> df_daily_papers_long.pivot(index <span class="op">=</span> <span class="st">'Id'</span>, columns <span class="op">=</span> <span class="st">'Daily_paper'</span>, values <span class="op">=</span> <span class="st">'Value'</span>)</span></code></pre>
</div>
<p>We can change our <code>Id</code> index back to an ordinary column
with</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>df_daily_papers_wide.reset_index(level<span class="op">=</span><span class="dv">0</span>, inplace<span class="op">=</span><span class="va">True</span>)</span></code></pre>
</div>
<div id="exercise" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#exercise"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal"><li>Find out how many people take each of the daily newspapers by
Title.</li>
<li>Which titles don’t appear to be read by anyone?</li>
</ol><p>There is a file called Newspapers.csv which lists all of the
newspapers Titles along with the corresponding ‘daily’ value</p>
<p>Hint: Newspapers.csv contains both daily and Sunday newspapers you
can filter out the Sunday papers with the following code:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>df_newspapers <span class="op">=</span> df_newspapers[(df_newspapers.Column_name.<span class="bu">str</span>.startswith(<span class="st">'daily'</span>))]</span></code></pre>
</div>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Show me the solution</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<ol style="list-style-type: decimal"><li>Read in Newspapers.csv file and keep only the dailies.</li>
</ol><div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>df_newspapers <span class="op">=</span> pd.read_csv(<span class="st">"Newspapers.csv"</span>)</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>df_newspapers <span class="op">=</span> df_newspapers[(df_newspapers.Column_name.<span class="bu">str</span>.startswith(<span class="st">'daily'</span>))]</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>df_newspapers</span></code></pre>
</div>
<ol start="2" style="list-style-type: decimal"><li>Create the df_papers Dataframe as we did before.</li>
</ol><div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>df_SN7577 <span class="op">=</span> pd.read_csv(<span class="st">"SN7577.tab"</span>, sep<span class="op">=</span><span class="st">'</span><span class="ch">\t</span><span class="st">'</span>)</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="co">#create an 'Id' column</span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>df_papers1 <span class="op">=</span> pd.DataFrame(pd.Series(<span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">1287</span>)),index<span class="op">=</span><span class="va">None</span>,columns<span class="op">=</span>[<span class="st">'Id'</span>])</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>df_papers2 <span class="op">=</span> df_SN7577.<span class="bu">filter</span>(like<span class="op">=</span> <span class="st">'daily'</span>)</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>df_papers <span class="op">=</span> pd.concat([df_papers1, df_papers2], axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>df_papers</span></code></pre>
</div>
<ol start="3" style="list-style-type: decimal"><li>Create a list of all of the dailies, one way would be</li>
</ol><div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>daily_list <span class="op">=</span> []</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">26</span>):</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>    daily_list.append(<span class="st">'daily'</span><span class="op">+</span><span class="bu">str</span>(i))  </span></code></pre>
</div>
<ol start="4" style="list-style-type: decimal"><li>Pass the list as the <code>value_vars</code> parameter to the
<code>melt()</code> method</li>
</ol><div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="co">#use melt to create df_daily_papers_long  </span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>df_daily_papers_long <span class="op">=</span> pd.melt(df_papers, id_vars <span class="op">=</span> [<span class="st">'Id'</span>], value_vars <span class="op">=</span> daily_list )</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="co">#Change the column names</span></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>df_daily_papers_long.columns <span class="op">=</span> [<span class="st">'Id'</span>, <span class="st">'Daily_paper'</span>, <span class="st">'Value'</span>]</span></code></pre>
</div>
<ol start="5" style="list-style-type: decimal"><li>
<code>merge</code> the two Dataframes with a left join, because we
want all of the Newspaper Titles to be included.</li>
</ol><div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>df_papers_taken <span class="op">=</span> pd.merge(df_newspapers, df_daily_papers_long, how<span class="op">=</span><span class="st">'left'</span>, left_on <span class="op">=</span> <span class="st">'Column_name'</span>,right_on <span class="op">=</span> <span class="st">'Daily_paper'</span>)</span></code></pre>
</div>
<ol start="6" style="list-style-type: decimal"><li>Then <code>groupby</code> the ‘Title’ and sum the ‘Value’</li>
</ol><div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>df_papers_taken.groupby(<span class="st">'Title'</span>)[<span class="st">'Value'</span>].<span class="bu">sum</span>()</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul><li>The <code>melt()</code> method can be used to change from wide to
long format</li>
<li>The <code>pivot()</code> method can be used to change from the long
to wide format</li>
<li>Aggregations are best done from data in the long format.</li>
</ul></div>
</div>
</div>
</section></div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/11-joins.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/13-matplotlib.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/11-joins.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Joining Pandas
        </a>
        <a class="chapter-link float-end" href="../instructor/13-matplotlib.html" rel="next">
          Next: Data visualisation... 
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>
        
        <a href="https://github.com/datacarpentry/python-socialsci/edit/main/episodes/12-long-and-wide.md" class="external-link">Edit on GitHub</a>
        
	
        | <a href="https://github.com/datacarpentry/python-socialsci/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/datacarpentry/python-socialsci/" class="external-link">Source</a></p>
				<p><a href="https://github.com/datacarpentry/python-socialsci/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:team@carpentries.org">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">
        
        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>
        
        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.2" class="external-link">sandpaper (0.16.2)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.3" class="external-link">pegboard (0.7.3)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.1" class="external-link">varnish (1.0.1)</a></p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://datacarpentry.github.io/python-socialsci/instructor/12-long-and-wide.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "Wide and long data formats",
  "creativeWorkStatus": "active",
  "url": "https://datacarpentry.github.io/python-socialsci/instructor/12-long-and-wide.html",
  "identifier": "https://datacarpentry.github.io/python-socialsci/instructor/12-long-and-wide.html",
  "dateCreated": "2017-05-25",
  "dateModified": "2023-05-04",
  "datePublished": "2024-03-05"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo
    2022-11-07: we have gotten a notification that we have an overage for our
    tracking and I'm pretty sure this has to do with Workbench usage.
    Considering that I am not _currently_ using this tracking because I do not
    yet know how to access the data, I am turning this off for now.
  <script>
    var _paq = window._paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
    _paq.push(["setDomains", ["*.preview.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
    _paq.push(["setDoNotTrack", true]);
    _paq.push(["disableCookies"]);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
          var u="https://carpentries.matomo.cloud/";
          _paq.push(['setTrackerUrl', u+'matomo.php']);
          _paq.push(['setSiteId', '1']);
          var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
          g.async=true; g.src='https://cdn.matomo.cloud/carpentries.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
        })();
  </script>
  End Matomo Code --></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

