<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Data Analysis and Visualization with Python for Social Scientists *alpha*: Joining Pandas Dataframes</title><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" type="text/css" href="../assets/styles.css"><script src="../assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="manifest" href="../site.webmanifest"><link rel="mask-icon" href="../safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"></head><body>
    <header id="top" class="navbar navbar-expand-md navbar-light bg-white top-nav data"><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-6">
      <div class="large-logo">
        <img alt="Data Carpentry" src="../assets/images/data-logo.svg"><abbr class="badge badge-light" title="This lesson is in the alpha phase, which means that it has been taught once and lesson authors are iterating on feedback." style="background-color: #FFC700; border-radius: 5px">
          <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#field-testing-alpha-stage" class="external-link alert-link" style="color: #383838">
            <i aria-hidden="true" class="icon" data-feather="alert-triangle" style="border-radius: 5px"></i>
            Alpha
          </a>
          <span class="visually-hidden">This lesson is in the alpha phase, which means that it has been taught once and lesson authors are iterating on feedback.</span>
        </abbr>
        
      </div>
    </div>
    <div class="selector-container">
      
      
      <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='../11-joins.html';">Learner View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl navbar-light bg-white bottom-nav data" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Data Carpentry" src="../assets/images/data-logo-sm.svg"></div>
    <div class="lesson-title-md">
      Data Analysis and Visualization with Python for Social Scientists *alpha*
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="search button" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            Data Analysis and Visualization with Python for Social Scientists *alpha*
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/instructor-notes.html">Instructor Notes</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../instructor/images.html">Extract All Images</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><hr><li><a class="dropdown-item" href="discuss.html">Discussion</a></li><li><a class="dropdown-item" href="reference.html">Glossary</a></li>
          </ul></li>
      </ul></div>
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled><input class="form-control me-2 searchbox" type="search" placeholder="Search" aria-label="Search"><button class="btn btn-outline-success tablet-search-button" type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="search button"></i>
        </button>
      </fieldset></form>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Data Analysis and Visualization with Python for Social Scientists *alpha*
</div>

<aside class="col-md-12 lesson-progress"><div style="width: 68%" class="percentage">
    68%
  </div>
  <div class="progress data">
    <div class="progress-bar data" role="progressbar" style="width: 68%" aria-valuenow="68" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Instructor View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="../11-joins.html">Learner View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->
      
            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Schedule</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="01-introduction.html">1. Introduction to Python</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="02-basics.html">2. Python basics</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="03-control-structures.html">3. Python control structures</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="04-reusable.html">4. Creating re-usable code</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="05-processing-data-from-file.html">5. Processing data from a file</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="06-date-and-time.html">6. Dates and Time</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush8">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading8">
        <a href="07-json.html">7. Processing JSON data</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush9">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading9">
        <a href="08-Pandas.html">8. Reading data from a file using Pandas</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush10">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading10">
        <a href="09-extracting-data.html">9. Extracting row and columns</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush11">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading11">
        <a href="10-aggregations.html">10. Data Aggregation using Pandas</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapsecurrent" aria-expanded="true" aria-controls="flush-collapsecurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        11. Joining Pandas Dataframes
        </span>
      </button>
    </div><!--/div.accordion-header-->
        
    <div id="flush-collapsecurrent" class="accordion-collapse collapse show" aria-labelledby="flush-headingcurrent" data-bs-parent="#accordionFlushcurrent">
      <div class="accordion-body">
        <ul><li><a href="#joining-dataframes">Joining Dataframes</a></li>
        </ul></div><!--/div.accordion-body-->
    </div><!--/div.accordion-collapse-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush13">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading13">
        <a href="12-long-and-wide.html">12. Wide and long data formats</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush14">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading14">
        <a href="13-matplotlib.html">13. Data visualisation using Matplotlib</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush15">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading15">
        <a href="14-sqlite.html">14. Accessing SQLite Databases</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="../instructor/key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="../instructor/instructor-notes.html">Instructor Notes</a>
                      </li>
                      <li>
                        <a href="../instructor/images.html">Extract All Images</a>
                      </li>
                      <hr><li><a class="dropdown-item" href="discuss.html">Discussion</a></li><li><a class="dropdown-item" href="reference.html">Glossary</a></li>
                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width resources"><a href="../instructor/aio.html">See all in one page</a>
            

            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">
            
            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/10-aggregations.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/12-long-and-wide.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/10-aggregations.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Data Aggregation
        </a>
        <a class="chapter-link float-end" href="../instructor/12-long-and-wide.html" rel="next">
          Next: Wide and long data... 
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>Joining Pandas Dataframes</h1>
        <p>Last updated on 2023-05-04 |
        
        <a href="https://github.com/datacarpentry/python-socialsci/edit/main/episodes/11-joins.md" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
        
        
        
        <p>Estimated time: <i aria-hidden="true" data-feather="clock"></i> 35 minutes</p>
        
        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>How can I join two Dataframes with a common key?</li>
</ul></div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul><li>Understand why we would want to join Dataframes</li>
<li>Know what is needed for a join to be possible</li>
<li>Understand the different types of joins</li>
<li>Understand what the joined results tell us about our data</li>
</ul></div>
</div>
</div>
</div>
</div>
<section id="joining-dataframes"><h2 class="section-heading">Joining Dataframes<a class="anchor" aria-label="anchor" href="#joining-dataframes"></a>
</h2>
<hr class="half-width"><div class="section level3">
<h3 id="why-do-we-want-to-do-this">Why do we want to do this<a class="anchor" aria-label="anchor" href="#why-do-we-want-to-do-this"></a></h3>
<p>There are many occasions when we have related data spread across
multiple files.</p>
<p>The data can be related to each other in different ways. How they are
related and how completely we can join the data from the datasets will
vary.</p>
<p>In this episode we will consider different scenarios and show we
might join the data. We will use csv files and in all cases the first
step will be to read the datasets into a pandas Dataframe from where we
will do the joining. The csv files we are using are cut down versions of
the SN7577 dataset to make the displays more manageable.</p>
<p>First, let’s download the datafiles. They are listed in the <a href="https://datacarpentry.org/python-socialsci/setup.html" class="external-link">setup
page</a> for the lesson. Alternatively, you can download the <a href="https://github.com/datacarpentry/python-socialsci/archive/gh-pages.zip" class="external-link">GitHub
repository for this lesson</a>. The data files are in the <em>data</em>
directory. If you’re using Jupyter, make sure to place these files in
the same directory where your notebook file is.</p>
</div>
<div class="section level3">
<h3 id="scenario-1---two-data-sets-containing-the-same-columns-but-different-rows-of-data">Scenario 1 - Two data sets containing the same columns but different
rows of data<a class="anchor" aria-label="anchor" href="#scenario-1---two-data-sets-containing-the-same-columns-but-different-rows-of-data"></a></h3>
<p>Here we want to add the rows from one Dataframe to the rows of the
other Dataframe. In order to do this we can use the
<code>pd.concat()</code> function.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>df_SN7577i_a <span class="op">=</span> pd.read_csv(<span class="st">"SN7577i_a.csv"</span>)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>df_SN7577i_b <span class="op">=</span> pd.read_csv(<span class="st">"SN7577i_b.csv"</span>)</span></code></pre>
</div>
<p>Have a quick look at what these Dataframes look like with</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="bu">print</span>(df_SN7577i_a)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="bu">print</span>(df_SN7577i_b)</span></code></pre>
</div>
<pre><code>  Id  Q1  Q2  Q3  Q4
0   1   1  -1   1   8
1   2   3  -1   1   4
2   3  10   3   2   6
3   4   9  -1  10  10
...

  Id  Q1  Q2  Q3  Q4
0  1277  10  10   4   6
1  1278   2  -1   5   4
2  1279   2  -1   4   5
3  1280   1  -1   2   3
...</code></pre>
<p>{: output}</p>
<p>The <code>concat()</code> function appends the rows from the two
Dataframes to create the df_all_rows Dataframe. When you list this out
you can see that all of the data rows are there, however, there is a
problem with the <code>index</code>.</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>df_all_rows <span class="op">=</span> pd.concat([df_SN7577i_a, df_SN7577i_b])</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>df_all_rows</span></code></pre>
</div>
<p>We didn’t explicitly set an index for any of the Dataframes we have
used. For <code>df_SN7577i_a</code> and <code>df_SN7577i_b</code>
default indexes would have been created by pandas. When we concatenated
the Dataframes the indexes were also concatenated resulting in duplicate
entries.</p>
<p>This is really only a problem if you need to access a row by its
index. We can fix the problem with the following code.</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>df_all_rows<span class="op">=</span>df_all_rows.reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="co"># or, alternatively, there's the `ignore_index` option in the `pd.concat()` function:</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>df_all_rows <span class="op">=</span> pd.concat([df_SN7577i_a, df_SN7577i_b], ignore_index<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>df_all_rows</span></code></pre>
</div>
<p>What if the columns in the Dataframes are not the same?</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>df_SN7577i_aa <span class="op">=</span> pd.read_csv(<span class="st">"SN7577i_aa.csv"</span>)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>df_SN7577i_bb <span class="op">=</span> pd.read_csv(<span class="st">"SN7577i_bb.csv"</span>)</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>df_all_rows <span class="op">=</span> pd.concat([df_SN7577i_aa, df_SN7577i_bb])</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>df_all_rows</span></code></pre>
</div>
<p>In this case <code>df_SN7577i_aa</code> has no Q4 column and
<code>df_SN7577i_bb</code> has no <code>Q3</code> column. When they are
concatenated, the resulting Dataframe has a column for <code>Q3</code>
and <code>Q4</code>. For the rows corresponding to
<code>df_SN7577i_aa</code> the values in the <code>Q4</code> column are
missing and denoted by <code>NaN</code>. The same applies to
<code>Q3</code> for the <code>df_SN7577i_bb</code> rows.</p>
</div>
<div class="section level3">
<h3 id="scenario-2---adding-the-columns-from-one-dataframe-to-those-of-another-dataframe">Scenario 2 - Adding the columns from one Dataframe to those of
another Dataframe<a class="anchor" aria-label="anchor" href="#scenario-2---adding-the-columns-from-one-dataframe-to-those-of-another-dataframe"></a></h3>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>df_SN7577i_c <span class="op">=</span> pd.read_csv(<span class="st">"SN7577i_c.csv"</span>)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>df_SN7577i_d <span class="op">=</span> pd.read_csv(<span class="st">"SN7577i_d.csv"</span>)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>df_all_cols <span class="op">=</span> pd.concat([df_SN7577i_c, df_SN7577i_d], axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>df_all_cols</span></code></pre>
</div>
<p>We use the <code>axis=1</code> parameter to indicate that it is the
columns that need to be joined together. Notice that the <code>Id</code>
column appears twice, because it was a column in each dataset. This is
not particularly desirable, but also not necessarily a problem. However,
there are better ways of combining columns from two Dataframes which
avoid this problem.</p>
</div>
<div class="section level3">
<h3 id="scenario-3---using-merge-to-join-columns">Scenario 3 - Using merge to join columns<a class="anchor" aria-label="anchor" href="#scenario-3---using-merge-to-join-columns"></a></h3>
<p>We can join columns from two Dataframes using the
<code>merge()</code> function. This is similar to the SQL ‘join’
functionality.</p>
<p>A detailed discussion of different join types is given in the <a href=".././episodes/sql...">SQL lesson</a>.</p>
<p>You specify the type of join you want using the <code>how</code>
parameter. The default is the <code>inner</code> join which returns the
columns from both tables where the <code>key</code> or common column
values match in both Dataframes.</p>
<p>The possible values of the <code>how</code> parameter are shown in
the picture below (taken from the Pandas documentation)</p>
<figure><img src="../fig/pandas_join_types.png" alt="pandas_join_types" class="figure mx-auto d-block"></figure><p>The different join types behave in the same way as they do in SQL. In
Python/pandas, any missing values are shown as <code>NaN</code></p>
<p>In order to <code>merge</code> the Dataframes we need to identify a
column common to both of them.</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>df_cd <span class="op">=</span> pd.merge(df_SN7577i_c, df_SN7577i_d, how<span class="op">=</span><span class="st">'inner'</span>)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>df_cd</span></code></pre>
</div>
<p>In fact, if there is only one column with the same name in each
Dataframe, it will be assumed to be the one you want to join on. In this
example the <code>Id</code> column</p>
<p>Leaving the join column to default in this way is not best practice.
It is better to explicitly name the column using the <code>on</code>
parameter.</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>df_cd <span class="op">=</span> pd.merge(df_SN7577i_c, df_SN7577i_d, how<span class="op">=</span><span class="st">'inner'</span>, on <span class="op">=</span> <span class="st">'Id'</span>)</span></code></pre>
</div>
<p>In many circumstances, the column names that you wish to join on are
not the same in both Dataframes, in which case you can use the
<code>left_on</code> and <code>right_on</code> parameters to specify
them separately.</p>
<div class="codewrapper sourceCode" id="cb10">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>df_cd <span class="op">=</span> pd.merge(df_SN7577i_c, df_SN7577i_d, how<span class="op">=</span><span class="st">'inner'</span>, left_on <span class="op">=</span> <span class="st">'Id'</span>, right_on <span class="op">=</span> <span class="st">'Id'</span>)</span></code></pre>
</div>
<div id="practice-with-data" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="practice-with-data" class="callout-inner">
<h3 class="callout-title">Practice with data<a class="anchor" aria-label="anchor" href="#practice-with-data"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal"><li>Examine the contents of the <code>SN7577i_aa</code> and
<code>SN7577i_bb</code> csv files using Excel or equivalent.</li>
<li>Using the <code>SN7577i_aa</code> and <code>SN7577i_bb</code> csv
files, create a Dataframe which is the result of an outer join using the
<code>Id</code> column to join on.</li>
<li>What do you notice about the column names in the new Dataframe?</li>
<li>Using <code>shift</code>+<code>tab</code> in Jupyter examine the
possible parameters for the <code>merge()</code> function.</li>
<li>re-write the code so that the columns names which are common to both
files have suffixes indicating the filename from which they come</li>
<li>If you add the parameter <code>indicator=True</code>, what
additional information is provided in the resulting Dataframe?</li>
</ol></div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Show me the solution</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>df_SN7577i_aa <span class="op">=</span> pd.read_csv(<span class="st">"SN7577i_aa.csv"</span>)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>df_SN7577i_bb <span class="op">=</span> pd.read_csv(<span class="st">"SN7577i_bb.csv"</span>)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>df_aabb <span class="op">=</span> pd.merge(df_SN7577i_aa, df_SN7577i_bb, how<span class="op">=</span><span class="st">'outer'</span>, on <span class="op">=</span> <span class="st">'Id'</span>)</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>df_aabb</span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">PYTHON<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode python" tabindex="0"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a>df_SN7577i_aa <span class="op">=</span> pd.read_csv(<span class="st">"SN7577i_aa.csv"</span>)</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>df_SN7577i_bb <span class="op">=</span> pd.read_csv(<span class="st">"SN7577i_bb.csv"</span>)</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>df_aabb <span class="op">=</span> pd.merge(df_SN7577i_aa, df_SN7577i_bb, how<span class="op">=</span><span class="st">'outer'</span>, on <span class="op">=</span> <span class="st">'Id'</span>,suffixes<span class="op">=</span>(<span class="st">'_aa'</span>, <span class="st">'_bb'</span>), indicator <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>df_aabb</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul><li>You can join pandas Dataframes in much the same way as you join
tables in SQL</li>
<li>The <code>concat()</code> function can be used to concatenate two
Dataframes by adding the rows of one to the other.</li>
<li>
<code>concat()</code> can also combine Dataframes by columns but the
<code>merge()</code> function is the preferred way</li>
<li>The <code>merge()</code> function is equivalent to the SQL JOIN
clause. ‘left’, ‘right’ and ‘inner’ joins are all possible.</li>
</ul></div>
</div>
</div>
</div>
</section></div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="../instructor/10-aggregations.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="../instructor/12-long-and-wide.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="../instructor/10-aggregations.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Data Aggregation
        </a>
        <a class="chapter-link float-end" href="../instructor/12-long-and-wide.html" rel="next">
          Next: Wide and long data... 
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>
        
        <a href="https://github.com/datacarpentry/python-socialsci/edit/main/episodes/11-joins.md" class="external-link">Edit on GitHub</a>
        
	
        | <a href="https://github.com/datacarpentry/python-socialsci/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/datacarpentry/python-socialsci/" class="external-link">Source</a></p>
				<p><a href="https://github.com/datacarpentry/python-socialsci/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:team@carpentries.org">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">
        
        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>
        
        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.2" class="external-link">sandpaper (0.16.2)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.3" class="external-link">pegboard (0.7.3)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.1" class="external-link">varnish (1.0.1)</a></p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://datacarpentry.github.io/python-socialsci/instructor/11-joins.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "Joining Pandas Dataframes",
  "creativeWorkStatus": "active",
  "url": "https://datacarpentry.github.io/python-socialsci/instructor/11-joins.html",
  "identifier": "https://datacarpentry.github.io/python-socialsci/instructor/11-joins.html",
  "dateCreated": "2017-05-25",
  "dateModified": "2023-05-04",
  "datePublished": "2024-03-05"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo
    2022-11-07: we have gotten a notification that we have an overage for our
    tracking and I'm pretty sure this has to do with Workbench usage.
    Considering that I am not _currently_ using this tracking because I do not
    yet know how to access the data, I am turning this off for now.
  <script>
    var _paq = window._paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
    _paq.push(["setDomains", ["*.preview.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
    _paq.push(["setDoNotTrack", true]);
    _paq.push(["disableCookies"]);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
          var u="https://carpentries.matomo.cloud/";
          _paq.push(['setTrackerUrl', u+'matomo.php']);
          _paq.push(['setSiteId', '1']);
          var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
          g.async=true; g.src='https://cdn.matomo.cloud/carpentries.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
        })();
  </script>
  End Matomo Code --></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

